{"componentChunkName":"component---themes-advanced-src-templates-post-query-ts","path":"/react-workloop","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], t.indexOf(o) >= 0 || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.indexOf(n) >= 0) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"React Fiber架构之工作循环\",\n  \"cover\": \"../static/assets/react-fiber.jpg\",\n  \"coverAlt\": \"封面\",\n  \"description\": \"介绍React16带来的全新fiber架构，其中的WorkLoop\",\n  \"datePublished\": \"2023-04-06 19:58:30\",\n  \"dateModified\": \"2023-04-06 19:58:30\",\n  \"slug\": \"react-workloop\",\n  \"category\": \"经验总结\",\n  \"tags\": [\"前端\", \"React\", \"架构\", \"造轮子\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u5728\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/leon-blog/react-fiber-struct\"\n  }, \"React Fiber\\u67B6\\u6784\\u603B\\u89C8\"), \"\\u4E2D\\u6211\\u4EEC\\u63D0\\u5230\\uFF0CReact16\\u7684\\u65B0Fiber\\u67B6\\u6784\\uFF0C\\u5C06\\u8001\\u67B6\\u6784\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u9012\\u5F52\\u540C\\u6B65\\u7684\\u66F4\\u65B0\"), \"\\uFF0C\\u66FF\\u6362\\u4E3A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5F02\\u6B65\\u53EF\\u4E2D\\u65AD\\u7684\\u66F4\\u65B0\"), \"\\u3002\\u8FD9\\u4E2A\\u5F02\\u6B65\\u53EF\\u4E2D\\u65AD\\u6307\\u7684\\u5C31\\u662F\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u7684\\u6267\\u884C\\u4E2D\\u65AD\\u3002\"), mdx(\"p\", null, \"\\u672C\\u6B21\\u6211\\u4EEC\\u5C31\\u4E3B\\u8981\\u8BB2\\u4E00\\u8BB2\\uFF1A\\u4E3A\\u4EC0\\u4E48\\u8981\\u4F7F\\u7528workLoop\\uFF08\\u5DE5\\u4F5C\\u5FAA\\u73AF\\uFF09\\uFF1F\\u5B83\\u662F\\u600E\\u4E48\\u5B9E\\u73B0\\u53EF\\u4E2D\\u65AD\\u7684\\uFF1F\\u4E3A\\u4EC0\\u4E48\\u4E4B\\u524D\\u7684\\u8001\\u67B6\\u6784\\u4E0D\\u53EF\\u4EE5\\u4E2D\\u65AD\\uFF1F\"), mdx(\"p\", null, \"\\u5E26\\u7740\\u8FD9\\u4E9B\\u95EE\\u9898\\uFF0C\\u6211\\u4F1A\\u7528\\u4E00\\u4E9B\\u7B80\\u5316\\u7684\\u4EE3\\u7801\\u8BB2\\u6E05\\u695A\\u8FD9\\u4E2A\\u77E5\\u8BC6\\u70B9\\u3002\"), mdx(\"h3\", null, \"\\u8001\\u67B6\\u6784\\u7684\\u9012\\u5F52\\u5DE5\\u4F5C\\u6A21\\u578B\"), mdx(\"p\", null, \"\\u5728\\u8BB2\\u65B0\\u67B6\\u6784\\u4E4B\\u524D\\uFF0C\\u5148\\u5206\\u6790\\u4E00\\u4E0B\\u8001\\u67B6\\u6784\\u662F\\u600E\\u4E48\\u505A\\u7684\\u3002\\u524D\\u9762\\u4E5F\\u63D0\\u5230\\u4E86\\uFF0C\\u8001\\u67B6\\u6784\\u662F\\u901A\\u8FC7\\u9012\\u5F52\\u5B9E\\u73B0\\u7684\\u3002\\u7B80\\u5316\\u7684\\u4EE3\\u7801\\u5C31\\u5982\\u540C\\u4E0B\\u9762\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"export\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"mountRootTree\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"root\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// React.createElement\\u83B7\\u53D6\\u5230\\u7684element\\u8F6C\\u5316\\u4E3A\\u5185\\u90E8\\u7EC4\\u4EF6\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" rootComponent \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"new\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token class-name\"\n  }, \"InnerComponent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8C03\\u7528\\u5185\\u90E8\\u7EC4\\u4EF6.mount\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" node \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" rootComponent\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"mount\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6E32\\u67D3\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"callRender\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"node\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"class\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token class-name\"\n  }, \"InnerComponent\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"mount\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u4ECEprops.children\\u6216render()\\u51FD\\u6570\\u83B7\\u53D6children elements\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" children \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"getChildren\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u521B\\u5EFAnode\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" parent \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createNode\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u904D\\u5386children\\uFF0C\\u5E76\\u6E32\\u67D3\"), \"\\n        children\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"forEach\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"child\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=>\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n            \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" childComponent \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"new\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token class-name\"\n  }, \"InnerComponent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"child\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n            \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" node \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" childComponent\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"mount\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n            \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6E32\\u67D3\"), \"\\n            \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"callRender\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"node\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" parent\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" parent\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\uFF0C\\u4ECE\\u6839\\u5143\\u7D20\\u5F00\\u59CB\\uFF0C\\u6BCF\\u4E2Aelement\\u521B\\u5EFA\\u4E00\\u4E2A\\u5185\\u90E8\\u7EC4\\u4EF6\\uFF0C\\u7136\\u540E\\u8C03\\u7528\\u5185\\u90E8\\u7EC4\\u4EF6\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"mount()\"), \"\\u65B9\\u6CD5\\u3002\\u5185\\u90E8\\u7EC4\\u4EF6\\u7684mount()\\u65B9\\u6CD5\\u91CC\\u518D\\u7EE7\\u7EED\\u83B7\\u53D6children elements\\uFF0C\\u5E76\\u521B\\u5EFAchild\\u5185\\u90E8\\u7EC4\\u4EF6\\uFF0C\\u7136\\u540E\\u9012\\u5F52\\u8C03\\u7528child\\u5185\\u90E8\\u7EC4\\u4EF6\\u7684mount()\\u65B9\\u6CD5...\\u6574\\u4E2A\\u7EC4\\u4EF6\\u6811\\u7684\\u5DE5\\u4F5C\\u5C31\\u8FD9\\u6837\\u5B8C\\u6210\\u4E86\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u4EE5\\u4E0A\\u4EE3\\u7801\\u975E\\u5E38\\u7B80\\u5316\\uFF0C\\u53EA\\u662F\\u60F3\\u8BF4\\u660E\\u8001\\u67B6\\u6784\\u662F\\u5982\\u4F55\\u53BB\\u9012\\u5F52\\u5904\\u7406\\u5404\\u4E2A\\u8282\\u70B9\\u7684\\u3002\\u8BE6\\u7EC6\\u5206\\u6790\\u53EF\\u89C1\\u6211\\u5199\\u7684\\u53E6\\u4E00\\u7BC7\\u6587\\u7AE0\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/leon-blog/vue-react-render\"\n  }, \"\\u6E32\\u67D3\\u6D41\\u7A0B\\uFF1AVue vs React\"))), mdx(\"p\", null, \"\\u4ECE\\u4EE3\\u7801\\u53EF\\u4EE5\\u770B\\u51FA\\uFF0C\\u8FD9\\u79CD\\u9012\\u5F52\\u7684\\u5904\\u7406\\u65B9\\u5F0F\\u4E00\\u65E6\\u5F00\\u59CB\\uFF0C\\u5C31\\u8981\\u4ECE\\u5934\\u6267\\u884C\\u5230\\u7ED3\\u675F\\uFF0C\\u65E0\\u6CD5\\u4E2D\\u65AD\\u3002\"), mdx(\"h3\", null, \"\\u65B0\\u67B6\\u6784\\u7684Fiber\\u5DE5\\u4F5C\\u5FAA\\u73AF\"), mdx(\"p\", null, \"\\u5728\\u4E0A\\u9762\\u4ECB\\u7ECD\\u7684\\u8001\\u67B6\\u6784\\u4E2D\\uFF0C\\u6BCF\\u4E2Aelement\\uFF08\\u53EF\\u4EE5\\u7406\\u89E3\\u4E3A\\u6BCF\\u4E2Ajsx\\u8282\\u70B9\\uFF09\\u90FD\\u521B\\u5EFA\\u4E86\\u4E00\\u4E2A\\u5185\\u90E8\\u7EC4\\u4EF6\\u3002\\u5728\\u65B0\\u7684Fiber\\u67B6\\u6784\\u4E2D\\uFF0C\\u53D6\\u800C\\u4EE3\\u4E4B\\u7684\\u662FFiber\\u5BF9\\u8C61\\u3002Fiber\\u5BF9\\u8C61\\u5C5E\\u6027\\u6BD4\\u8F83\\u591A\\uFF0C\\u6211\\u4EEC\\u8FD9\\u6B21\\u5C31\\u53EA\\u770B\\u5B83\\u8DDF\\u7EC4\\u4EF6\\u6811\\u6784\\u6210\\u6709\\u5173\\u7CFB\\u7684\\u5C5E\\u6027\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"FiberNode\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token operator\"\n  }, \"...\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"this\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u7B2C\\u4E00\\u4E2A\\u5B50\\u8282\\u70B9\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"this\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sibling \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u76F8\\u90BB\\u7684\\u4E0B\\u4E00\\u4E2A\\u5144\\u5F1F\\u8282\\u70B9\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"this\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u7236\\u8282\\u70B9\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\uFF0CFiberNode\\u6709\\u4E09\\u4E2A\\u5C5E\\u6027child\\u3001sibling\\u3001return\\u3002\\u6BCF\\u4E2A\\u5C5E\\u6027\\u90FD\\u94FE\\u63A5\\u4E86\\u53E6\\u4E00\\u4E2Afiber\\u8282\\u70B9\\u3002\\u7531\\u8FD9\\u4E09\\u4E2A\\u5C5E\\u6027\\u6784\\u6210\\u4E86\\u6574\\u9897fiber\\u7EC4\\u4EF6\\u6811\\u3002\"), mdx(\"p\", null, \"\\u6BD4\\u5982\\u5982\\u4E0B\\u7684\\u4E00\\u4E2AJSX\\u6811\\u7ED3\\u6784\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"html\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-html\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-html\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"<\"), \"App\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"<\"), \"h1\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"<\"), \"div\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"</\"), \"div\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"</\"), \"h1\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"<\"), \"Detail\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"<\"), \"button\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"</\"), \"button\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"</\"), \"Detail\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\")), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token tag\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"</\"), \"App\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \">\"))))), mdx(\"p\", null, \"\\u6784\\u6210\\u7684fiber\\u6811\\u53EF\\u4EE5\\u770B\\u4E0B\\u56FE\\uFF1A\"), mdx(\"img\", {\n    \"src\": \"assets/fiber-node.jpg\",\n    \"alt\": \"fiber树\"\n  }), mdx(\"p\", null, \"\\u6709\\u4E86\\u8FD9\\u4E48\\u4E00\\u68F5\\u6811\\uFF0CReact\\u662F\\u600E\\u4E48\\u5B9E\\u73B0\\u6811\\u7684\\u904D\\u5386\\u5E76\\u4E14\\u8FD8\\u53EF\\u4EE5\\u4E2D\\u65AD\\u5462\\u3002\\u4ECEReact reconciler\\u6E90\\u7801\\u4E2D\\uFF0C\\u6458\\u9664\\u6389\\u53EA\\u5269\\u4E0B\\u5173\\u952E\\u90E8\\u5206\\uFF0C\\u6700\\u540EworkLoop\\u4EE3\\u7801\\u5982\\u4E0B\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" workInProgress\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5F53\\u524D\\u5DE5\\u4F5C\\u8282\\u70B9\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5DE5\\u4F5C\\u5FAA\\u73AF\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"while\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"&&\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYield\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performUnitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"workInProgress\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performUnitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"unitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5BF9\\u5F53\\u524D\\u5DE5\\u4F5C\\u5355\\u5143\\u8FDB\\u884CbeginWork\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" next \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"beginWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"next \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5982\\u679C\\u6CA1\\u6709\\u4E0B\\u4E00\\u4E2A\\uFF0C\\u5BF9\\u5F53\\u524D\\u5DE5\\u4F5C\\u5355\\u5143\\u8FDB\\u884CcompleteUnitOfWork\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"completeUnitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5982\\u679C\\u6709\\u4E0B\\u4E00\\u4E2A\\uFF0C\\u8FDB\\u5165\\u4E0B\\u4E00\\u8F6E\\u5FAA\\u73AF\"), \"\\n    workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" next\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"beginWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"unitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6A21\\u62DFbeginWork\"), \"\\n  console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token template-string\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"begin work on [\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"${\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"tag\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5C06\\u81EA\\u5DF1\\u7684child\\u4F5C\\u4E3A\\u4E0B\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"completeUnitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"unitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" completedWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"do\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6A21\\u62DFcompleteWork\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token template-string\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"complete work on [\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"${\"), \"completedWork\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"tag\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" returnFiber \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" siblingFiber \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sibling\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5982\\u679C\\u6709\\u5144\\u5F1F\\u8282\\u70B9\\uFF0C\\u5C06\\u5144\\u5F1F\\u8282\\u70B9\\u4F5C\\u4E3A\\u4E0B\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"siblingFiber \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" siblingFiber\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5426\\u5219\\uFF0C\\u7236\\u8282\\u70B9\\u4F5C\\u4E3AcompletedWork\\uFF0C\\u7EE7\\u7EED\\u5FAA\\u73AF\"), \"\\n    completedWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" returnFiber\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"while\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"completedWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u662F\\u5426\\u9700\\u8981\\u4E2D\\u65AD\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYield\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u4EE3\\u7801\\u4E2D\\u4FDD\\u7559\\u4E86\\u6E90\\u7801\\u4E2D\\u7684\\u547D\\u540D\\u3002\\u53EF\\u4EE5\\u770B\\u5230React\\u4F7F\\u7528workInProgress\\u6765\\u8BB0\\u5F55\\u5DE5\\u4F5C\\u8FDB\\u5EA6\\uFF0C\\u540C\\u65F6\\u5B83\\u4E5F\\u662Ffiber\\u5BF9\\u8C61\\u3002\\u5F53workInProgress\\u4E0D\\u4E3A\\u7A7A\\u65F6while\\u5FAA\\u73AF\\uFF0C\\u6BCF\\u6267\\u884C\\u5B8C\\u4E00\\u4E2A\\u5DE5\\u4F5C\\uFF0C\\u5C31\\u4FEE\\u6539workInProgress\\u6307\\u5411\\u4E0B\\u4E00\\u4E2Afiber\\u3002\"), mdx(\"p\", null, \"\\u6267\\u884C\\u5177\\u4F53\\u5DE5\\u4F5C\\u65F6\\uFF0C\\u6BCF\\u4E00\\u4E2AunitOfWork\\uFF08\\u5DE5\\u4F5C\\u5355\\u5143\\uFF09\\uFF0C\\u5148\\u6267\\u884CbeginWork\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\uFF08\\u8FD9\\u91CC\\u628AbeginWork\\u7684\\u5185\\u5BB9\\u53BB\\u6389\\u4E86\\u53EA\\u7559\\u4E0B\\u4E86console\\uFF0C\\u5B9E\\u9645\\u4E0AReact\\u5728\\u6B64\\u505Afiber\\u6811\\u6784\\u5EFA\\uFF0Cchildren\\u534F\\u8C03\\u5DE5\\u4F5C\\uFF09\"), \"\\u3002beginWork\\u505A\\u5B8C\\u540E\\uFF0C\\u5982\\u679C\\u6709child\\u5C31\\u628Achild\\u5F53\\u4F5C\\u4E0B\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\\u3002\\u5982\\u679C\\u6CA1\\u6709child\\uFF0C\\u8BF4\\u660E\\u5F53\\u524Dfiber\\u7684\\u5B50\\u6811\\u90FD\\u505A\\u5B8C\\u4E86beginWork\\u3002\\u5219\\u6267\\u884CcompleteWork\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\uFF08\\u5B9E\\u9645\\u4E0AReact\\u5728\\u6B64\\u505ADOM\\u521B\\u5EFA\\u3001effectList\\u4E32\\u8054\\u7B49\\u5DE5\\u4F5C\\uFF09\"), \"\\u3002\"), mdx(\"p\", null, \"completeWork\\u505A\\u5B8C\\u540E\\uFF0C\\u5982\\u679C\\u6709\\u5144\\u5F1F\\u8282\\u70B9sibling\\uFF0C\\u5219\\u628Asibling\\u4F5C\\u4E3A\\u4E0B\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\\u3002\\u5982\\u679C\\u6CA1\\u6709\\u5144\\u5F1F\\u8282\\u70B9\\u4E86\\uFF0C\\u8BF4\\u660E\\u5F53\\u524Dfiber\\u7684\\u5144\\u5F1F\\u4E5F\\u5168\\u90E8\\u505A\\u5B8C\\u4E86beginWork\\u548CcompleteWork\\u3002\\u662F\\u65F6\\u5019\\u8FD4\\u56DE\\u7236\\u8282\\u70B9\\uFF0C\\u5E76\\u8BA9\\u7236\\u8282\\u70B9\\u505AcompleteWork\\u4E86\\u3002\"), mdx(\"p\", null, \"\\u8981\\u8FD4\\u56DE\\u7236\\u8282\\u70B9\\u4F46\\u662F\\u4E0D\\u80FD\\u5C06\\u7236\\u8282\\u70B9\\u4F5C\\u4E3A\\u4E0B\\u4E00\\u4E2AworkInProgress\\uFF0C\\u5426\\u5219\\u5C31\\u6B7B\\u5FAA\\u73AF\\u4E86\\u3002\\u53EA\\u9700\\u8981\\u8BA9\\u5B83\\u8D70completeWork\\u5373\\u53EF\\u3002\\u6240\\u4EE5React\\u5728\\u8FD9\\u91CC\\u53C8\\u5957\\u4E86\\u4E00\\u4E2A\\u5FAA\\u73AF\\uFF0C\\u5C06\\u7236\\u8282\\u70B9\\u4F5C\\u4E3AcompletedWork\\u5355\\u5143\\uFF0C\\u6267\\u884C\\u4E0A\\u9762\\u6240\\u8BF4\\u7684\\u903B\\u8F91\\u3002\"), mdx(\"p\", null, \"\\u63A5\\u4E0B\\u6765\\uFF0C\\u6211\\u4EEC\\u6D4B\\u8BD5\\u4E0B\\u8FD9\\u4E2AworkLoop\\u7684\\u6267\\u884C\\u6D41\\u7A0B\\u3002\\u9996\\u5148\\u7528\\u4EE3\\u7801\\u521B\\u5EFA\\u4E0A\\u56FE\\u4E2D\\u793A\\u4F8B\\u7684fiber\\u6811\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createFiber\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"tag\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \" tag\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token literal-property property\"\n  }, \"child\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token literal-property property\"\n  }, \"sibling\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u751F\\u6210\\u5982\\u4E0B\\u7ED3\\u6784\\u7684fiber\\u6811\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// <App>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//   <h1>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//     <div></div>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//   </h1>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//   <Detail>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//     <button></button>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//   </Detail>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// </App>\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generateFiberTree\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" app \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createFiber\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"App\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" h1 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createFiber\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"h1\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  app\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" app\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" detail \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createFiber\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"Detail\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sibling \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" app\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" div \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createFiber\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"div\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" button \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createFiber\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"button\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" button\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  button\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" app\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u7136\\u540E\\u8C03\\u7528workLoop\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" root \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generateFiberTree\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\nworkInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"p\", null, \"\\u67E5\\u770B\\u63A7\\u5236\\u53F0\\u65E5\\u5FD7\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"shell\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-shell\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"begin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"App\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"Detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"button\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"button\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"Detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"App\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\")))), mdx(\"p\", null, \"\\u4E00\\u5207OK\\u3002\\u770B\\u7ED3\\u679C\\u5B83\\u548C\\u8001\\u67B6\\u6784\\u4E00\\u6837\\uFF0C\\u662F\\u81EA\\u4E0A\\u800C\\u4E0B\\uFF0C\\u6DF1\\u5EA6\\u4F18\\u5148\\u7684\\u904D\\u5386\\u65B9\\u5F0F\\uFF0C\\u53EA\\u4E0D\\u8FC7\\u5B83\\u4E0D\\u662F\\u9012\\u5F52\\u5B9E\\u73B0\\u7684\\uFF0C\\u800C\\u662F\\u901A\\u8FC7\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"while\\u5FAA\\u73AF+\\u4FEE\\u6539fiber\\u5DE5\\u4F5C\\u6307\\u9488\"), \"\\u7684\\u5F62\\u5F0F\\u3002\\u53D1\\u6563\\u4E00\\u4E0B\\uFF0C\\u5982\\u679C\\u6211\\u4EEC\\u8981\\u7528\\u9012\\u5F52\\u7684\\u5F62\\u5F0F\\u5B9E\\u73B0\\u53C8\\u662F\\u4EC0\\u4E48\\u6837\\u5B50\\uFF1F\\u76F4\\u63A5\\u4E0A\\u4EE3\\u7801\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u9012\\u5F52\\u5DE5\\u4F5C\\u5FAA\\u73AF\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopRecursive\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"unitOfWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6A21\\u62DFbeginWork\"), \"\\n  console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token template-string\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"begin work on [\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"${\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"tag\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopRecursive\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6A21\\u62DFcompleteWork\"), \"\\n  console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token template-string\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"complete work on [\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"${\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"tag\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token interpolation-punctuation punctuation\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token string\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token template-punctuation string\"\n  }, \"`\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sibling \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopRecursive\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sibling\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8FD0\\u884C\\u6D4B\\u8BD5\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" root \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generateFiberTree\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopRecursive\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"p\", null, \"Look\\uFF01\\u9012\\u5F52\\u7684\\u4EE3\\u7801\\u7B80\\u5355\\u592A\\u591A\\u4E86\\uFF0C\\u800C\\u4E14return\\u90FD\\u4E0D\\u9700\\u8981\\u4E86\\u3002\\u56E0\\u4E3A\\u9012\\u5F52\\u81EA\\u5DF1\\u77E5\\u9053\\u600E\\u4E48\\u8FD4\\u56DE\\uFF01\\u53EF\\u4EE5\\u8FD0\\u884C\\u4E00\\u4E0B\\u6D4B\\u8BD5\\uFF0C\\u4F1A\\u53D1\\u73B0\\u7ED3\\u679C\\u548C\\u4E0A\\u9762\\u7684\\u4E00\\u6837\\u3002\"), mdx(\"p\", null, \"\\u65E2\\u7136\\u9012\\u5F52\\u8FD9\\u4E48\\u7B80\\u5355\\uFF0C\\u4E3A\\u4EC0\\u4E48\\u8981\\u8D39\\u8FD9\\u4E48\\u5927\\u52B2\\u5462\\uFF1F\\u524D\\u9762\\u5C31\\u8BF4\\u5230\\u4E86\\uFF0C\\u56E0\\u4E3A\\u4E00\\u65E6\\u9012\\u5F52\\u5C31\\u4E0D\\u53EF\\u4E2D\\u65AD\\u3002\\u90A3\\u73B0\\u5728\\u8FD9\\u79CD\\u5F62\\u5F0F\\uFF0C\\u53C8\\u5982\\u4F55\\u5B9E\\u73B0\\u4E2D\\u65AD\\uFF1F\"), mdx(\"h3\", null, \"\\u4E2D\\u65AD\\u6267\\u884C\"), mdx(\"p\", null, \"\\u56DE\\u5230workLoopConcurrent\\u65B9\\u6CD5\\u91CC\\uFF0Cwhile\\u7684\\u6761\\u4EF6\\u91CC\\u6709\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"shouldYield()\"), \"\\u65B9\\u6CD5\\u3002React\\u91CC\\u5C31\\u662F\\u7528\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u5B9E\\u73B0\\u7684\\u53EF\\u4E2D\\u65AD\\uFF0C\\u5E76\\u4E14\\u7531\\u4E8EworkInProgress\\u8BB0\\u5F55\\u4E86\\u5DE5\\u4F5C\\u8FDB\\u5EA6\\uFF0C\\u4E0B\\u4E00\\u6B21\\u5C31\\u53EF\\u4EE5\\u6062\\u590D\\u5DE5\\u4F5C\\uFF01\"), mdx(\"p\", null, \"\\u6211\\u4EEC\\u6D4B\\u8BD5\\u4E00\\u4E0B\\uFF0C \\u76EE\\u524DshouldYield\\u65B9\\u6CD5\\u91CC\\uFF0C\\u76F4\\u63A5\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"return false\"), \"\\u3002\\u5B9E\\u9645\\u4E0AReact\\u4F1A\\u5728\\u8FD9\\u91CC\\u6839\\u636E\\u4E0B\\u4E00\\u4E2A\\u66F4\\u65B0\\u7684\\u4F18\\u5148\\u7EA7\\uFF0C\\u53EF\\u80FD\\u5728\\u8FD9\\u91CC\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"return true\"), \"\\u3002\\u6211\\u4EEC\\u6D4B\\u8BD5\\u7684\\u8BDD\\uFF0C\\u5C31\\u52A0\\u4E2Acount\\u5427\\uFF0C\\u6BD4\\u5982\\u6211\\u4EEC\\u5904\\u74063\\u4E2A\\u8282\\u70B9\\u540E\\uFF0C\\u5C31\\u4E2D\\u65AD\\u5904\\u7406\\u3002\\u4FEE\\u6539shouldYield\\u65B9\\u6CD5\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" count \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"0\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u662F\\u5426\\u9700\\u8981\\u4E2D\\u65AD\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYield\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"++\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \">=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"3\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u8FD0\\u884C\\u6D4B\\u8BD5\\u4E00\\u4E0B\\u3002\\u7ED3\\u679C\\u4E3A\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"shell\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-shell\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"begin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"App\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\")))), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\uFF0C\\u4ECE\\u6839\\u8282\\u70B9\\u5F00\\u59CB\\uFF0C\\u6267\\u884C\\u4E86\\u4E09\\u4E2A\\u8282\\u70B9\\u7684work\\u540E\\u5C31\\u9000\\u51FA\\u4E86\\u3002\\u53EF\\u80FD\\u6709\\u540C\\u5B66\\u8981\\u95EE\\u4E86\\uFF0C\\u4E3A\\u4EC0\\u4E48completWork\\u6267\\u884C\\u4E86\\uFF0C\\u4F46\\u662F\\u53EA\\u6267\\u884C\\u4E86\\u4E24\\u4E2A\\uFF1F\"), mdx(\"p\", null, \"\\u4ECE\\u4E0A\\u9762\\u7684\\u6E90\\u7801\\u53EF\\u4EE5\\u770B\\u5230\\uFF0CcompleteWork\\u662F\\u4E0D\\u4E2D\\u65AD\\u7684\\uFF0C\\u53EA\\u6709beginWork\\u7684while\\u5FAA\\u73AF\\u624D\\u5224\\u65AD\\u662F\\u5426\\u9700\\u8981\\u4E2D\\u65AD\\u3002\\u6240\\u4EE5\\u53EA\\u8981\\u5DE5\\u4F5C\\u5355\\u5143\\u53CA\\u5176\\u5B50\\u6811\\u7684beginWork\\u90FD\\u505A\\u5B8C\\u4E86\\uFF0C\\u5C31\\u4E00\\u5B9A\\u4F1A\\u6267\\u884C\\u5B83\\u7684completWork\\u3002\\u53EA\\u8981\\u6CA1\\u5B8C\\u5168\\u505A\\u5B8C\\u5C31\\u4E0D\\u6267\\u884C\\u3002\\u6240\\u4EE5App\\u8282\\u70B9\\uFF0C\\u56E0\\u4E3A\\u5B83\\u8FD8\\u6CA1\\u6709\\u5904\\u7406\\u5B8C\\u5B50\\u6811\\u7684beginWork\\uFF0C\\u6240\\u4EE5\\u5B83\\u7684completeWork\\u4E5F\\u5C31\\u6CA1\\u6709\\u6267\\u884C\\u3002\\u4ECE\\u8BBE\\u8BA1\\u89D2\\u5EA6\\u6765\\u8BF4\\uFF0C\\u8FD9\\u4E5F\\u662F\\u975E\\u5E38\\u5408\\u7406\\u7684\\u3002\"), mdx(\"h3\", null, \"\\u4E2D\\u65AD\\u540E\\u6062\\u590D\"), mdx(\"p\", null, \"\\u65E2\\u7136\\u80FD\\u4E2D\\u65AD\\uFF0C\\u90A3\\u5C31\\u8981\\u80FD\\u6062\\u590D\\u3002\\u5F53\\u524D\\u80FD\\u5728\\u5408\\u9002\\u7684\\u65F6\\u673A\\u4E0B\\uFF0C\\u518D\\u6062\\u590D\\u5DE5\\u4F5C\\u8FDB\\u5EA6\\u5417\\uFF1F\\u6211\\u4EEC\\u518D\\u6539\\u9020\\u4E00\\u4E0BshouldYield\\u65B9\\u6CD5\\u548C\\u6D4B\\u8BD5\\u4EE3\\u7801\\uFF0C\\u6A21\\u62DF\\u4E00\\u4E0B\\u4E2D\\u65AD\\u7136\\u540E\\u7ACB\\u523B\\u6062\\u590D\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" max \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"3\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" count \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"0\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u662F\\u5426\\u9700\\u8981\\u4E2D\\u65AD\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYield\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"++\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \">=\"), \" max\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"//\\u4F7F\\u7528max\\u63A7\\u5236\\u4E2D\\u65AD\\u65F6\\u673A\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" root \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generateFiberTree\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\nworkInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u7B2C\\u4E00\\u6B21\\u5DE5\\u4F5C\\u5FAA\\u73AF\"), \"\\n\\nconsole\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"work loop break off\\\\n\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5C06\\u7B2C\\u4E8C\\u6B21\\u5DE5\\u4F5C\\u7684\\u4E2D\\u65AD\\u6B21\\u6570\\u8C03\\u9AD8\"), \"\\nmax \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"1000000\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\nconsole\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"work loop restart\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"p\", null, \"\\u67E5\\u770B\\u8F93\\u51FA\\u7ED3\\u679C\\u4E3A\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"shell\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-shell\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"begin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"App\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"div\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"h1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nwork loop \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token builtin class-name\"\n  }, \"break\"), \" down\\n\\nwork loop restart\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"Detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\nbegin work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"button\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"button\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"Detail\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), \"\\ncomplete work on \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"App\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\")))), mdx(\"p\", null, \"\\u975E\\u5E38\\u725Bx\\uFF01\\u770B\\u6765\\u786E\\u5B9E\\u5B9E\\u73B0\\u4E86\\u5728\\u54EA\\u91CC\\u4E2D\\u65AD\\uFF0C\\u5C31\\u5728\\u54EA\\u91CC\\u6062\\u590D\\uFF0C\\u6CA1\\u6709\\u6F0F\\u8FD0\\u884C\\u4EFB\\u4F55\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u3002\\u8FD9\\u6837\\u7684\\u8BDD\\uFF0C\\u518D\\u642D\\u914DReact16\\u7684\\u5F02\\u6B65\\u8C03\\u5EA6\\u5668Scheduler\\uFF0C\\u5C31\\u53EF\\u4EE5\\u5B9E\\u73B0\\u6E32\\u67D3\\u8FC7\\u7A0B\\u7684\\u4E2D\\u65AD\\u3001\\u6062\\u590D\\uFF0C\\u9AD8\\u4F18\\u5148\\u7EA7\\u66F4\\u65B0\\u6253\\u65AD\\u524D\\u4E00\\u6B21\\u66F4\\u65B0\\u7B49\\u5404\\u79CD\\u64CD\\u4F5C\\u4E86\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u672C\\u6587\\u6240\\u7528\\u5230\\u7684\\u6E90\\u7801\\u5728\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://codesandbox.io/p/devbox/xj625g\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"codeSandbox\\u4E0A\"), \"\\u3002\")));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":1,"excerpt":"在 React Fiber架构总览 中我们提到，React16的新Fiber架构，将老架构的 递归同步的更新 ，替换为 异步可中断的更新 。这个异步可中断指的就是工作循环的执行中断。 本次我们就主要讲一讲：为什么要使用workLoop…","frontmatter":{"title":"React Fiber架构之工作循环","description":"介绍React16带来的全新fiber架构，其中的WorkLoop","cover":{"publicURL":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/react-fiber.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABxpq1QP/EABYQAAMAAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIc/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAABEQAhIEGR/9oACAEBAAE/IQndxNAdx//aAAwDAQACAAMAAAAQS+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhEDFBYYH/2gAIAQEAAT8QYKKXkWrmPC7EzycaO8//2Q=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/29db4/react-fiber.jpg","srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/ed76a/react-fiber.jpg 275w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/a7f65/react-fiber.jpg 549w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/29db4/react-fiber.jpg 1098w","sizes":"(min-width: 1098px) 1098px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/77d15/react-fiber.avif 275w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/7d872/react-fiber.avif 549w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/50cc1/react-fiber.avif 1098w","type":"image/avif","sizes":"(min-width: 1098px) 1098px, 100vw"},{"srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/1f877/react-fiber.webp 275w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/12e3f/react-fiber.webp 549w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/c81ec/react-fiber.webp 1098w","type":"image/webp","sizes":"(min-width: 1098px) 1098px, 100vw"}]},"width":1098,"height":544}}},"coverAlt":"封面","datePublished":"2023-04-06 19:58:30","dateModified":"2023-04-06 19:58:30","category":"经验总结","tags":["前端","React","架构","造轮子"]},"fields":{"slug":"/react-workloop","route":"/react-workloop","pathName":"/leon-blog/react-workloop","url":"https://missmess.github.io/leon-blog/react-workloop"},"internal":{"content":"---\ntitle: \"React Fiber架构之工作循环\"\ncover: ../static/assets/react-fiber.jpg\ncoverAlt: \"封面\"\ndescription: \"介绍React16带来的全新fiber架构，其中的WorkLoop\"\ndatePublished: \"2023-04-06 19:58:30\"\ndateModified: \"2023-04-06 19:58:30\"\nslug: \"react-workloop\"\ncategory: \"经验总结\"\ntags:\n  - 前端\n  - React\n  - 架构\n  - 造轮子\n---\n\n在[React Fiber架构总览](/react-fiber-struct)中我们提到，React16的新Fiber架构，将老架构的**递归同步的更新**，替换为**异步可中断的更新**。这个异步可中断指的就是工作循环的执行中断。\n\n本次我们就主要讲一讲：为什么要使用workLoop（工作循环）？它是怎么实现可中断的？为什么之前的老架构不可以中断？\n\n带着这些问题，我会用一些简化的代码讲清楚这个知识点。\n\n### 老架构的递归工作模型\n\n在讲新架构之前，先分析一下老架构是怎么做的。前面也提到了，老架构是通过递归实现的。简化的代码就如同下面：\n\n```javascript\nexport function mountRootTree(root) {\n    // React.createElement获取到的element转化为内部组件\n    const rootComponent = new InnerComponent(root);\n    // 调用内部组件.mount\n    const node = rootComponent.mount();\n    // 渲染\n    callRender(node);\n}\n\nclass InnerComponent {\n    mount() {\n        // 从props.children或render()函数获取children elements\n        const children = getChildren()\n        // 创建node\n        const parent = createNode();\n        // 遍历children，并渲染\n        children.forEach((child) => {\n            const childComponent = new InnerComponent(child);\n            const node = childComponent.mount();\n            // 渲染\n            callRender(node, parent);\n        })\n        return parent;\n    }\n}\n```\n\n可以看到，从根元素开始，每个element创建一个内部组件，然后调用内部组件的`mount()`方法。内部组件的mount()方法里再继续获取children elements，并创建child内部组件，然后递归调用child内部组件的mount()方法...整个组件树的工作就这样完成了。\n\n> 以上代码非常简化，只是想说明老架构是如何去递归处理各个节点的。详细分析可见我写的另一篇文章：[渲染流程：Vue vs React](/vue-react-render)\n\n从代码可以看出，这种递归的处理方式一旦开始，就要从头执行到结束，无法中断。\n\n### 新架构的Fiber工作循环\n\n在上面介绍的老架构中，每个element（可以理解为每个jsx节点）都创建了一个内部组件。在新的Fiber架构中，取而代之的是Fiber对象。Fiber对象属性比较多，我们这次就只看它跟组件树构成有关系的属性：\n\n```javascript\nfunction FiberNode(...) {\n    // ...\n\n    this.child = null; // 第一个子节点\n    this.sibling = null; // 相邻的下一个兄弟节点\n    this.return = null; // 父节点\n\n    // ...\n}\n```\n\n可以看到，FiberNode有三个属性child、sibling、return。每个属性都链接了另一个fiber节点。由这三个属性构成了整颗fiber组件树。\n\n比如如下的一个JSX树结构：\n```html\n<App>\n  <h1>\n    <div></div>\n  </h1>\n  <Detail>\n    <button></button>\n  </Detail>\n</App>\n```\n\n构成的fiber树可以看下图：\n\n![fiber树](assets/fiber-node.jpg)\n\n有了这么一棵树，React是怎么实现树的遍历并且还可以中断呢。从React reconciler源码中，摘除掉只剩下关键部分，最后workLoop代码如下：\n\n```javascript\nlet workInProgress; // 当前工作节点\n\nfunction workLoopConcurrent() {\n  // 工作循环\n  while (workInProgress != null && !shouldYield()) {\n    performUnitOfWork(workInProgress);\n  }\n}\n\nfunction performUnitOfWork(unitOfWork) {\n  // 对当前工作单元进行beginWork\n  let next = beginWork(unitOfWork);\n\n  if (next == null) {\n    // 如果没有下一个，对当前工作单元进行completeUnitOfWork\n    completeUnitOfWork(unitOfWork);\n  } else {\n    // 如果有下一个，进入下一轮循环\n    workInProgress = next;\n  }\n}\n\nfunction beginWork(unitOfWork) {\n  // 模拟beginWork\n  console.log(`begin work on [${unitOfWork.tag}]`);\n\n  // 将自己的child作为下一个工作单元\n  return unitOfWork.child;\n}\n\nfunction completeUnitOfWork(unitOfWork) {\n  let completedWork = unitOfWork;\n  do {\n    // 模拟completeWork\n    console.log(`complete work on [${completedWork.tag}]`);\n\n    const returnFiber = completedWork.return;\n    const siblingFiber = completedWork.sibling;\n    // 如果有兄弟节点，将兄弟节点作为下一个工作单元\n    if (siblingFiber != null) {\n      workInProgress = siblingFiber;\n      return;\n    }\n\n    // 否则，父节点作为completedWork，继续循环\n    completedWork = returnFiber;\n    workInProgress = completedWork;\n  } while (completedWork != null);\n}\n\n// 是否需要中断\nfunction shouldYield() {\n  return false;\n}\n```\n\n代码中保留了源码中的命名。可以看到React使用workInProgress来记录工作进度，同时它也是fiber对象。当workInProgress不为空时while循环，每执行完一个工作，就修改workInProgress指向下一个fiber。\n\n执行具体工作时，每一个unitOfWork（工作单元），先执行beginWork*（这里把beginWork的内容去掉了只留下了console，实际上React在此做fiber树构建，children协调工作）*。beginWork做完后，如果有child就把child当作下一个工作单元。如果没有child，说明当前fiber的子树都做完了beginWork。则执行completeWork*（实际上React在此做DOM创建、effectList串联等工作）*。\n\ncompleteWork做完后，如果有兄弟节点sibling，则把sibling作为下一个工作单元。如果没有兄弟节点了，说明当前fiber的兄弟也全部做完了beginWork和completeWork。是时候返回父节点，并让父节点做completeWork了。\n\n要返回父节点但是不能将父节点作为下一个workInProgress，否则就死循环了。只需要让它走completeWork即可。所以React在这里又套了一个循环，将父节点作为completedWork单元，执行上面所说的逻辑。\n\n接下来，我们测试下这个workLoop的执行流程。首先用代码创建上图中示例的fiber树：\n\n```javascript\nfunction createFiber(tag) {\n  return { tag, return: null, child: null, sibling: null };\n}\n\n// 生成如下结构的fiber树\n// <App>\n//   <h1>\n//     <div></div>\n//   </h1>\n//   <Detail>\n//     <button></button>\n//   </Detail>\n// </App>\nfunction generateFiberTree() {\n  const app = createFiber(\"App\");\n\n  const h1 = createFiber(\"h1\");\n  app.child = h1;\n  h1.return = app;\n\n  const detail = createFiber(\"Detail\");\n  h1.sibling = detail;\n  detail.return = app;\n\n  const div = createFiber(\"div\");\n  h1.child = div;\n  div.return = h1;\n\n  const button = createFiber(\"button\");\n  detail.child = button;\n  button.return = detail;\n\n  return app;\n}\n```\n\n然后调用workLoop：\n\n```javascript\nlet root = generateFiberTree();\nworkInProgress = root;\nworkLoopConcurrent();\n```\n\n查看控制台日志：\n\n```shell\nbegin work on [App]\nbegin work on [h1]\nbegin work on [div]\ncomplete work on [div]\ncomplete work on [h1]\nbegin work on [Detail]\nbegin work on [button]\ncomplete work on [button]\ncomplete work on [Detail]\ncomplete work on [App]\n```\n\n一切OK。看结果它和老架构一样，是自上而下，深度优先的遍历方式，只不过它不是递归实现的，而是通过`while循环+修改fiber工作指针`的形式。发散一下，如果我们要用递归的形式实现又是什么样子？直接上代码：\n\n```javascript\n// 递归工作循环\nfunction workLoopRecursive(unitOfWork) {\n  // 模拟beginWork\n  console.log(`begin work on [${unitOfWork.tag}]`);\n\n  if (unitOfWork.child !== null) {\n    workLoopRecursive(unitOfWork.child);\n  }\n\n  // 模拟completeWork\n  console.log(`complete work on [${unitOfWork.tag}]`);\n\n  if (unitOfWork.sibling !== null) {\n    workLoopRecursive(unitOfWork.sibling);\n  }\n}\n// 运行测试\nlet root = generateFiberTree();\nworkLoopRecursive(root);\n```\n\nLook！递归的代码简单太多了，而且return都不需要了。因为递归自己知道怎么返回！可以运行一下测试，会发现结果和上面的一样。\n\n既然递归这么简单，为什么要费这么大劲呢？前面就说到了，因为一旦递归就不可中断。那现在这种形式，又如何实现中断？\n\n### 中断执行\n\n回到workLoopConcurrent方法里，while的条件里有一个`shouldYield()`方法。React里就是用这个方法实现的可中断，并且由于workInProgress记录了工作进度，下一次就可以恢复工作！\n\n我们测试一下， 目前shouldYield方法里，直接`return false`。实际上React会在这里根据下一个更新的优先级，可能在这里`return true`。我们测试的话，就加个count吧，比如我们处理3个节点后，就中断处理。修改shouldYield方法：\n\n```javascript\nlet count = 0;\n// 是否需要中断\nfunction shouldYield() {\n  if (count++ >= 3) {\n    return true;\n  }\n  return false;\n}\n```\n\n运行测试一下。结果为：\n\n```shell\nbegin work on [App]\nbegin work on [h1]\nbegin work on [div]\ncomplete work on [div]\ncomplete work on [h1]\n```\n\n可以看到，从根节点开始，执行了三个节点的work后就退出了。可能有同学要问了，为什么completWork执行了，但是只执行了两个？\n\n从上面的源码可以看到，completeWork是不中断的，只有beginWork的while循环才判断是否需要中断。所以只要工作单元及其子树的beginWork都做完了，就一定会执行它的completWork。只要没完全做完就不执行。所以App节点，因为它还没有处理完子树的beginWork，所以它的completeWork也就没有执行。从设计角度来说，这也是非常合理的。\n\n### 中断后恢复\n\n既然能中断，那就要能恢复。当前能在合适的时机下，再恢复工作进度吗？我们再改造一下shouldYield方法和测试代码，模拟一下中断然后立刻恢复：\n\n```javascript\nlet max = 3;\nlet count = 0;\n// 是否需要中断\nfunction shouldYield() {\n  if (count++ >= max) { //使用max控制中断时机\n    return true;\n  }\n  return false;\n}\n\nlet root = generateFiberTree();\nworkInProgress = root;\nworkLoopConcurrent(); // 第一次工作循环\n\nconsole.log(\"work loop break off\\n\"); \n\n// 将第二次工作的中断次数调高\nmax = 1000000;\nconsole.log(\"work loop restart\")\nworkLoopConcurrent();\n```\n\n查看输出结果为：\n\n```shell\nbegin work on [App]\nbegin work on [h1]\nbegin work on [div]\ncomplete work on [div]\ncomplete work on [h1]\nwork loop break down\n\nwork loop restart\nbegin work on [Detail]\nbegin work on [button]\ncomplete work on [button]\ncomplete work on [Detail]\ncomplete work on [App]\n```\n\n非常牛x！看来确实实现了在哪里中断，就在哪里恢复，没有漏运行任何一个工作。这样的话，再搭配React16的异步调度器Scheduler，就可以实现渲染过程的中断、恢复，高优先级更新打断前一次更新等各种操作了。\n\n> 本文所用到的源码在[codeSandbox上](https://codesandbox.io/p/devbox/xj625g)。\n"}}},"pageContext":{"slug":"/react-workloop","nexttitle":"云流","nextslug":"/云流","prevtitle":"云流-Nocodb应用","prevslug":"/云流-nocodb应用","relatedPosts":[{"title":"谈一谈React18的批处理","description":"介绍React18的并发和批处理相关知识","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAADAAL/2gAMAwEAAhADEAAAAeclkhySZv/EABkQAQACAwAAAAAAAAAAAAAAAAERMQACEv/aAAgBAQABBQKWBOm2trz/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAECEiUYH/2gAIAQEABj8CLYQuL//EABsQAAICAwEAAAAAAAAAAAAAAAABETEQIUFx/9oACAEBAAE/IWxdkFYRnwUFXjH/2gAMAwEAAgADAAAAEKP/AP/EABcRAQADAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QS8j/xAAWEQADAAAAAAAAAAAAAAAAAAABECH/2gAIAQIBAT8QMX//xAAcEAEAAwACAwAAAAAAAAAAAAABABEhMUFRYfD/2gAIAQEAAT8Q4Q5WAQPCaL9qy5y7yEGo6n2PEtn/2Q=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/56675/react18-feature.jpg","srcSet":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/9fa5a/react18-feature.jpg 184w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/2a971/react18-feature.jpg 367w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/56675/react18-feature.jpg 734w","sizes":"(min-width: 734px) 734px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/9d028/react18-feature.avif 184w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/fcbd2/react18-feature.avif 367w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/61ef5/react18-feature.avif 734w","type":"image/avif","sizes":"(min-width: 734px) 734px, 100vw"},{"srcSet":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/ef27d/react18-feature.webp 184w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/6963a/react18-feature.webp 367w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/bce1f/react18-feature.webp 734w","type":"image/webp","sizes":"(min-width: 734px) 734px, 100vw"}]},"width":734,"height":368},"coverImageAlt":"封面","datePublished":"2024-06-24T19:28:20.000Z","dateModified":"2024-06-24T19:28:20.000Z","category":"经验总结","tags":["前端","React","架构","造轮子"],"excerpt":"最近笔者腾出了大把的时间，学习了一下React18。 导航 什么是批处理？ React18之前的批处理 React18的自动批处理 批处理原理 退出批处理 回首React过往的一些重大版本： React 16.0（2017年9月）：带来了全新的Fiber…","timeToRead":1,"slug":"/react-batch","route":"/react-batch","pathName":"/leon-blog/react-batch","url":"https://missmess.github.io/leon-blog/react-batch"},{"title":"React Fiber架构总览","description":"介绍React16带来的全新fiber架构，它的设计总览","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABxpq1QP/EABYQAAMAAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIc/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAABEQAhIEGR/9oACAEBAAE/IQndxNAdx//aAAwDAQACAAMAAAAQS+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhEDFBYYH/2gAIAQEAAT8QYKKXkWrmPC7EzycaO8//2Q=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/38598/react-fiber.jpg","srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/3281a/react-fiber.jpg 186w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/3f3c9/react-fiber.jpg 372w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/38598/react-fiber.jpg 743w","sizes":"(min-width: 743px) 743px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/1043a/react-fiber.avif 186w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/75542/react-fiber.avif 372w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/4b780/react-fiber.avif 743w","type":"image/avif","sizes":"(min-width: 743px) 743px, 100vw"},{"srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/b2901/react-fiber.webp 186w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/f2d3a/react-fiber.webp 372w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/16c74/react-fiber.webp 743w","type":"image/webp","sizes":"(min-width: 743px) 743px, 100vw"}]},"width":743,"height":368.00000000000006},"coverImageAlt":"封面","datePublished":"2023-02-09T11:20:41.000Z","dateModified":"2023-02-09T11:20:41.000Z","category":"经验总结","tags":["前端","React","架构","造轮子"],"excerpt":"众所周知，React团队耗时2年多在React16发布了全新重构版本的Fiber架构，替代了原来的 Stack Recociler + Renderer…","timeToRead":2,"slug":"/react-fiber-struct","route":"/react-fiber-struct","pathName":"/leon-blog/react-fiber-struct","url":"https://missmess.github.io/leon-blog/react-fiber-struct"}]}},"staticQueryHashes":["2792541146","2845918323"]}