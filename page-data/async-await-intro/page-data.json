{"componentChunkName":"component---themes-advanced-src-templates-post-query-ts","path":"/async-await-intro","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], t.indexOf(o) >= 0 || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.indexOf(n) >= 0) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"【造轮子】async/await实现原理\",\n  \"cover\": \"../static/assets/async_await.jpeg\",\n  \"coverAlt\": \"封面图\",\n  \"description\": \"async/await是ES7的新特性，是一种异步编程的解决方案\",\n  \"datePublished\": \"2022-12-27 18:47:13\",\n  \"dateModified\": \"2022-12-27 18:47:13\",\n  \"slug\": \"async-await-intro\",\n  \"category\": \"经验总结\",\n  \"tags\": [\"前端\", \"造轮子\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"async/await\\u662FES7\\u7684\\u65B0\\u7279\\u6027\\uFF0C\\u5B83\\u662F\\u5904\\u7406\\u5F02\\u6B65\\u64CD\\u4F5C\\u7684\\u4E00\\u79CD\\u8BED\\u6CD5\\u7CD6\\uFF0C\\u4E3B\\u8981\\u662F\\u4E3A\\u4E86\\u4F7F\\u5F02\\u6B65\\u4EE3\\u7801\\u66F4\\u52A0\\u7B80\\u6D01\\u548C\\u76F4\\u89C2\\u3002\"), mdx(\"h4\", null, \"async/await\\u57FA\\u7840\\u77E5\\u8BC6\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async\"), \"\\u7528\\u5728\\u51FD\\u6570\\u4E0A\\uFF0C\\u58F0\\u660E\\u8FD9\\u4E2A\\u51FD\\u6570\\u662F\\u5F02\\u6B65\\u51FD\\u6570\\u3002\\u5F02\\u6B65\\u51FD\\u6570\\u4F1A\\u8FD4\\u56DE\\u4E00\\u4E2APromise\\u5BF9\\u8C61\\u3002\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"await\"), \"\\u7528\\u5728\\u4E00\\u4E2A\\u8FD4\\u56DEPromise\\u7684\\u8868\\u8FBE\\u5F0F\\u524D\\u9762\\uFF0C\\u5B83\\u4F1A\\u7B49\\u5F85\\u8FD9\\u4E2APromise\\u7684\\u7ED3\\u675F\\uFF0C\\u5E76\\u83B7\\u53D6Promise\\u7684\\u7ED3\\u679C\\u503C\\uFF08\\u5982\\u679C\\u5305\\u542Berror\\uFF0C\\u9700\\u8981try catch\\uFF09\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"await\"), \"\\u53EA\\u80FD\\u7528\\u5728\\u5F02\\u6B65\\u51FD\\u6570\\u5185\\uFF0C\\u5373\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async\"), \"\\u642D\\u914D\\u4F7F\\u7528\\u3002\\u5982\\u4E0B\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"async\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"asyncFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"...\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// anotherAsyncFunc\\u8FD4\\u56DEPromise\\uFF0Cresult\\u662F\\u5B83\\u7684\\u7ED3\\u679C\\u503C\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" result \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"await\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"anotherAsyncFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"...\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u7684\\u51FA\\u73B0\\uFF0C\\u8BA9\\u5F02\\u6B65\\u4EE3\\u7801\\u7F16\\u5199\\u5F88\\u7C7B\\u4F3C\\u4E8E\\u540C\\u6B65\\u4EE3\\u7801\\u7684\\u98CE\\u683C\\uFF0C\\u6BD4\\u8D77\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \"\\u7684\\u5199\\u6CD5\\uFF0C\\u4EE3\\u7801\\u53EF\\u8BFB\\u6027\\u8981\\u9AD8\\u5F88\\u591A\\u3002\"), mdx(\"p\", null, \"\\u672C\\u6B21\\u4E3B\\u8981\\u6252\\u4E00\\u4E0B\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u7684\\u5E95\\u5C42\\u5B9E\\u73B0\\uFF0C\\u5B83\\u662F\\u4E00\\u4E2A\\u8BED\\u6CD5\\u7CD6\\uFF0C\\u6240\\u4EE5\\u5B83\\u53EF\\u4EE5\\u8F6C\\u4E3A\\u8001\\u7684\\u4EE3\\u7801\\u5199\\u6CD5\\uFF1A\\u5B83\\u53EF\\u4EE5\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \"\\u5B9E\\u73B0\\u4E00\\u6837\\u7684\\u529F\\u80FD\\u3002\"), mdx(\"h4\", null, \"generator\\uFF08\\u751F\\u6210\\u5668\\uFF09\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u662FES6\\u7684\\u65B0\\u7279\\u6027\\uFF0C\\u5B83\\u662F\\u4E00\\u79CD\\u7279\\u6B8A\\u7684\\u51FD\\u6570\\uFF0C\\u53EF\\u4EE5\\u901A\\u8FC7\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u5173\\u952E\\u5B57\\u6765\\u63A7\\u5236\\u51FD\\u6570\\u7684\\u6267\\u884C\\u6D41\\u7A0B\\u3002\\u5B83\\u80FD\\u5B9E\\u73B0\\u4EE3\\u7801\\u7684\\u6682\\u505C\\u548C\\u6062\\u590D\\u6267\\u884C\\uFF0C\\u6240\\u4EE5\\u5B83\\u53EF\\u4EE5\\u7528\\u4E8E\\u5B9E\\u73B0\\u5F02\\u6B65\\u7F16\\u7A0B\\u3001\\u72B6\\u6001\\u673A\\u7B49\\u6BD4\\u8F83\\u590D\\u6742\\u7684\\u63A7\\u5236\\u6D41\\u7A0B\\u3002\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"function*\"), \"\\u58F0\\u660E\\uFF0C\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u540E\\uFF0C\\u5B83\\u4E0D\\u4F1A\\u7ACB\\u5373\\u6267\\u884C\\uFF0C\\u800C\\u662F\\u8FD4\\u56DE\\u4E00\\u4E2A\\u8FED\\u4EE3\\u5668\\u5BF9\\u8C61\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"iterator\"), \"\\u3002\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"iterator\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"next\"), \"\\u65B9\\u6CD5\\uFF0C\\u4F1A\\u9010\\u6B65\\u6267\\u884C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u4E2D\\u7684\\u4EE3\\u7801\\uFF0C\\u5E76\\u6267\\u884C\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u8BED\\u53E5\\u65F6\\u6682\\u505C\\uFF0C\\u5C06\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u540E\\u7684\\u8868\\u8FBE\\u5F0F\\u7684\\u503C\\u4F5C\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"next\"), \"\\u65B9\\u6CD5\\u7684\\u8FD4\\u56DE\\u503C\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"next\"), \"\\u65B9\\u6CD5\\u7684\\u53C2\\u6570\\u503C\\uFF0C\\u4F1A\\u4F5C\\u4E3A\\u4E0A\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u8BED\\u53E5\\u7684\\u8FD4\\u56DE\\u503C\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u6267\\u884C\\u7ED3\\u675F\\u540E\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"iterator\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"done\"), \"\\u4F1A\\u8FD4\\u56DEtrue\\u3002\\u793A\\u4F8B\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"*\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generatorFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'Start'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" data1 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"yield\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'state 1'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'return 1'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" data1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" data2 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"yield\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'state 2'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'return 2'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" data2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" iterator \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generatorFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\nconsole\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"iterator\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"next\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u4F1A\\u4F9D\\u6B21\\u6253\\u5370\\uFF1AStart\\u3001{ done: false, value: 'state 1' }\"), \"\\nconsole\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"iterator\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"next\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"\\u5F20\\u4E09\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u4F1A\\u4F9D\\u6B21\\u6253\\u5370\\uFF1Areturn 1 \\u5F20\\u4E09\\u3001{ done: false, value: 'state 2' }\"), \"\\nconsole\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"iterator\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"next\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"\\u674E\\u56DB\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u4F1A\\u4F9D\\u6B21\\u6253\\u5370\\uFF1Areturn 2 \\u674E\\u56DB\\u3001{ done: true, value: undefined }\")))), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u4E00\\u4E2A\\u5178\\u578B\\u7684\\u7528\\u9014\\u5C31\\u662F\\u642D\\u914D\\u5BF9\\u8C61\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"[Symbol Iterator]\"), \"\\u8FED\\u4EE3\\u5668\\u5C5E\\u6027\\uFF0C\\u8BA9\\u4EFB\\u610F\\u5BF9\\u8C61\\u5B9E\\u73B0\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"for..of\"), \"\\u8FED\\u4EE3\\u3002\"), mdx(\"h4\", null, \"generator\\u5B9E\\u73B0async/await\"), mdx(\"p\", null, \"\\u6BD4\\u5982\\u5982\\u4E0B\\u4F7F\\u7528\\u4E86\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u7684\\u51FD\\u6570\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// async/await\\u7684\\u5199\\u6CD5\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function-variable function\"\n  }, \"doAsync\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"async\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=>\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"start await\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" data1 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"await\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"asyncFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"asyncFunc 1\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"middle await\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" data1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" data2 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"await\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"asyncFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"data1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"end await\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" data2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"p\", null, \"\\u8BE5\\u51FD\\u6570\\u8C03\\u7528\\u65B9\\u6CD5\\u4E3A\\uFF1A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"doAync()\"), \"\\uFF0C\\u8FD4\\u56DEPromise\"), mdx(\"p\", null, \"\\u8981\\u8F6C\\u6210\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\uFF0C\\u8BA9\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u5185\\u7684\\u5199\\u6CD5\\u548C\\u8BE5\\u65B9\\u6CD5\\u7C7B\\u4F3C\\u3002\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// generator\\u7684\\u5199\\u6CD5\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"*\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"generator\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"start generator\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" data1 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"yield\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"asyncFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"asyncFunc 1\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"middle generator\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" data1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" data2 \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"yield\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"asyncFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"data1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"end generator\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" data2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u56E0\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u4F1A\\u6682\\u505C\\u6267\\u884C\\u4EE3\\u7801\\uFF0C\\u6240\\u4EE5\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u4E5F\\u5B9E\\u73B0\\u4E86\\u7C7B\\u4F3C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"await\"), \"\\u7684\\u6548\\u679C\\u3002\\u6709\\u4E86\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\uFF0C\\u9700\\u8981\\u8C03\\u7528\\u51FD\\u6570\\u540E\\u83B7\\u53D6\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"iterator\"), \"\\uFF0C\\u8BA9\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"iterator\"), \"\\u5168\\u90E8\\u6267\\u884C\\u5E76\\u76F4\\u5230\\u7ED3\\u679Cdone\\u4E3Atrue\\u3002\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u901A\\u7528\\u7684generatorRunner\\uFF0C\\u5C06yield\\u5168\\u90E8\\u6267\\u884C\\uFF0C\\u5E76\\u4E14\\u83B7\\u53D6\\u5F02\\u6B65\\u51FD\\u6570\\u8FD4\\u56DE\\u503C\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6548\\u679C\\u5C31\\u662F\\u7C7B\\u4F3C\\u4E8Easync/await\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function-variable function\"\n  }, \"generatorRunner\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function-variable function\"\n  }, \"genFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=>\"), \" Generator\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=>\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" iterator \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"genFunc\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8FDE\\u7EED\\u8C03\\u7528next\\u65B9\\u6CD5\\uFF0C\\u76F4\\u5230done\\u4E3Atrue\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"run\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"arg\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token operator\"\n  }, \"?\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token operator\"\n  }, \":\"), \" any\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" any \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" result \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" iterator\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"next\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"arg\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"result\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"done\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" result\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"value\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" Promise\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"resolve\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"result\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"value\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"then\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"run\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"p\", null, \"\\u770B\\u4EE3\\u7801\\uFF0C\\u56E0\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"yield\"), \"\\u540E\\u9762\\u8DDF\\u7684\\u662F\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \"\\uFF0C\\u6240\\u4EE5\\u9700\\u8981\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise.resolve\"), \"\\u6765\\u5904\\u7406value\\u3002\\u7136\\u540E\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"then\\u56DE\\u8C03\"), \"\\u91CC\\u9012\\u5F52\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"run()\"), \"\\u3002\\u76F4\\u5230done\\u4E3Atrue\\u3002\"), mdx(\"p\", null, \"\\u8FD9\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generatorRunner\"), \"\\u662F\\u901A\\u7528\\u7684\\uFF0C\\u53C2\\u6570\\u662F\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\uFF0C\\u4F1A\\u5C06\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u5185\\u7684\\u8BED\\u53E5\\u6309\\u987A\\u5E8F\\u6267\\u884C\\u5B8C\\uFF0C\\u9047\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \"\\u4F1A\\u7B49\\u5F85resolved\\uFF0C\\u6700\\u7EC8\\u8FD4\\u56DE\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u7684\\u8FD4\\u56DE\\u503C\\u3002\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generatorRunner\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u90FD\\u5199\\u597D\\u4E86\\uFF0C\\u8C03\\u7528\\u65B9\\u6CD5\\uFF1A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generatorRunner(generator)\"), \"\\uFF0C\\u4E5F\\u662F\\u8FD4\\u56DEPromise\\u3002\"), mdx(\"h4\", null, \"babel\\u6216ts\\u662F\\u600E\\u4E48\\u8F6C\\u8BD1\\u7684\"), mdx(\"p\", null, \"\\u524D\\u9762\\u6211\\u4EEC\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"+\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \"\\u7684\\u65B9\\u5F0F\\uFF0C\\u5B9E\\u73B0\\u4E86\\u540C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u4E00\\u6A21\\u4E00\\u6837\\u7684\\u6548\\u679C\\u3002\\u73B0\\u5728\\u770B\\u4E00\\u4E0Bbabel\\u6216ts\\u5BF9\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u662F\\u600E\\u4E48\\u5904\\u7406\\u7684\\u3002\"), mdx(\"p\", null, \"\\u5468\\u6240\\u5468\\u77E5\\uFF0C\\u4E00\\u4E9B\\u8001\\u7684\\u6D4F\\u89C8\\u5668\\u662F\\u6CA1\\u6CD5\\u8FD0\\u884Ces\\u65B0\\u7279\\u6027\\u7684\\uFF0C\\u6240\\u4EE5\\u624D\\u9700\\u8981ts\\u3001babel\\u4E4B\\u7C7B\\u7684\\u5DE5\\u5177\\u6765\\u8F6C\\u8BD1\\u4EE3\\u7801\\u3002\\u8FD8\\u662F\\u4E0A\\u9762\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u51FD\\u6570\\u7684\\u4F8B\\u5B50\\uFF0C\\u6211\\u4EEC\\u770B\\u4E00\\u4E0B\\u5B83\\u88ABtypescript\\u4ECEes7\\u4EE3\\u7801\\u8F6C\\u4E3Aes6\\u4EE3\\u7801\\u540E\\uFF0C\\u53D8\\u6210\\u4E86\\u4EC0\\u4E48\\u6837\\u5B50\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u600E\\u4E48\\u64CD\\u4F5C\\uFF1A\\u5728webpack.config.js\\u4E2D\\uFF0C\\u5173\\u95EDsourcemap\\uFF0Cts\\u4EE3\\u7801\\u914D\\u7F6E\\u7528ts-loader\\u52A0\\u8F7D\\uFF0C\\u5728tsconfig.json\\u4E2D\\u914D\\u7F6Etarget\\u4E3A'es6'\")), mdx(\"figure\", {\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"920px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/leon-blog/static/abae22a373d8b241a4288709875de96b/fd5e4/async-await-%E8%BD%AC%E8%AF%91.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"47.82608695652174%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHasUgGH//EABYQAAMAAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIU/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAbEAABBAMAAAAAAAAAAAAAAAARAAEQMUFRcf/aAAgBAQABPyHNhdGA2k0f/9oADAMBAAIAAwAAABCnD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQABBAMAAAAAAAAAAAAAAAEhABARMXGBkf/aAAgBAQABPxADKXSgJOS02nlECAOLf//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"es6转译后代码\",\n    \"title\": \"es6转译后代码\",\n    \"src\": \"/leon-blog/static/abae22a373d8b241a4288709875de96b/4d836/async-await-%E8%BD%AC%E8%AF%91.jpg\",\n    \"srcSet\": [\"/leon-blog/static/abae22a373d8b241a4288709875de96b/e83b4/async-await-%E8%BD%AC%E8%AF%91.jpg 230w\", \"/leon-blog/static/abae22a373d8b241a4288709875de96b/e41a8/async-await-%E8%BD%AC%E8%AF%91.jpg 460w\", \"/leon-blog/static/abae22a373d8b241a4288709875de96b/4d836/async-await-%E8%BD%AC%E8%AF%91.jpg 920w\", \"/leon-blog/static/abae22a373d8b241a4288709875de96b/fd5e4/async-await-%E8%BD%AC%E8%AF%91.jpg 1044w\"],\n    \"sizes\": \"(max-width: 920px) 100vw, 920px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"es6\\u8F6C\\u8BD1\\u540E\\u4EE3\\u7801\"), \"\\n  \"), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u51FD\\u6570\\u8F6C\\u4E3A\\u4E86\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"()=>__awaiter(this, ..., function* () { ... })\"), \"\\u3002\\n\\u5373\", \"_\", \"_awaiter\\u51FD\\u6570\\u52A0\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\uFF0C\\u5176\\u4E2D\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u51FD\\u6570\\u4EE3\\u7801\\uFF0C\\u548C\\u6211\\u4EEC\\u4E0A\\u9762\\u7684\\u4F8B\\u5B50\\u7684\\u4EE3\\u7801\\u4E00\\u6A21\\u4E00\\u6837\\u3002\\u8FD9\\u4E48\\u63A8\\u7B97\\u7684\\u8BDD\\uFF0C\\u90A3\", \"_\", \"_awaiter\\u51FD\\u6570\\u4F30\\u8BA1\\u5C31\\u548C\\u6211\\u4EEC\\u4E0A\\u9762\\u7684\\u4F8B\\u5B50\\u91CC\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generatorRunner\"), \"\\u529F\\u80FD\\u5DEE\\u4E0D\\u591A\\u5566\\u3002\\u770B\\u770B\", \"_\", \"_awaiter\\u51FD\\u6570\\uFF1A\"), mdx(\"figure\", {\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"920px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/491c4/async__awaiter.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"60.434782608695656%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe7qUA//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAADAAMAAAAAAAAAAAAAAAAAEBEBMUH/2gAIAQEAAT8hzvhFCL//2gAMAwEAAgADAAAAEKPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBAAAQQDAQAAAAAAAAAAAAAAAQAQESExUZFx/9oACAEBAAE/EAEaw0gGaa1yer0et//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"__awaiter函数\",\n    \"title\": \"__awaiter函数\",\n    \"src\": \"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/4d836/async__awaiter.jpg\",\n    \"srcSet\": [\"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/e83b4/async__awaiter.jpg 230w\", \"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/e41a8/async__awaiter.jpg 460w\", \"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/4d836/async__awaiter.jpg 920w\", \"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/89b2d/async__awaiter.jpg 1380w\", \"/leon-blog/static/199a7708add7cd48dae53deb1804aed2/491c4/async__awaiter.jpg 1514w\"],\n    \"sizes\": \"(max-width: 920px) 100vw, 920px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"__awaiter\\u51FD\\u6570\"), \"\\n  \"), mdx(\"p\", null, \"\\u53EF\\u4EE5\\u770B\\u5230\\u5DEE\\u4E0D\\u592A\\u591A\\uFF0C\\u53EA\\u4E0D\\u8FC7\\u591A\\u505A\\u4E86\\u4E00\\u4E9B\\u9002\\u914D\\u3002\\u90FD\\u662F\\u8FD4\\u56DEPromise\\uFF0C\\u9012\\u5F52\\u5904\\u7406result\\uFF0C\\u77E5\\u9053done\\u4E3Atrue\\u3002\"), mdx(\"p\", null, \"\\u518D\\u5F80\\u4E0B\\u770B\\u7684\\u8BDD\\uFF0C\\u6BD4\\u5982\\u5C06\\u4EE3\\u7801\\u8F6C\\u4E3Aes6\\u4E4B\\u524D\\uFF0C\\u4F1A\\u770B\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\u4E5F\\u88AB\\u8F6C\\u6210\\u4E86\\u4F4E\\u7248\\u672C\\u7684\\u5B9E\\u73B0\\uFF0C\\u800C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u4ECD\\u7136\\u4F7F\\u7528\\u540C\\u6837\\u7684\\u4EE3\\u7801\\u3002\\u6216\\u8005\\u4F7F\\u7528babel\\u53BB\\u8F6C\\u8BD1\\uFF0C\\u4E5F\\u662F\\u4E00\\u6837\\u7684\\u3002\"), mdx(\"p\", null, \"\\u6240\\u4EE5\\u8BF4\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"async/await\"), \"\\u5C31\\u662F\\u4E2A\\u8BED\\u6CD5\\u7CD6\\uFF0C\\u5B83\\u7684\\u5E95\\u5C42\\u5B9E\\u73B0\\u5C31\\u662F\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Promise\"), \" + \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"generator\"), \"\\uFF0C\\u4F46\\u662F\\u8010\\u4E0D\\u4F4F\\u5B83\\u771F\\u7684\\u5F88\\u9999\\uFF0C\\u4EE3\\u7801\\u975E\\u5E38\\u7B80\\u6D01\\u76F4\\u89C2\\u3002\"));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":1,"excerpt":"async/await是ES7的新特性，它是处理异步操作的一种语法糖，主要是为了使异步代码更加简洁和直观。 async/await基础知识 async 用在函数上，声明这个函数是异步函数。异步函数会返回一个Promise对象。 await 用在一个返回Promise…","frontmatter":{"title":"【造轮子】async/await实现原理","description":"async/await是ES7的新特性，是一种异步编程的解决方案","cover":{"publicURL":"/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/async_await.jpeg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUCAwT/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQP/2gAMAwEAAhADEAAAAa4YjMsBeOf/xAAaEAACAwEBAAAAAAAAAAAAAAAAAQIDEhMR/9oACAEBAAEFAn1mcrEO66s1I3I9bP/EABYRAQEBAAAAAAAAAAAAAAAAAAABEv/aAAgBAwEBPwFqv//EABkRAAIDAQAAAAAAAAAAAAAAAAABAgMhQf/aAAgBAgEBPwHUKuPUf//EABsQAAICAwEAAAAAAAAAAAAAAAABETICIZGh/9oACAEBAAY/ApeZf0htMsyz6bP/xAAdEAEAAgAHAAAAAAAAAAAAAAABABEQITFBYYGR/9oACAEBAAE/ISYEEuhSW9vaVF0LFJVkemCtQleZ/9oADAMBAAIAAwAAABA8L//EABgRAQADAQAAAAAAAAAAAAAAAAEAESGx/9oACAEDAQE/ELHXsQcZ/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAERcSH/2gAIAQIBAT8QnBSYNqouH//EABwQAQACAwADAAAAAAAAAAAAAAEAESFBYTFR8f/aAAgBAQABPxAYagQBL8BCwAxqzjzpNjWAUtOeoHoQwA8T7SKdFWrZ/9k="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/e228c/async_await.jpg","srcSet":"/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/e95d4/async_await.jpg 194w,\n/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/4d774/async_await.jpg 388w,\n/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/e228c/async_await.jpg 776w","sizes":"(min-width: 776px) 776px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/36d94/async_await.avif 194w,\n/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/9e772/async_await.avif 388w,\n/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/01c7d/async_await.avif 776w","type":"image/avif","sizes":"(min-width: 776px) 776px, 100vw"},{"srcSet":"/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/33de2/async_await.webp 194w,\n/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/318f3/async_await.webp 388w,\n/leon-blog/static/ad40318728e46b7272991eba3d6d28eb/7cbac/async_await.webp 776w","type":"image/webp","sizes":"(min-width: 776px) 776px, 100vw"}]},"width":776,"height":388}}},"coverAlt":"封面图","datePublished":"2022-12-27 18:47:13","dateModified":"2022-12-27 18:47:13","category":"经验总结","tags":["前端","造轮子"]},"fields":{"slug":"/async-await-intro","route":"/async-await-intro","pathName":"/leon-blog/async-await-intro","url":"https://missmess.github.io/leon-blog/async-await-intro"},"internal":{"content":"---\ntitle: \"【造轮子】async/await实现原理\"\ncover: ../static/assets/async_await.jpeg\ncoverAlt: \"封面图\"\ndescription: \"async/await是ES7的新特性，是一种异步编程的解决方案\"\ndatePublished: \"2022-12-27 18:47:13\"\ndateModified: \"2022-12-27 18:47:13\"\nslug: \"async-await-intro\"\ncategory: \"经验总结\"\ntags:\n  - 前端\n  - 造轮子\n---\n\nasync/await是ES7的新特性，它是处理异步操作的一种语法糖，主要是为了使异步代码更加简洁和直观。\n\n#### async/await基础知识\n\n`async`用在函数上，声明这个函数是异步函数。异步函数会返回一个Promise对象。\n\n`await`用在一个返回Promise的表达式前面，它会等待这个Promise的结束，并获取Promise的结果值（如果包含error，需要try catch）。`await`只能用在异步函数内，即和`async`搭配使用。如下：\n\n```javascript\nasync function asyncFunc() {\n    ...\n    // anotherAsyncFunc返回Promise，result是它的结果值\n    const result = await anotherAsyncFunc()\n    ...\n}\n```\n\n`async/await`的出现，让异步代码编写很类似于同步代码的风格，比起`Promise`的写法，代码可读性要高很多。\n\n本次主要扒一下`async/await`的底层实现，它是一个语法糖，所以它可以转为老的代码写法：它可以使用`generator`和`Promise`实现一样的功能。\n\n#### generator（生成器）\n\n`generator`是ES6的新特性，它是一种特殊的函数，可以通过`yield`关键字来控制函数的执行流程。它能实现代码的暂停和恢复执行，所以它可以用于实现异步编程、状态机等比较复杂的控制流程。\n\n`generator`函数使用`function*`声明，调用`generator`函数后，它不会立即执行，而是返回一个迭代器对象`iterator`。调用`iterator`的`next`方法，会逐步执行`generator`函数中的代码，并执行到`yield`语句时暂停，将`yield`后的表达式的值作为`next`方法的返回值。`next`方法的参数值，会作为上一个`yield`语句的返回值。`generator`函数执行结束后，`iterator`的`done`会返回true。示例：\n\n```javascript\nfunction* generatorFunc() {\n    console.log('Start')\n    const data1 = yield 'state 1';\n    console.log('return 1', data1);\n    const data2 = yield 'state 2';\n    console.log('return 2', data2);\n}\n\nconst iterator = generatorFunc();\nconsole.log(iterator.next()); // 会依次打印：Start、{ done: false, value: 'state 1' }\nconsole.log(iterator.next(\"张三\"));  // 会依次打印：return 1 张三、{ done: false, value: 'state 2' }\nconsole.log(iterator.next(\"李四\"));  // 会依次打印：return 2 李四、{ done: true, value: undefined }\n```\n\n`generator`一个典型的用途就是搭配对象的`[Symbol Iterator]`迭代器属性，让任意对象实现`for..of`迭代。\n\n#### generator实现async/await\n\n比如如下使用了`async/await`的函数：\n```javascript\n// async/await的写法\nconst doAsync = async () => {\n    console.log(\"start await\");\n    const data1 = await asyncFunc(\"asyncFunc 1\");\n    console.log(\"middle await\", data1);\n    const data2 = await asyncFunc(data1);\n    console.log(\"end await\", data2);\n};\n```\n\n该函数调用方法为：`doAync()`，返回Promise\n\n要转成`generator`，让`generator`函数内的写法和该方法类似。\n\n```javascript\n// generator的写法\nfunction* generator() {\n    console.log(\"start generator\");\n    const data1 = yield asyncFunc(\"asyncFunc 1\");\n    console.log(\"middle generator\", data1);\n    const data2 = yield asyncFunc(data1);\n    console.log(\"end generator\", data2);\n}\n```\n\n因为`yield`会暂停执行代码，所以使用`yield`也实现了类似`await`的效果。有了`generator`函数，需要调用函数后获取`iterator`，让`iterator`全部执行并直到结果done为true。\n\n```javascript\n// 通用的generatorRunner，将yield全部执行，并且获取异步函数返回值\n// 效果就是类似于async/await\nconst generatorRunner = (genFunc: () => Generator) => {\n  const iterator = genFunc();\n  // 连续调用next方法，直到done为true\n  return (function run(arg?: any): any {\n    const result = iterator.next(arg);\n    if (result.done) {\n      return result.value;\n    }\n    return Promise.resolve(result.value).then(run);\n  })();\n};\n```\n\n看代码，因为`yield`后面跟的是一个`Promise`，所以需要使用`Promise.resolve`来处理value。然后在`then回调`里递归调用`run()`。直到done为true。\n\n这个`generatorRunner`是通用的，参数是`generator`函数，会将`generator`函数内的语句按顺序执行完，遇到`Promise`会等待resolved，最终返回`generator`函数的返回值。\n\n`generatorRunner`和`generator`函数都写好了，调用方法：`generatorRunner(generator)`，也是返回Promise。\n\n#### babel或ts是怎么转译的\n\n前面我们使用`generator`+`Promise`的方式，实现了同`async/await`一模一样的效果。现在看一下babel或ts对`async/await`是怎么处理的。\n\n周所周知，一些老的浏览器是没法运行es新特性的，所以才需要ts、babel之类的工具来转译代码。还是上面的`async/await`函数的例子，我们看一下它被typescript从es7代码转为es6代码后，变成了什么样子。\n\n> 怎么操作：在webpack.config.js中，关闭sourcemap，ts代码配置用ts-loader加载，在tsconfig.json中配置target为'es6'\n\n![es6转译后代码](../static/assets/async-await-转译.jpg)\n\n可以看到`async/await`函数转为了```()=>__awaiter(this, ..., function* () { ... })```。\n即\\__awaiter函数加`generator`函数，其中`generator`函数代码，和我们上面的例子的代码一模一样。这么推算的话，那\\__awaiter函数估计就和我们上面的例子里的`generatorRunner`功能差不多啦。看看\\__awaiter函数：\n\n![__awaiter函数](../static/assets/async__awaiter.jpg)\n\n可以看到差不太多，只不过多做了一些适配。都是返回Promise，递归处理result，知道done为true。\n\n再往下看的话，比如将代码转为es6之前，会看到`Promise`和`generator`也被转成了低版本的实现，而`async/await`仍然使用同样的代码。或者使用babel去转译，也是一样的。\n\n所以说`async/await`就是个语法糖，它的底层实现就是`Promise` + `generator`，但是耐不住它真的很香，代码非常简洁直观。"}}},"pageContext":{"slug":"/async-await-intro","nexttitle":"社交百科","nextslug":"/社交百科","prevtitle":"min-ruoyi","prevslug":"/min-ruoyi","relatedPosts":[{"title":"谈一谈React18的SSR","description":"介绍React18的SSR相关知识","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB59M1QD//xAAYEAADAQEAAAAAAAAAAAAAAAABAgMQEf/aAAgBAQABBQJZlohd6c//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAADAAMAAAAAAAAAAAAAAAACEBEAITH/2gAIAQEABj8CI9Qcr6v/xAAcEAACAgIDAAAAAAAAAAAAAAABEQAxECFBYZH/2gAIAQEAAT8hGHcRbc1cg1RhuMqzOx7j/9oADAMBAAIAAwAAABDTD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQACAwADAAAAAAAAAAAAAAERIQAxQRBRcf/aAAgBAQABPxABABrExqK7gpaQYrcWa+ZsgC9GAIAPQ5o4slvH/9k="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/6890535e3478882b78f0403eb486168d/4710f/react-ssr-cover.jpg","srcSet":"/leon-blog/static/6890535e3478882b78f0403eb486168d/002be/react-ssr-cover.jpg 165w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/b4f54/react-ssr-cover.jpg 330w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/4710f/react-ssr-cover.jpg 659w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/eeb57/react-ssr-cover.jpg 1318w","sizes":"(min-width: 659px) 659px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/6890535e3478882b78f0403eb486168d/79731/react-ssr-cover.avif 165w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/6ae0f/react-ssr-cover.avif 330w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/b9b98/react-ssr-cover.avif 659w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/4ddb9/react-ssr-cover.avif 1318w","type":"image/avif","sizes":"(min-width: 659px) 659px, 100vw"},{"srcSet":"/leon-blog/static/6890535e3478882b78f0403eb486168d/55a9a/react-ssr-cover.webp 165w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/39687/react-ssr-cover.webp 330w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/62d22/react-ssr-cover.webp 659w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/6c1b1/react-ssr-cover.webp 1318w","type":"image/webp","sizes":"(min-width: 659px) 659px, 100vw"}]},"width":659,"height":368},"coverImageAlt":"封面","datePublished":"2024-07-20T12:04:20.000Z","dateModified":"2024-07-20T12:04:20.000Z","category":"经验总结","tags":["前端","React","架构","造轮子","Next"],"excerpt":"最近笔者腾出了大把的时间，学习了一下React18。 导航 什么是SSR React18之前的旧SSR 手动实现旧SSR 为什么用Next.js React18的新SSR Suspense组件 流式传输Html 流式HTML + Suspense 选择性水合 + Suspense…","timeToRead":3,"slug":"/react-ssr","route":"/react-ssr","pathName":"/leon-blog/react-ssr","url":"https://missmess.github.io/leon-blog/react-ssr"},{"title":"谈一谈React18的批处理","description":"介绍React18的并发和批处理相关知识","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAADAAL/2gAMAwEAAhADEAAAAeclkhySZv/EABkQAQACAwAAAAAAAAAAAAAAAAERMQACEv/aAAgBAQABBQKWBOm2trz/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAECEiUYH/2gAIAQEABj8CLYQuL//EABsQAAICAwEAAAAAAAAAAAAAAAABETEQIUFx/9oACAEBAAE/IWxdkFYRnwUFXjH/2gAMAwEAAgADAAAAEKP/AP/EABcRAQADAAAAAAAAAAAAAAAAAAEQESH/2gAIAQMBAT8QS8j/xAAWEQADAAAAAAAAAAAAAAAAAAABECH/2gAIAQIBAT8QMX//xAAcEAEAAwACAwAAAAAAAAAAAAABABEhMUFRYfD/2gAIAQEAAT8Q4Q5WAQPCaL9qy5y7yEGo6n2PEtn/2Q=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/56675/react18-feature.jpg","srcSet":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/9fa5a/react18-feature.jpg 184w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/2a971/react18-feature.jpg 367w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/56675/react18-feature.jpg 734w","sizes":"(min-width: 734px) 734px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/9d028/react18-feature.avif 184w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/fcbd2/react18-feature.avif 367w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/61ef5/react18-feature.avif 734w","type":"image/avif","sizes":"(min-width: 734px) 734px, 100vw"},{"srcSet":"/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/ef27d/react18-feature.webp 184w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/6963a/react18-feature.webp 367w,\n/leon-blog/static/b1d2ff9419b4177e3d87c06130565a38/bce1f/react18-feature.webp 734w","type":"image/webp","sizes":"(min-width: 734px) 734px, 100vw"}]},"width":734,"height":368},"coverImageAlt":"封面","datePublished":"2024-06-24T19:28:20.000Z","dateModified":"2024-06-24T19:28:20.000Z","category":"经验总结","tags":["前端","React","架构","造轮子"],"excerpt":"最近笔者腾出了大把的时间，学习了一下React18。 导航 什么是批处理？ React18之前的批处理 React18的自动批处理 批处理原理 退出批处理 回首React过往的一些重大版本： React 16.0（2017年9月）：带来了全新的Fiber…","timeToRead":1,"slug":"/react-batch","route":"/react-batch","pathName":"/leon-blog/react-batch","url":"https://missmess.github.io/leon-blog/react-batch"}]}},"staticQueryHashes":["2792541146","2845918323"]}