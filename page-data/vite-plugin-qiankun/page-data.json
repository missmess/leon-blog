{"componentChunkName":"component---themes-advanced-src-templates-post-query-ts","path":"/vite-plugin-qiankun","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], t.indexOf(o) >= 0 || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.indexOf(n) >= 0) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"vite-plugin-qiankun\",\n  \"cover\": \"images/default_img5.jpg\",\n  \"coverAlt\": \"封面\",\n  \"description\": \"让qiankun框架支持vite的es特性的框架\",\n  \"datePublished\": \"2022-09-02 11:38:19\",\n  \"dateModified\": \"2022-09-02 11:38:19\",\n  \"category\": \"框架工具\",\n  \"tags\": [\"前端\", \"库\", \"微前端\", \"Vite\", \"开源\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"vite-plugin-qiankun\\u662F\\u7528\\u4E8Evite\\u6784\\u5EFA\\u7684\\u5FAE\\u5E94\\u7528\\uFF0C\\u60F3\\u8981\\u63A5\\u5165qiankun\\u65F6\\uFF0C\\u9700\\u8981\\u5F15\\u5165\\u8BE5\\u63D2\\u4EF6\\u3002\"), mdx(\"p\", null, \"github\\u4ED3\\u5E93\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/missmess/vite-plugin-qiankun/tree/feature/support-prod-publicpath\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"https://github.com/missmess/vite-plugin-qiankun/tree/feature/support-prod-publicpath\")), mdx(\"hr\", null), mdx(\"h3\", null, \"\\u4E3A\\u4EC0\\u4E48\\u9700\\u8981\\u8FD9\\u4E2A\\u63D2\\u4EF6\\uFF1F\"), mdx(\"p\", null, \"qiankun\\u52A0\\u8F7Dvite\\u5FAE\\u5E94\\u7528\\u65F6\\uFF0C\\u5F00\\u53D1\\u6A21\\u5F0F\\u4E0B\\uFF0C\\u5BF9\\u4E8EES\\u6A21\\u5757\\u65E0\\u6CD5\\u83B7\\u53D6\\u5230\\u5BF9\\u5E94\\u7684\\u751F\\u547D\\u5468\\u671F\\u51FD\\u6570\\u3002\\u6240\\u4EE5\\u9700\\u8981\\u4FEE\\u6539html entry\\u7684\\u4EE3\\u7801\\u6765hack\\u751F\\u547D\\u5468\\u671F\\u7684\\u51FD\\u6570\\u3002\"), mdx(\"p\", null, \"\\u540C\\u65F6\\u5FAE\\u5E94\\u7528\\u7684\\u76F8\\u5BF9\\u8DEF\\u5F84\\u7684\\u8D44\\u6E90\\u9700\\u8981\\u6DFB\\u52A0\\u524D\\u7F00\\uFF08\\u5FAE\\u5E94\\u7528\\u7684\\u5730\\u5740\\uFF09\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__\"), \"\\u3002\\u5426\\u5219\\u8D44\\u6E90\\u52A0\\u8F7D\\u4F1A\\u51FA\\u73B0404\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u53C2\\u8003\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://qiankun.umijs.org/zh/faq#a-%E4%BD%BF%E7%94%A8-webpack-%E8%BF%90%E8%A1%8C%E6%97%B6-publicpath-%E9%85%8D%E7%BD%AE\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"qiankun\\u4F7F\\u7528webpack\\u65F6\\u7684publicPath\"))), mdx(\"p\", null, \"webpack\\u672C\\u8EAB\\u5C31\\u6709\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://webpack.js.org/guides/public-path/#on-the-fly\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"runtime publicPath\\u6280\\u672F\"), \"\\uFF0C\\u800Cvite\\u8FD8\\u6CA1\\u6709\\u3002\"), mdx(\"h3\", null, \"\\u539F\\u7406\"), mdx(\"p\", null, \"qiankun\\u52A0\\u8F7Dvite\\u5FAE\\u5E94\\u7528\\uFF0Chack\\u4EE3\\u7406\\u65B9\\u6CD5window.proxy\", \"[vite-app-name]\", \".mount\\u6307\\u5411\\u4EE3\\u7801\\u4E2D\\u914D\\u7F6E\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"renderWithQiankun\"), \"\\u7684\\u53C2\\u6570\\u5BF9\\u8C61\\u3002\\u8FD9\\u6837qiankun\\u5C31\\u80FD\\u6B63\\u5E38\\u8C03\\u7528\\u5404\\u4E2A\\u751F\\u547D\\u5468\\u671F\\u51FD\\u6570\\u3002\"), mdx(\"p\", null, \"\\u540C\\u65F6\\uFF0Cvite\\u5F00\\u53D1\\u73AF\\u5883\\u4E0B\\uFF0C\\u52A0\\u8F7Dqiankun\\u5FAE\\u5E94\\u7528\\u7684esm\\u6A21\\u5757\\u65F6\\uFF0C\\u9700\\u8981\\u4FEE\\u6539\\u8DEF\\u5F84\\u8FFD\\u52A0\\u524D\\u7F00\\u3002\\n\\u6BD4\\u5982\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"./main.ts\"), \"\\uFF0C\\u9700\\u8981\\u6539\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__ + '/main.ts'\"), \"\\u3002\"), mdx(\"p\", null, \"\\u8FD9\\u6837\\u7684\\u8BDD\\uFF0Cqiankun\\u5C31\\u80FD\\u6B63\\u5E38\\u52A0\\u8F7Des\\u6A21\\u5757\\u5165\\u53E3\\u4EE3\\u7801\\u3002\"), mdx(\"h3\", null, \"\\u4F7F\\u7528\\u65B9\\u6CD5\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5B89\\u88C5\")), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"@oneline.top/vite-plugin-qiankun\"), \"\\u7528\\u4E8E\\u652F\\u6301qiankun\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"vite-plugin-dynamic-base\"), \"\\u7528\\u4E8Evite\\u652F\\u6301\\u52A8\\u6001publicPath\\u3002\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"shell\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-shell\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"npm\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"install\"), \" -D @oneline.top/vite-plugin-qiankun vite-plugin-dynamic-base\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"vite.config.ts\")), mdx(\"p\", null, \"\\u914D\\u7F6E\\u52A8\\u6001base\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"window.__DYNAMIC_BASE_PATH__\"), \"\\u53D8\\u91CF\\u3002\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"typescript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-typescript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-typescript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"import\"), \" qiankun \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"from\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'@oneline.top/vite-plugin-qiankun'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"...\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"export\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"default\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"defineConfig\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \" mode \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=>\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    plugins\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"...\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"qiankun\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token constant\"\n  }, \"MICRO_APP_NAME\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        useDevMode\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// qiankun-plugin\\u9ED8\\u8BA4\\u4F1A\\u5904\\u7406js\\u6587\\u4EF6\\uFF0C\\u8DDF\\u8BBE\\u7F6E\\u7684base\\u51B2\\u7A81\\u4E86\\uFF0C\\u6240\\u4EE5\\u9700\\u8981\\u624B\\u52A8\\u53BB\\u6389\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function-variable function\"\n  }, \"urlTransform\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"ori\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=>\"), \" ori\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"replace\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'/__dynamic_base__'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"''\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"dynamicBase\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6240\\u6709\\u7684\\u8D44\\u6E90\\u5BFC\\u5165\\u8DEF\\u5F84\\uFF0C\\u524D\\u7F00\\u52A0\\u4E0A\\u8BE5\\u52A8\\u6001\\u53D8\\u91CF\"), \"\\n        publicPath\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"' window.__DYNAMIC_BASE_PATH__ '\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u662F\\u5426\\u8F6C\\u6362\\u5165\\u53E3html\\u6587\\u4EF6\"), \"\\n        transformIndexHtml\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"...\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// dynamicBase\\u8981\\u6C42\\u6253\\u5305\\u65F6\\u5FC5\\u987B\\u52A0\\u4E0A\\u8BE5\\u524D\\u7F00\\uFF0C\\u7528\\u6765\\u5728\\u4EE3\\u7801\\u4E2D\\u5339\\u914D\\u5E76\\u66FF\\u6362\\u4E3AdynamicBase.publicPath\"), \"\\n    base\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" process\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"env\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token constant\"\n  }, \"NODE_ENV\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"===\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'production'\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"?\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'/__dynamic_base__/'\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"'/'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\")))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"main.ts\")), mdx(\"p\", null, \"\\u5728\\u5165\\u53E3\\u6587\\u4EF6\\u8BBE\\u7F6E\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"window.__DYNAMIC_BASE_PATH__\"), \"\\u52A8\\u6001\\u53D8\\u91CF\\u4ECEqiankun\\u53D8\\u91CF\\u6765\\u83B7\\u53D6\\u3002\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u7528\\u4E8E\\u5B50\\u5E94\\u7528\\u7684\\u8D44\\u6E90\\u52A8\\u6001\\u52A0\\u8F7D\\u8DEF\\u5F84\"), \"\\nwindow\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"__DYNAMIC_BASE_PATH__ \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" window\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"proxy \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"?\"), \" window\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"proxy\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"__INJECTED_PUBLIC_PATH_BY_QIANKUN__ \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"''\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"h3\", null, \"\\u5B58\\u5728\\u7684\\u95EE\\u9898\"), mdx(\"p\", null, \"\\u751F\\u4EA7\\u73AF\\u5883\\u5FC5\\u987B\\u8981\\u5728vite.config.ts\\u4E2D\\u914D\\u7F6Ebase\\u3002\\u4F46\\u662F\\u8FD9\\u6837\\u7684\\u8BDD\\u5C31\\u4E0D\\u80FD\\u652F\\u6301\\u591A\\u73AF\\u5883\\u90E8\\u7F72\\u4E86\\uFF08\\u5982\\u5FAE\\u5E94\\u7528\\u90E8\\u7F72\\u5230//xxx.prod.com\\u3001//xxx.test.com\\uFF09\\u3002\"), mdx(\"p\", null, \"\\u4F46\\u662Fvite\\u53C8\\u4E0D\\u50CFwebpack\\u4E00\\u6837\\u652F\\u6301runtime publicPath\\uFF0C\\u6240\\u4EE5\\u7528\\u5230\\u4E86\\u53E6\\u4E00\\u4E2A\\u63D2\\u4EF6\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/chenxch/vite-plugin-dynamic-base\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"vite-plugin-dynamic-base\"), \"\\u3002\"), mdx(\"p\", null, \"vite-plugin-qiankun\\u548C\\u8FD9\\u4E2A\\u63D2\\u4EF6\\u6709\\u51B2\\u7A81\\uFF0C\\u6240\\u4EE5\\u4FEE\\u6539\\u4E86vite-plugin-qiankun\\u6E90\\u7801\\uFF0C\\u589E\\u52A0\\u4E86urlTransform\\u7279\\u6027\\uFF0C\\u8BA9\\u63D2\\u4EF6\\u5BF9\\u8DEF\\u5F84\\u505A\\u9884\\u8F6C\\u6362\\u3002\"), mdx(\"p\", null, \"\\u540C\\u65F6\\u53BB\\u6389\\u63D2\\u4EF6\\u4E2D\\uFF0C\\u751F\\u4EA7\\u73AF\\u5883\\u4E0B\\u4E0D\\u652F\\u6301\\u52A8\\u6001base\\u7684\\u4EE3\\u7801\\u3002\"), mdx(\"p\", null, \"\\u6700\\u540E\\u5B9E\\u73B0\\u7684\\u6548\\u679C\\u5C31\\u662F\\uFF0Cvite+React\\u7684\\u5FAE\\u5E94\\u7528\\u80FD\\u5728\\u5F00\\u53D1\\u73AF\\u5883\\u4E0B\\u6B63\\u5E38\\u4F7F\\u7528\\u3002\\u540C\\u65F6\\u751F\\u4EA7\\u6253\\u5305\\u540E\\uFF0C\\u80FD\\u652F\\u6301\\u591A\\u73AF\\u5883\\u90E8\\u7F72\\u3002\\u5FAE\\u5E94\\u7528\\u53EF\\u4EE5\\u7528\\u57DF\\u540D\\u76F4\\u63A5\\u8BBF\\u95EE\\uFF1B\\u4E5F\\u53EF\\u4EE5\\u5728\\u4E3B\\u5E94\\u7528\\u4E2D\\u52A0\\u8F7D\\uFF0C\\u5FAE\\u5E94\\u7528\\u7684\\u8D44\\u6E90\\u5730\\u5740\\u59CB\\u7EC8\\u662F\\u4ECE\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"__INJECTED_PUBLIC_PATH_BY_QIANKUN__\"), \"\\u53C2\\u6570\\u83B7\\u53D6\\u7684\\uFF0C\\u4E0D\\u4F1A404\\u3002\"), mdx(\"p\", null, \"\\u539Fissue\\u94FE\\u63A5\\uFF1A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/tengmaoqing/vite-plugin-qiankun/issues/16\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"https://github.com/tengmaoqing/vite-plugin-qiankun/issues/16\")));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":1,"excerpt":"vite-plugin-qiankun是用于vite构建的微应用，想要接入qiankun时，需要引入该插件。 github仓库： https://github.com/missmess/vite-plugin-qiankun/tree/feature/support-prod…","frontmatter":{"title":"vite-plugin-qiankun","description":"让qiankun框架支持vite的es特性的框架","cover":{"publicURL":"/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/default_img5.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAgP/xAAWAQEBAQAAAAAAAAAAAAAAAAADAAT/2gAMAwEAAhADEAAAAd0w9R1IRF//xAAaEAACAwEBAAAAAAAAAAAAAAAAAQIDERMh/9oACAEBAAEFAvE+2KVluoiNs//EABgRAAIDAAAAAAAAAAAAAAAAAAACESEx/9oACAEDAQE/AWyyT//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAACETEBEDL/2gAIAQEABj8CuSEXBy27P//EABwQAQABBQEBAAAAAAAAAAAAAAEAESExQXGBkf/aAAgBAQABPyEtFMbUgvECbB4MyezaVWX2f//aAAwDAQACAAMAAAAQQ+//xAAXEQADAQAAAAAAAAAAAAAAAAAAAUEh/9oACAEDAQE/EGToZh//xAAWEQEBAQAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QB2f/xAAdEAEBAAIBBQAAAAAAAAAAAAABEQAhQXGBkbHx/9oACAEBAAE/EKpATAJLVfGA7gciD15wrtxdj1jSS/GNm3GF1Huz/9k="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/04adf/default_img5.jpg","srcSet":"/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/a10bb/default_img5.jpg 250w,\n/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/0d420/default_img5.jpg 500w,\n/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/04adf/default_img5.jpg 1000w","sizes":"(min-width: 1000px) 1000px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/298bc/default_img5.avif 250w,\n/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/7c90d/default_img5.avif 500w,\n/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/f3bb3/default_img5.avif 1000w","type":"image/avif","sizes":"(min-width: 1000px) 1000px, 100vw"},{"srcSet":"/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/f836f/default_img5.webp 250w,\n/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/97b84/default_img5.webp 500w,\n/leon-blog/static/c1ff24cf1a57db96025bbcec71e9035b/8963c/default_img5.webp 1000w","type":"image/webp","sizes":"(min-width: 1000px) 1000px, 100vw"}]},"width":1000,"height":500}}},"coverAlt":"封面","datePublished":"2022-09-02 11:38:19","dateModified":"2022-09-02 11:38:19","category":"框架工具","tags":["前端","库","微前端","Vite","开源"]},"fields":{"slug":"/vite-plugin-qiankun","route":"/vite-plugin-qiankun","pathName":"/leon-blog/vite-plugin-qiankun","url":"https://missmess.github.io/leon-blog/vite-plugin-qiankun"},"internal":{"content":"---\ntitle: \"vite-plugin-qiankun\"\ncover: images/default_img5.jpg\ncoverAlt: \"封面\"\ndescription: \"让qiankun框架支持vite的es特性的框架\"\ndatePublished: \"2022-09-02 11:38:19\"\ndateModified: \"2022-09-02 11:38:19\"\ncategory: \"框架工具\"\ntags:\n  - 前端\n  - 库\n  - 微前端\n  - Vite\n  - 开源\n---\n\nvite-plugin-qiankun是用于vite构建的微应用，想要接入qiankun时，需要引入该插件。\n\ngithub仓库：https://github.com/missmess/vite-plugin-qiankun/tree/feature/support-prod-publicpath\n\n---\n\n### 为什么需要这个插件？\n\nqiankun加载vite微应用时，开发模式下，对于ES模块无法获取到对应的生命周期函数。所以需要修改html entry的代码来hack生命周期的函数。\n\n同时微应用的相对路径的资源需要添加前缀（微应用的地址）```window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__```。否则资源加载会出现404。\n\n> 参考：[qiankun使用webpack时的publicPath](https://qiankun.umijs.org/zh/faq#a-%E4%BD%BF%E7%94%A8-webpack-%E8%BF%90%E8%A1%8C%E6%97%B6-publicpath-%E9%85%8D%E7%BD%AE)\n\nwebpack本身就有[runtime publicPath技术](https://webpack.js.org/guides/public-path/#on-the-fly)，而vite还没有。\n\n### 原理\n\nqiankun加载vite微应用，hack代理方法window.proxy[vite-app-name].mount指向代码中配置的`renderWithQiankun`的参数对象。这样qiankun就能正常调用各个生命周期函数。\n\n同时，vite开发环境下，加载qiankun微应用的esm模块时，需要修改路径追加前缀。\n比如```./main.ts```，需要改为```window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__ + '/main.ts'```。\n\n这样的话，qiankun就能正常加载es模块入口代码。\n\n### 使用方法\n\n**安装**\n\n`@oneline.top/vite-plugin-qiankun`用于支持qiankun。`vite-plugin-dynamic-base`用于vite支持动态publicPath。\n\n```shell\nnpm install -D @oneline.top/vite-plugin-qiankun vite-plugin-dynamic-base\n```\n\n**vite.config.ts**\n\n配置动态base为`window.__DYNAMIC_BASE_PATH__`变量。\n\n```typescript\nimport qiankun from '@oneline.top/vite-plugin-qiankun';\n...\nexport default defineConfig(({ mode }) => {\n  return {\n    plugins: [\n      ...\n      qiankun(MICRO_APP_NAME, {\n        useDevMode: true,\n        // qiankun-plugin默认会处理js文件，跟设置的base冲突了，所以需要手动去掉\n        urlTransform: (ori) => ori.replace('/__dynamic_base__', ''),\n      }),\n      dynamicBase({\n        // 所有的资源导入路径，前缀加上该动态变量\n        publicPath: ' window.__DYNAMIC_BASE_PATH__ ',\n        // 是否转换入口html文件\n        transformIndexHtml: true,\n      }),\n    ],\n    ...\n    // dynamicBase要求打包时必须加上该前缀，用来在代码中匹配并替换为dynamicBase.publicPath\n    base: process.env.NODE_ENV === 'production' ? '/__dynamic_base__/' : '/',\n  }\n})\n```\n\n**main.ts**\n\n在入口文件设置`window.__DYNAMIC_BASE_PATH__`动态变量从qiankun变量来获取。\n\n\n```javascript\n// 用于子应用的资源动态加载路径\nwindow.__DYNAMIC_BASE_PATH__ = window.proxy ? window.proxy.__INJECTED_PUBLIC_PATH_BY_QIANKUN__ : '';\n```\n\n### 存在的问题\n\n生产环境必须要在vite.config.ts中配置base。但是这样的话就不能支持多环境部署了（如微应用部署到//xxx.prod.com、//xxx.test.com）。\n\n但是vite又不像webpack一样支持runtime publicPath，所以用到了另一个插件：[vite-plugin-dynamic-base](https://github.com/chenxch/vite-plugin-dynamic-base)。\n\nvite-plugin-qiankun和这个插件有冲突，所以修改了vite-plugin-qiankun源码，增加了urlTransform特性，让插件对路径做预转换。\n\n同时去掉插件中，生产环境下不支持动态base的代码。\n\n最后实现的效果就是，vite+React的微应用能在开发环境下正常使用。同时生产打包后，能支持多环境部署。微应用可以用域名直接访问；也可以在主应用中加载，微应用的资源地址始终是从`__INJECTED_PUBLIC_PATH_BY_QIANKUN__`参数获取的，不会404。\n\n原issue链接：https://github.com/tengmaoqing/vite-plugin-qiankun/issues/16"}}},"pageContext":{"slug":"/vite-plugin-qiankun","nexttitle":"灵境低代码平台","nextslug":"/灵境低代码平台","prevtitle":"【造轮子】Vue双端diff算法","prevslug":"/vue-demo-diff","relatedPosts":[{"title":"procomponents-template","description":"ProComponents封装的低代码脚手架","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdKLBooaR//EABgQAAIDAAAAAAAAAAAAAAAAAAAiARIg/9oACAEBAAEFAnHItj//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAYEAACAwAAAAAAAAAAAAAAAAAAQhEgIf/aAAgBAQAGPwJRTYp//8QAGhAAAQUBAAAAAAAAAAAAAAAAAAERICHw4f/aAAgBAQABPyHVj4U4kP/aAAwDAQACAAMAAAAQMO//xAAWEQADAAAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8QrKz/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxCI/8QAHBAAAgICAwAAAAAAAAAAAAAAAREAISAxQVGB/9oACAEBAAE/ECnYeIDlb8XaUFHdW1h//9k="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/fff17/procomponents_cover.jpg","srcSet":"/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/9fa5a/procomponents_cover.jpg 184w,\n/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/63e75/procomponents_cover.jpg 368w,\n/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/fff17/procomponents_cover.jpg 736w","sizes":"(min-width: 736px) 736px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/9d028/procomponents_cover.avif 184w,\n/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/c6ee4/procomponents_cover.avif 368w,\n/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/b4627/procomponents_cover.avif 736w","type":"image/avif","sizes":"(min-width: 736px) 736px, 100vw"},{"srcSet":"/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/ef27d/procomponents_cover.webp 184w,\n/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/4ae45/procomponents_cover.webp 368w,\n/leon-blog/static/b8db5f68157645c122f55f49912c1e2a/20e6b/procomponents_cover.webp 736w","type":"image/webp","sizes":"(min-width: 736px) 736px, 100vw"}]},"width":736,"height":368},"coverImageAlt":"封面","datePublished":"2021-12-02T10:50:54.000Z","dateModified":"2021-12-02T10:50:54.000Z","category":"框架工具","tags":["前端","React","脚手架","开源","低代码","Vite"],"excerpt":"使用ProComponents封装的带页面模版的低代码脚手架。方便 后台开发人员 或 不熟悉React开发语言的开发者 ，能自己轻松搭建常见后台的crud列表页及详情页。 gitee仓库： https://gitee.com/missmess/pro-components…","timeToRead":1,"slug":"/procomponents-template","route":"/procomponents-template","pathName":"/leon-blog/procomponents-template","url":"https://missmess.github.io/leon-blog/procomponents-template"},{"title":"vite-reactts-starter","description":"vite+react+ts+Antd+redux+eslint项目启动脚手架","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIFBP/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdFKdURBwf/EABwQAAEDBQAAAAAAAAAAAAAAAAACBBIBAxARM//aAAgBAQABBQJjTdqKSKRhxx//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAABBAMAAAAAAAAAAAAAAAABACEykRARcf/aAAgBAQAGPwI7d1EUoike5//EABgQAQADAQAAAAAAAAAAAAAAAAEQQWHw/9oACAEBAAE/IReR3TJlLjyf/9oADAMBAAIAAwAAABAkL//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABYRAAMAAAAAAAAAAAAAAAAAAAEQMf/aAAgBAgEBPxA1f//EABsQAAEEAwAAAAAAAAAAAAAAABEAAdHxEKGx/9oACAEBAAE/EDU7YN3AKuQqRC3vGf/Z"},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/dba67/cover.jpg","srcSet":"/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/891f5/cover.jpg 176w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/19cc4/cover.jpg 352w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/dba67/cover.jpg 704w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/1f3b1/cover.jpg 1408w","sizes":"(min-width: 704px) 704px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/94818/cover.avif 176w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/bd4f6/cover.avif 352w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/2856f/cover.avif 704w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/69a09/cover.avif 1408w","type":"image/avif","sizes":"(min-width: 704px) 704px, 100vw"},{"srcSet":"/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/76df1/cover.webp 176w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/d3e0a/cover.webp 352w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/b4509/cover.webp 704w,\n/leon-blog/static/f0c93c86aa0622d07abc2a465eb0949a/816c4/cover.webp 1408w","type":"image/webp","sizes":"(min-width: 704px) 704px, 100vw"}]},"width":704,"height":368},"coverImageAlt":"脚手架模版","datePublished":"2021-10-10T10:27:09.000Z","dateModified":"2021-10-10T10:27:09.000Z","category":"框架工具","tags":["前端","脚手架","React","Antd","Vite","开源"],"excerpt":"Vite for React快速启动脚手架。 Vite + React + TypeScript + React Router + Redux Toolkit + Antd + Eslint + Prettier + axios + less Github仓库： https…","timeToRead":1,"slug":"/vite-reactts-starter","route":"/vite-reactts-starter","pathName":"/leon-blog/vite-reactts-starter","url":"https://missmess.github.io/leon-blog/vite-reactts-starter"}]}},"staticQueryHashes":["2792541146","2845918323"]}