{"componentChunkName":"component---themes-advanced-src-templates-post-query-ts","path":"/react-fiber-struct","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], t.indexOf(o) >= 0 || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.indexOf(n) >= 0) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"React Fiber架构总览\",\n  \"cover\": \"../static/assets/react-fiber.jpg\",\n  \"coverAlt\": \"封面\",\n  \"description\": \"介绍React16带来的全新fiber架构，它的设计总览\",\n  \"datePublished\": \"2023-02-09 11:20:41\",\n  \"dateModified\": \"2023-02-09 11:20:41\",\n  \"slug\": \"react-fiber-struct\",\n  \"category\": \"经验总结\",\n  \"tags\": [\"前端\", \"React\", \"架构\", \"造轮子\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u4F17\\u6240\\u5468\\u77E5\\uFF0CReact\\u56E2\\u961F\\u8017\\u65F62\\u5E74\\u591A\\u5728React16\\u53D1\\u5E03\\u4E86\\u5168\\u65B0\\u91CD\\u6784\\u7248\\u672C\\u7684Fiber\\u67B6\\u6784\\uFF0C\\u66FF\\u4EE3\\u4E86\\u539F\\u6765\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Stack Recociler + Renderer\"), \"\\u7684\\u67B6\\u6784\\u7EC4\\u5408\\u3002\\u91CD\\u6784\\u7684\\u4E3B\\u8981\\u5347\\u7EA7\\u76EE\\u6807\\u5C31\\u662F\\uFF0C\\u5C06\\u8001\\u67B6\\u6784\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u540C\\u6B65\\u66F4\\u65B0\"), \"\\uFF0C\\u66FF\\u6362\\u4E3A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5F02\\u6B65\\u53EF\\u4E2D\\u65AD\\u7684\\u66F4\\u65B0\"), \"\\u6A21\\u5F0F\\uFF0C\\u5E76\\u7531\\u6B64\\u5E26\\u6765\\u4E86\\u4E00\\u7CFB\\u5217\\u65B0\\u7279\\u6027\\u3002\\u672C\\u6587\\u4F1A\\u4ECE\\u603B\\u4F53\\u7684\\u89D2\\u5EA6\\u8BB2\\u4E00\\u4E0B\\u6574\\u4E2AFiber\\u67B6\\u6784\\u7684\\u5DE5\\u4F5C\\u6D41\\u7A0B\\u3002\"), mdx(\"h3\", null, \"\\u5BFC\\u822A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#%E8%80%81%E6%9E%B6%E6%9E%84\"\n  }, \"\\u8001\\u67B6\\u6784\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#%E6%96%B0%E6%9E%B6%E6%9E%84\"\n  }, \"\\u65B0\\u67B6\\u6784\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#%E8%A7%A6%E5%8F%91%E6%9B%B4%E6%96%B0\"\n  }, \"\\u89E6\\u53D1\\u66F4\\u65B0\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#render%E9%98%B6%E6%AE%B5\"\n  }, \"render\\u9636\\u6BB5\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#commit%E9%98%B6%E6%AE%B5\"\n  }, \"commit\\u9636\\u6BB5\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#scheduler%E8%B0%83%E5%BA%A6%E5%99%A8\"\n  }, \"Scheduler\\u8C03\\u5EA6\\u5668\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#lane%E6%A8%A1%E5%9E%8B\"\n  }, \"Lane\\u6A21\\u578B\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"#%E5%85%B6%E4%BB%96\"\n  }, \"\\u5176\\u4ED6\"))), mdx(\"h3\", null, \"\\u8001\\u67B6\\u6784\"), mdx(\"p\", null, \"\\u5728\\u4E86\\u89E3\\u65B0\\u67B6\\u6784\\u4E4B\\u524D\\uFF0C\\u5148\\u6765\\u770B\\u770B\\u5728\\u6B64\\u4E4B\\u524D\\u7684\\u8001\\u67B6\\u6784\\u662F\\u4EC0\\u4E48\\u6837\\u7684\\uFF0C\\u5B58\\u5728\\u4EC0\\u4E48\\u95EE\\u9898\\u3002React15\\u7684\\u67B6\\u6784\\u53EF\\u4EE5\\u5206\\u4E3A\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Reconciler\\uFF08\\u534F\\u8C03\\u5668\\uFF09\\uFF1A\\u8D1F\\u8D23\\u5BF9\\u865A\\u62DFDOM\\u4F7F\\u7528Diff\\u7B97\\u6CD5\\u627E\\u51FA\\u53D1\\u751F\\u53D8\\u5316\\u7684\\u7EC4\\u4EF6\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Renderer\\uFF08\\u6E32\\u67D3\\u5668\\uFF09\\uFF1A\\u8D1F\\u8D23\\u6839\\u636E\\u7EC4\\u4EF6\\u7684\\u53D8\\u5316\\u66F4\\u65B0\\u6E32\\u67D3\\u5230\\u9875\\u9762\\u4E0A\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u8001React\\u7684\\u5177\\u4F53\\u6E32\\u67D3\\u6D41\\u7A0B\\u53EF\\u4EE5\\u770B\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/leon-blog/vue-react-render\"\n  }, \"\\u6211\\u4E4B\\u524D\\u7684\\u6587\\u7AE0\"))), mdx(\"p\", null, \"\\u7B80\\u5355\\u6765\\u8BF4\\uFF0C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Reconciler\"), \"\\u4F1A\\u5728\\u6BCF\\u6B21\\u6E32\\u67D3\\u6D41\\u7A0B\\u4E2D\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u751F\\u6210\\u5185\\u90E8\\u7EC4\\u4EF6\\u5B9E\\u4F8B\\u3002\\u51FD\\u6570\\u7EC4\\u4EF6\\u6216\\u7C7B\\u7EC4\\u4EF6\\u8C03\\u7528render\\u65B9\\u6CD5\\uFF0C\\u5C06JSX\\u8F6C\\u5316\\u4E3A\\u865A\\u62DFDOM\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u65B0\\u751F\\u6210\\u7684\\u865A\\u62DFDOM\\u4E0E\\u4E0A\\u6B21\\u7684\\u7684\\u8FDB\\u884C\\u5BF9\\u6BD4\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u627E\\u5230\\u53EF\\u4EE5\\u590D\\u7528\\u7684\\u4E0D\\u7528\\u91CD\\u65B0\\u521B\\u5EFADOM\\uFF0C\\u5C06\\u53D8\\u5316\\u901A\\u8FC7\", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Renderer\"), \"\\u6E32\\u67D3\\u5230\\u9875\\u9762\\u4E0A\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u627E\\u4E0D\\u5230\\u53EF\\u590D\\u7528\\u7684\\uFF0C\\u901A\\u8FC7\", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Renderer\"), \"\\u64CD\\u4F5C\\u9875\\u9762DOM\\u3002\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u5BF9children\\u9012\\u5F52\\u5904\\u7406\\uFF0C\\u91CD\\u590D\\u4EE5\\u4E0A\\u6B65\\u9AA4\\u3002\")), mdx(\"p\", null, \"\\u800C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Renderer\"), \"\\u5219\\u4F1A\\u53BB\\u64CD\\u4F5CDOM\\u8282\\u70B9\\u7684\\u79FB\\u52A8\\u3001\\u66F4\\u65B0\\u3001\\u5220\\u9664\\uFF0C\\u8FD9\\u4E2A\\u8FC7\\u7A0B\\u662F\\u540C\\u6B65\\u7684\\u3002\\u5373\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Reconciler\"), \"\\u4E0E\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Renderer\"), \"\\u662F\\u4EA4\\u66FF\\u5DE5\\u4F5C\\u7684\\uFF0C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Reconciler\"), \"\\u53D1\\u73B0\\u53D8\\u5316\\u5C31\\u901A\\u77E5\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Renderer\"), \"\\u7ACB\\u5373\\u53BB\\u6E32\\u67D3\\u3002\\u76F4\\u5230\\u6574\\u4E2A\\u6E32\\u67D3\\u6D41\\u7A0B\\u7ED3\\u675F\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"React\\u652F\\u6301\\u8DE8\\u5E73\\u53F0\\uFF0C\\u4E3B\\u8981\\u4F53\\u73B0\\u5728\\u53EF\\u4EE5\\u9488\\u5BF9\\u4E0D\\u540C\\u7684\\u5E73\\u53F0\\u6709\\u4E0D\\u540C\\u7684Renderer\"), \"\\u3002\\u6211\\u4EEC\\u6700\\u719F\\u6089\\u7684\\u662FRenderer\\u662F\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.npmjs.com/package/react-dom\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"ReactDOM\"), \"\\uFF0C\\u9664\\u6B64\\u4E4B\\u5916\\uFF0C\\u8FD8\\u6709\\u5927\\u540D\\u9F0E\\u9F0E\\u7684\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.npmjs.com/package/react-native\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"React Native\"), \"\\u3002\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u8001\\u67B6\\u6784\\u7684\\u7F3A\\u70B9\")), mdx(\"p\", null, \"\\u9012\\u5F52\\u534F\\u8C03\\u5DE5\\u4F5C\\u4E00\\u65E6\\u5F00\\u59CB\\uFF0C\\u5C31\\u65E0\\u6CD5\\u7ED3\\u675F\\uFF0C\\u5FC5\\u987B\\u7B49\\u5F85\\u534F\\u8C03\\u8FC7\\u7A0B\\u7ED3\\u675F\\u3002\\u5982\\u679C\\u8282\\u70B9\\u592A\\u591A\\uFF0C\\u5904\\u7406\\u8017\\u65F6\\u592A\\u957F\\uFF08\\u8D85\\u8FC7\\u4E8616ms\\uFF09\\uFF0C\\u5219\\u53EF\\u80FD\\u4F1A\\u5BFC\\u81F4\\u9875\\u9762\\u51FA\\u73B0\\u6389\\u5E27\\u3001\\u5361\\u987F\\u3002\"), mdx(\"h3\", null, \"\\u65B0\\u67B6\\u6784\"), mdx(\"p\", null, \"\\u65B0\\u67B6\\u6784\\u4E0D\\u518D\\u4F7F\\u7528\\u5185\\u90E8\\u7EC4\\u4EF6\\u6765\\u5904\\u7406\\u865A\\u62DFDOM\\u7684diff\\uFF0C\\u800C\\u6539\\u4E3A\\u4F7F\\u7528Fiber\\u8282\\u70B9\\u3002\\u6BCF\\u4E2AFiber\\u8282\\u70B9\\u65E2\\u662F\\u4E00\\u4E2A\\u72EC\\u7ACB\\u5DE5\\u4F5C\\u5355\\u5143\\uFF0C\\u4E5F\\u662F\\u4E00\\u4E2A\\u6811\\u8282\\u70B9\\uFF0C\\u4E0E\\u5176\\u4ED6Fiber\\u8282\\u70B9\\u5171\\u540C\\u7EC4\\u6210Fiber\\u6811\\uFF0C\\u540C\\u65F6\\u4E5F\\u8BB0\\u5F55\\u7740\\u52A8\\u6001\\u7684\\u6570\\u636E\\u548C\\u72B6\\u6001\\u3002Fiber\\u8282\\u70B9\\u53EF\\u4EE5\\u8BA4\\u4E3A\\u548C\\u6BCF\\u4E00\\u4E2AJSX\\u8282\\u70B9\\u4E00\\u4E00\\u5BF9\\u5E94\\u3002\\u65B0\\u67B6\\u6784\\u4E0B\\uFF0C\\u4E0D\\u518D\\u662F\\u540C\\u6B65\\u7684\\u5B9E\\u65F6\\u66F4\\u65B0\\uFF0C\\u800C\\u662F\\u5F02\\u6B65\\u7684\\u53EF\\u4E2D\\u65AD\\u66F4\\u65B0\\u3002\"), mdx(\"p\", null, \"\\u65B0Fiber\\u67B6\\u6784\\u7684\\u8BBE\\u8BA1\\u5206\\u4E3A\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Reconciler\\uFF08\\u534F\\u8C03\\u5668\\uFF09\\uFF1A\\u8D1F\\u8D23\\u5BF9Fiber\\u8282\\u70B9\\u8FDB\\u884C\\u5BF9\\u6BD4\\uFF0C\\u627E\\u51FA\\u5176\\u4E2D\\u7684\\u53D8\\u5316\\u3002\\uFF08\\u53EF\\u4E2D\\u65AD\\u53D1\\u751F\\u5728\\u8FD9\\u91CC\\uFF09\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Renderer\\uFF08\\u6E32\\u67D3\\u5668\\uFF09\\uFF1A\\u8D1F\\u8D23\\u6839\\u636E\\u7EC4\\u4EF6\\u7684\\u53D8\\u5316\\u66F4\\u65B0\\u6E32\\u67D3\\u5230\\u9875\\u9762\\u4E0A\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Scheduler\\uFF08\\u8C03\\u5EA6\\u5668\\uFF09\\uFF1A\\u6839\\u636E\\u4F18\\u5148\\u7EA7\\uFF0C\\u5728\\u65F6\\u95F4\\u5207\\u7247\\u4E0A\\u8C03\\u5EA6\\u4EFB\\u52A1\")), mdx(\"p\", null, \"\\u5176\\u4E2DFiber\\u6811\\u8FD8\\u7528\\u5230\\u4E86\\u201C\\u53CC\\u7F13\\u5B58\\u201D\\u7684\\u6280\\u672F\\u3002\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u53CC\\u7F13\\u5B58Fiber\\u6811\"), \"\\u5C31\\u662FReact\\u4E2D\\u5B58\\u5728\\u4E24\\u68F5Fiber\\u6811\\uFF0C\\u4E00\\u68F5\\u662F\\u5F53\\u524D\\u6E32\\u67D3\\u5728\\u5C4F\\u5E55\\u4E0A\\u7684\\uFF0C\\u53EB\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"current\"), \"\\uFF0C\\u53E6\\u4E00\\u68F5\\u662F\\u5728\\u5185\\u5B58\\u4E2D\\u6B63\\u5728\\u6784\\u5EFA\\u64CD\\u4F5C\\u7684\\uFF0C\\u53EB\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"workInProgess\"), \"\\u3002\\u4E00\\u65E6\\u6784\\u5EFA\\u5B8C\\u6210\\uFF0C\\u539F\\u6765\\u7684current\\u4E22\\u5F03\\uFF0Ccurrent\\u6307\\u5411workInProgress\\uFF0C\\u5373\\u5B8C\\u6210\\u4E86Fiber\\u6811\\u7684\\u66FF\\u6362\\u3002\"), mdx(\"p\", null, \"\\u5728\\u8FD9\\u6837\\u7684\\u67B6\\u6784\\u6A21\\u5F0F\\u4E0B\\uFF0C\\u5DE5\\u4F5C\\u6A21\\u5F0F\\u53D8\\u6210\\u4E86\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Scheduler\\u63A5\\u6536\\u5230\\u66F4\\u65B0\\uFF0C\\u5224\\u65AD\\u4F18\\u5148\\u7EA7\\uFF0C\\u901A\\u77E5Reconciler\\u5F00\\u59CB\\u5DE5\\u4F5C\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Reconciler\\u8FDB\\u5165render\\u9636\\u6BB5\\u3002\\u5F00\\u59CB\\u5728\\u5185\\u5B58\\u4E2D\\u6784\\u5EFAworkInProgress\\u6811\\u3002\\u8FDB\\u5165workLoop\\uFF08\\u5DE5\\u4F5C\\u5FAA\\u73AF\\uFF09\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5BF9\\u6BCF\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\\uFF08Fiber\\uFF09\\u8FDB\\u884CbeginWork\\uFF08\\u521B\\u5EFAFiber\\uFF0Cdiff\\u548C\\u6807\\u8BB0\\u53D8\\u5316\\uFF09\\u3002beginWork\\u7ED3\\u675F\\u540E\\uFF0C\\u6267\\u884CcompleteWork\\uFF08\\u521B\\u5EFADOM\\uFF0Cchildren Append\\u7B49\\uFF09\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u6BCF\\u5B8C\\u6210\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\\uFF0C\\u901A\\u8FC7Scheduler\\u5224\\u65AD\\u662F\\u5426\\u8981\\u4E2D\\u65ADrender\\u9636\\u6BB5\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"render\\u9636\\u6BB5\\u7ED3\\u675F\\u540E\\uFF0C\\u8FDB\\u5165commit\\u9636\\u6BB5\\u3002Reconciler\\u901A\\u77E5Renderer\\u5F00\\u59CB\\u5BF9\\u53D1\\u751F\\u53D8\\u5316\\u7684\\u8282\\u70B9\\u64CD\\u4F5CDOM\\u3002\\u8FD9\\u4E2A\\u8FC7\\u7A0B\\u662F\\u540C\\u6B65\\u7684\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5B8C\\u6210\\u540E\\uFF0C\\u5C06current\\u6811\\u6307\\u5411workInProgress\\u6811\\u3002\"))), mdx(\"p\", null, \"\\u63A5\\u4E0B\\u6765\\u5C31\\u5177\\u4F53\\u8BB2\\u4E00\\u4E0B\\u6BCF\\u4E2A\\u5DE5\\u4F5C\\u6B65\\u9AA4\\u3002\"), mdx(\"h3\", null, \"\\u89E6\\u53D1\\u66F4\\u65B0\"), mdx(\"p\", null, \"\\u8FD9\\u4E9B\\u65B9\\u6CD5\\u4F1A\\u89E6\\u53D1\\u4E00\\u6B21\\u6E32\\u67D3\\u66F4\\u65B0\\u6D41\\u7A0B\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"ReactDOM.render\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"this.setState\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"this.forceUpdate\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"useState\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"dispatch\"), \"\\u51FD\\u6570\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"useReducer\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"li\",\n    \"className\": \"language-text\"\n  }, \"dispatch\"), \"\\u51FD\\u6570\")), mdx(\"p\", null, \"\\u8C03\\u7528\\u4E0A\\u8FF0\\u65B9\\u6CD5\\u4F1A\\u751F\\u6210\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u5BF9\\u8C61\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u5BF9\\u8C61\\u4E2D\\u5B58\\u50A8\\u4E86\\u4F18\\u5148\\u7EA7\\uFF08lane\\u503C\\uFF09\\u3002\\u4E00\\u7EC4\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u5BF9\\u8C61\\u4F1A\\u4EE5\\u73AF\\u72B6\\u94FE\\u8868\\u7684\\u6570\\u636E\\u7ED3\\u6784\\u5B58\\u50A8\\u5728Fiber\\u4E0A\\u3002\", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\uFF08\\u81F3\\u4E8E\\u4E3A\\u4EC0\\u4E48\\u662F\\u4E00\\u7EC4\\uFF1F\\u56E0\\u4E3A\\u5F88\\u6709\\u53EF\\u80FD\\u4F60\\u4F1A\\u5728\\u4E00\\u6B21\\u4E8B\\u4EF6\\u5904\\u7406\\u91CC\\uFF0C\\u8C03\\u7528\\u591A\\u6B21\", mdx(\"code\", {\n    parentName: \"em\",\n    \"className\": \"language-text\"\n  }, \"setState\"), \"\\uFF09\\u3002\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7C7B\\u7EC4\\u4EF6\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactUpdateQueue.old.js#L110\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"\\u4EE3\\u7801\\u4F4D\\u7F6E\"), \"\\uFF09\\u5B58\\u50A8\\u65B9\\u5F0F\\u4E0E\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u51FD\\u6570\\u7EC4\\u4EF6\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberHooks.old.js#L100\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"\\u4EE3\\u7801\\u4F4D\\u7F6E\"), \"\\uFF09\\u76F8\\u5DEE\\u751A\\u8FDC\\u3002\\u4F46\\u662F\\u8FD9\\u4E0D\\u5F71\\u54CD\\u6211\\u4EEC\\u7406\\u89E3\\u89E6\\u53D1\\u66F4\\u65B0\\u7684\\u6D41\\u7A0B\\u3002\\u7B80\\u5355\\u8BF4\\u4E0B\\uFF1A\", mdx(\"br\", null), \"\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u7C7B\\u7EC4\\u4EF6\"), \"\\u4E0B\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"UpdateQueue\"), \"\\u5B58\\u50A8\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"baseState\"), \"\\uFF08\\u7EC4\\u4EF6\\u5F53\\u524D\\u72B6\\u6001\\uFF09\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u73AF\\u72B6\\u94FE\\u8868\\uFF0C\\u5B57\\u6BB5\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Fiber.updateQueue\"), \"\\u3002\\u5230\\u4E86\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u9636\\u6BB5\\uFF0C\\u5728\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render()\"), \"\\u65B9\\u6CD5\\u524D\\u3002\\u4F1A\\u6839\\u636E\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"lane\"), \"\\u4F18\\u5148\\u7EA7\\u6765\\u8BA1\\u7B97\\u4F18\\u5148\\u7EA7\\u8DB3\\u591F\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u5E76\\u66F4\\u65B0state\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L856\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"\\u4EE3\\u7801\\u4F4D\\u7F6E\"), \"\\uFF09\\u3002\", mdx(\"br\", null), \"\\n\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u51FD\\u6570\\u7EC4\\u4EF6\"), \"\\u5C31\\u6BD4\\u8F83\\u590D\\u6742\\u4E86\\uFF0C\\u5B83\\u8DDF\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Hooks\"), \"\\u673A\\u5236\\u606F\\u606F\\u76F8\\u5173\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Fiber.updateQueue\"), \"\\u4E0A\\u5B58\\u50A8\\u7684\\u662FEffect\\uFF08\\u6765\\u6E90\\u81EA\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"useEffect\"), \"\\u3001\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"useLayoutEffect\"), \"\\uFF09\\u7684\\u73AF\\u72B6\\u94FE\\u8868\\u3002\\u5B83\\u4F1A\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\uFF08useLayoutEffect\\uFF09\\u6216\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"commit\\u9636\\u6BB5\"), \"\\uFF08useEffect\\uFF09\\u88AB\\u904D\\u5386\\u548C\\u8C03\\u7528\\u3002\\u800C\\u6211\\u4EEC\\u6240\\u8BF4\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u662F\\u4EE5\\u73AF\\u72B6\\u94FE\\u8868\\u5F62\\u5F0F\\u5B58\\u50A8\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Hook.queue\"), \"\\u91CC\\uFF0C\\u6BCF\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Hook\"), \"\\u5BF9\\u8C61\\u53C8\\u4EE5\\u5355\\u5411\\u94FE\\u8868\\u7684\\u5F62\\u5F0F\\u5B58\\u50A8\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Fiber.memoizedState\"), \"\\u5B57\\u6BB5\\u91CC\\uFF08\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberHooks.old.js#L566\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"\\u4EE3\\u7801\\u4F4D\\u7F6E\"), \"\\uFF09\\u3002state\\u662F\\u5728\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"useState\"), \"\\u65B9\\u6CD5\\u65F6\\u6839\\u636E\\u4F18\\u5148\\u7EA7\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u94FE\\u8868\\u8BA1\\u7B97\\u51FA\\u6765\\u7684\\u3002\", mdx(\"br\", null), \"\\n\\u987A\\u4FBF\\u63D0\\u4E00\\u53E5\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"HostRoot\"), \"\\u5B58\\u50A8\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\uFF08\\u7531\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"ReactDOM.render\"), \"\\u89E6\\u53D1\\uFF09\\u7684\\u65B9\\u5F0F\\u4E0E\\u7C7B\\u7EC4\\u4EF6\\u76F8\\u540C\\u3002\", mdx(\"br\", null), \"\\n\\u518D\\u63D0\\u4E00\\u53E5\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"HostComponent\"), \"\\u5373\\u539F\\u751F\\u7EC4\\u4EF6\\u4E0A\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Fiber.updateQueue\"), \"\\u5B58\\u50A8\\u7684\\u662F\\u5C5E\\u6027\\u66F4\\u65B0\\u7684\\u5B57\\u6BB5\\u548C\\u503C\\uFF0C\\u4EE5\\u6570\\u7EC4\\u5F62\\u5F0F\\u4EA4\\u66FF\\u5B58\\u50A8\\u952E\\u548C\\u503C\\uFF1A\", \"[key1, prop1, key2, prop2, ...]\", \"\\u3002\")), mdx(\"p\", null, \"\\u751F\\u6210\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u540E\\uFF0C\\u6839\\u636E\\u4F18\\u5148\\u7EA7\\u7684\\u4E0D\\u540C\\u5904\\u7406\\uFF0C\\u4F1A\\u89E6\\u53D1\\u4E00\\u6B21\\u540C\\u6B65\\u66F4\\u65B0\\u6216\\u5F02\\u6B65\\u8C03\\u5EA6\\u7684\\u66F4\\u65B0\\uFF08\\u4E5F\\u53EF\\u80FD\\u6279\\u5904\\u7406return\\u6389\\uFF0C\\u4E0D\\u53D1\\u8D77\\u65B0\\u66F4\\u65B0\\uFF09\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6BCF\\u4E00\\u4E2AUpdate\\uFF0C\\u6700\\u7EC8\\u90FD\\u4F1A\\u8D70\\u5230\\u8FD9\\u91CC\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"ensureRootIsScheduled\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// 1. \\u83B7\\u53D6lane\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// 2. \\u5224\\u65ADlane\\uFF0C\\u770B\\u662F\\u5426\\u9700\\u8981\\u53D6\\u6D88\\u8C03\\u5EA6\\u7684\\u4EFB\\u52A1\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// 3. \\u5224\\u65ADlane\\uFF0C\\u770B\\u662F\\u5426\\u9700\\u8981\\u53D1\\u8D77\\u65B0\\u7684\\u8C03\\u5EA6\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"newCallbackPriority \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"===\"), \" SyncLanePriority\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u540C\\u6B65\\u4F18\\u5148\\u7EA7\\uFF0C\\u6267\\u884C\\u540C\\u6B65\\u66F4\\u65B0\"), \"\\n    newCallbackNode \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"scheduleSyncCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performSyncWorkOnRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"bind\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"var\"), \" schedulerPriorityLevel \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"lanePriorityToSchedulerPriority\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"newCallbackPriority\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5F02\\u6B65\\u8C03\\u5EA6\\u4E00\\u6B21\\u66F4\\u65B0\\uFF08\\u53EF\\u4E2D\\u65AD\\uFF09\"), \"\\n    newCallbackNode \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"scheduleCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"\\n      schedulerPriorityLevel\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performConcurrentWorkOnRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"bind\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u540C\\u6B65\\u66F4\\u65B0\\u6267\\u884C\\u540E\\u6216\\u8005\\u5F02\\u6B65\\u66F4\\u65B0\\u88AB\\u8C03\\u5EA6\\u6267\\u884C\\u540E\\uFF0C\\u4F1A\\u8FDB\\u5165render\\u9636\\u6BB5\\u3002\\u4EE3\\u7801\\u7C7B\\u4F3C\\u4E8E\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performConcurrentWorkOnRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"root\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// render\\u9636\\u6BB5\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"renderRootConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// commit\\u9636\\u6BB5\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"commitRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"h3\", null, \"render\\u9636\\u6BB5\"), mdx(\"p\", null, \"render\\u9636\\u6BB5\\u4ECE\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"FiberRoot\"), \"\\u5F00\\u59CB\\uFF0C\\u521B\\u5EFA\\u7B2C\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"workInProgress\"), \"\\u3002\\u7136\\u540E\\u8FDB\\u5165workLoop\\uFF08\\u5DE5\\u4F5C\\u5FAA\\u73AF\\uFF09\\u3002\\u9488\\u5BF9\\u6BCF\\u4E00\\u4E2AworkInProgress\\u5DE5\\u4F5C\\u5355\\u5143\\uFF0C\\u90FD\\u5BF9\\u5176\\u6267\\u884C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u3002\\u7C7B\\u4F3C\\u4E8E\\u4E0B\\u9762\\u8FD9\\u6BB5\\u4EE3\\u7801\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"root\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"createWorkInProgress\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5FAA\\u73AF\\u5DE5\\u4F5C\\u5FAA\\u73AF\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"while\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" unitOfWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" workInProgress\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"beginWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"&&\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYield\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"child\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"continue\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" completedWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" unitOfWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"do\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"completeWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \"\\n\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" returnFiber \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"return\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" siblingFiber \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"sibling\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"siblingFiber \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" siblingFiber\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"break\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n      completedWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" returnFiber\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      workInProgress \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" completedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"while\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"completedWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"p\", null, \"\\u5728\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u4E2D\\uFF0C\\u4F1A\\u6328\\u4E2A\\u5904\\u7406\\u6BCF\\u4E00\\u4E2Afiber\\u8282\\u70B9\\uFF0C\\u5BF9\\u6BCF\\u4E2Afiber\\u8282\\u70B9\\u90FD\\u4F1A\\u6267\\u884C\\u4E00\\u6B21\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\uFF0C\\u4F46\\u662F\\u5B83\\u4EEC\\u7684\\u6267\\u884C\\u65F6\\u673A\\u4E0D\\u540C\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u4F1A\\u4EE5\\u6DF1\\u5EA6\\u4F18\\u5148\\u7684\\u65B9\\u5F0F\\uFF0C\\u5F80\\u5B50\\u5B59\\u6811\\u4ECE\\u4E0A\\u5F80\\u4E0B\\u6267\\u884C\\u3002\\u800C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u662F\\u5728\\u6BCF\\u4E00\\u4E2A\\u8282\\u70B9\\u53CA\\u5176\\u5B50\\u5B59\\u90FD\\u6267\\u884C\\u5B8C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u540E\\uFF0C\\u5F80\\u7956\\u5148\\u6811\\u4ECE\\u4E0B\\u5F80\\u4E0A\\u6267\\u884C\\u3002\"), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u53E6\\u5916\\uFF0C\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u662F\\u53EF\\u4E2D\\u65AD\\u548C\\u6062\\u590D\\u7684\\uFF0C\\u5373\\u5982\\u679C\\u4E0A\\u9762\\u7684\", mdx(\"code\", {\n    parentName: \"em\",\n    \"className\": \"language-text\"\n  }, \"shouldYield()\"), \"\\u8FD4\\u56DEtrue\\uFF0C\\u90A3\\u4E48\", mdx(\"code\", {\n    parentName: \"em\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u5C31\\u9000\\u51FA\\u4E86\\u3002\\u7B49\\u5F85\\u4E0B\\u6B21\\u91CD\\u65B0\\u542F\\u52A8\\u6E32\\u67D3\\u6D41\\u7A0B\\uFF0C\\u7531\\u4E8E\\u8BB0\\u5F55\\u4E86workInProgress\\uFF0C\\u6240\\u4EE5\\u53EF\\u4EE5\\u6062\\u590D\\u3002React\\u4E2D\\u7684\\u5F02\\u6B65\\u53EF\\u4E2D\\u65AD\\u66F4\\u65B0\\u5C31\\u662F\\u4E2D\\u65AD\\u7684render\\u9636\\u6BB5\\u3002\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u7684\\u5177\\u4F53\\u8BBE\\u8BA1\\u601D\\u8DEF\\uFF0C\\u540E\\u7EED\\u4F1A\\u8865\\u5145\\u4E00\\u7BC7\\u6587\\u7AE0\\u5355\\u72EC\\u8BB2\\u89E3\\u3002\")), mdx(\"h4\", null, \"beginWork\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u662F\\u534F\\u8C03\\u5668\\u91CC\\u6700\\u91CD\\u8981\\u7684\\u4E00\\u4E2A\\u65B9\\u6CD5\\u3002\\u5B83\\u662F\\u4ECE\\u4E0A\\u5F80\\u4E0B\\u6267\\u884C\\u7684\\uFF0C\\u6211\\u4EEC\\u4ECE\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"FiberRoot\"), \"\\u5F00\\u59CB\\u53EA\\u6709\\u4E00\\u4E2A\\u65B0fiber\\u8282\\u70B9\\uFF0C\\u5373\\u7B2C\\u4E00\\u4E2AworkInProgress\\uFF0C\\u6267\\u884C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u7684\\u76EE\\u7684\\u662F\\u4E3A\\u4E86\\u6784\\u5EFA\\u5B8C\\u6574\\u7684workInProgress\\u6811\\u3002\\u53EF\\u4EE5\\u731C\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u7684\\u4E3B\\u8981\\u529F\\u80FD\\u5C31\\u662F\\u5BF9\\u6BD4\\u65B0\\u65E7fiber\\uFF0C\\u534F\\u8C03\\u51FA\\u65B0\\u7684children fiber\\u5E76\\u94FE\\u63A5\\u5230workInProgress\\u4E0A\\u3002\\u5177\\u4F53\\u6B65\\u9AA4\\u4E3A\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5224\\u65ADworkInProgress\\u662F\\u5426\\u53EF\\u4EE5\\u590D\\u7528\\u65E7\\u7684fiber\\uFF0C\\u53EF\\u4EE5\\u590D\\u7528\\uFF08props\\u548Ccontext\\u90FD\\u672A\\u53D8\\u5316\\uFF09\\uFF0C\\u5219\\u514B\\u9686children fiber\\u5E76\\u6302\\u5230workInProgress\\u6811\\u3002\\u8DF3\\u8FC72\\u30013\\u6B65\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5982\\u679C\\u4E0D\\u53EF\\u590D\\u7528\\uFF0C\\u5219\\u91CD\\u65B0\\u6267\\u884C\\u6E32\\u67D3\\u51FD\\u6570\\uFF08\\u7C7B\\u7EC4\\u4EF6\\u6216\\u51FD\\u6570\\u7EC4\\u4EF6\\uFF09\\u83B7\\u53D6newChildren\\u6216\\u4ECEprops.children\\u83B7\\u53D6\\uFF08Host\\u7EC4\\u4EF6\\uFF09\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u83B7\\u53D6\\u5230newChildren\\u540E\\uFF0C\\u548C\\u65E7\\u7684fiber\\u94FE\\u8868\\u8FDB\\u884C\\u534F\\u8C03\\u3002\\u534F\\u8C03\\u8FC7\\u7A0B\\u5C31\\u662Fdiff\\uFF0C\\u5E76\\u6807\\u8BB0\\u53D8\\u5316\\uFF08effectTag\\uFF0C\\u540E\\u7EED\\u6839\\u636E\\u8FD9\\u4E2A\\u5224\\u65AD\\u5982\\u4F55\\u53D8\\u66F4DOM\\uFF09\\u5230\\u65B0fiber\\u4E0A\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"beginWork\\u5B8C\\u6210\\uFF0C\\u8FD4\\u56DEchild\\u4F5C\\u4E3A\\u4E0B\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\\u3002\\u5982\\u679C\\u6CA1\\u6709child\\uFF0C\\u5219\\u8FDB\\u5165\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u3002\"))), mdx(\"h4\", null, \"completeWork\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u662F\\u5728\\u5F53\\u524DworkInProgress fiber\\u7684\\u5B50\\u5B59\\u5168\\u90E8\\u534F\\u8C03\\u7ED3\\u675F\\u540E\\u6267\\u884C\\u7684\\u3002\\u5B83\\u53EF\\u4EE5\\u6267\\u884C\\u4E00\\u4E9B\\u6536\\u5C3E\\u5DE5\\u4F5C\\u3002\\u4F8B\\u5982\\u5BF9\\u4E8E\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"HostComponent\"), \"\\uFF0C\\u5B83\\u6267\\u884C\\u4E86\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5982\\u679C\\u662Fupdate\\u65F6\\uFF08\\u5373\\u5B58\\u5728\\u65E7fiber-current\\uFF09\\uFF0C\\u5904\\u7406\\u53D8\\u5316\\u7684props\\uFF0C\\u5B58\\u50A8\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"workInProgress.updateQueue\"), \"\\uFF08\\u4F1A\\u5728commit\\u9636\\u6BB5\\u6E32\\u67D3\\u5230\\u9875\\u9762\\u4E0A\\uFF09\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5982\\u679C\\u662Fmount\\u65F6\\uFF0C\\u4E3A\\u5F53\\u524Dfiber\\u521B\\u5EFA\\u5BF9\\u5E94\\u7684DOM\\u8282\\u70B9\\u3002\\u5E76\\u5C06children\\u7684DOM\\u8282\\u70B9\\u63D2\\u5165\\u8FDB\\u6765\\u3002\"))), mdx(\"p\", null, \"\\u5176\\u4ED6\\u7C7B\\u578B\\u7684\\u7EC4\\u4EF6\\u5904\\u7406\\u7684\\u5DE5\\u4F5C\\u5E76\\u4E0D\\u76F8\\u540C\\u3002\\u5230\\u8FD9\\u91CC\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u5DE5\\u4F5C\\u5C31\\u7ED3\\u675F\\u4E86\\u3002\"), mdx(\"h4\", null, \"effectList\\u4E32\\u8054\"), mdx(\"p\", null, \"\\u4E4B\\u524D\\u6211\\u4EEC\\u63D0\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"beginWork\"), \"\\u91CC\\u4F1A\\u5728fiber\\u4E0A\\u6807\\u8BB0\\u53D8\\u5316\\uFF0C\\u5373effectTag\\u3002\\u540E\\u7EED\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"commit\"), \"\\u9636\\u6BB5\\u9700\\u8981\\u7528\\u4E8E\\u53D8\\u66F4DOM\\u3002\\u4E3A\\u4E86\\u65B9\\u4FBF\\u540E\\u7EED\\u8BE5\\u64CD\\u4F5C\\uFF0CReact\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u5B8C\\u6210\\u540E\\uFF0C\\u989D\\u5916\\u6267\\u884C\\u4E86\\u4E00\\u4E2A\\u4E32\\u8054effectList\\u7684\\u5DE5\\u4F5C\\u3002\"), mdx(\"p\", null, \"effectList\\u6302\\u8F7D\\u5728fiber\\u4E0A\\uFF0C\\u5176\\u5B9E\\u5C31\\u662F\\u4E00\\u4E2A\\u5355\\u5411\\u94FE\\u8868\\uFF0C\\u4EE5\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"fiber.firstEffect\"), \"\\u4E3A\\u7B2C\\u4E00\\u4E2A\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"fiber.lastEffect\"), \"\\u4E3A\\u6700\\u540E\\u4E00\\u4E2A\\uFF0C\\u524D\\u4E00\\u4E2A\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"nextEffect\"), \"\\u6307\\u5411\\u540E\\u4E00\\u4E2A\\u3002\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u6BCF\\u4E2Afiber\\u5224\\u65AD\\u81EA\\u5DF1\\u662F\\u5426\\u6709effectTag\\uFF0C\\u5982\\u679C\\u6709\\uFF0C\\u628A\\u81EA\\u5DF1\\u4E32\\u5230\\u7236fiber\\u7684effectList\\u6700\\u540E\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u4E00\\u6837\\uFF0C\\u5F80\\u7956\\u5148\\u7EA7\\u4ECE\\u4E0B\\u5F80\\u4E0A\\u6267\\u884C\\uFF0C\\u6240\\u4EE5\\u6700\\u7EC8\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"rootFiber\"), \"\\u4E0A\\u7684effectList\\u5C31\\u662F\\u6574\\u68F5\\u6811\\u5168\\u90E8\\u7684effect\\u4E86\\u3002\"))), mdx(\"h3\", null, \"commit\\u9636\\u6BB5\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u7ED3\\u675F\\u540E\\uFF0C\\u76F4\\u63A5\\u8FDB\\u5165\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"commit\\u9636\\u6BB5\"), \"\\u3002\\u987E\\u540D\\u601D\\u4E49\\uFF0C\\u5C31\\u662F\\u5C06\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u53D1\\u751F\\u7684effect\\uFF0C\\u5728\\u8BE5\\u9636\\u6BB5\\u63D0\\u4EA4\\u5230\\u9875\\u9762\\u4E0A\\u3002\\u6CE8\\u610F\\uFF0C\\u4E0D\\u540C\\u4E8E\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u53EF\\u4EE5\\u4E2D\\u65AD\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"commit\\u9636\\u6BB5\"), \"\\u662F\\u540C\\u6B65\\u6267\\u884C\\u7684\\uFF0C\\u4E0D\\u53EF\\u4E2D\\u65AD\\u3002\"), mdx(\"p\", null, \"React\\u5C06\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"commit\\u9636\\u6BB5\"), \"\\u53C8\\u5206\\u4E3A\\u4E09\\u4E2A\\u5C0F\\u9636\\u6BB5\\u3002\"), mdx(\"h4\", null, \"before mutation\\u9636\\u6BB5\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"before mutation\"), \"\\u662F\\u5728\\u6267\\u884C\\u5177\\u4F53\\u7684DOM\\u64CD\\u4F5C\\u4E4B\\u524D\\u3002\\u5728\\u8FD9\\u4E2A\\u9636\\u6BB5\\u53EF\\u4EE5\\u505A\\u4E00\\u4E9B\\u51C6\\u5907\\u5DE5\\u4F5C\\u3002\\u5305\\u62EC\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5904\\u7406\\u6E32\\u67D3/\\u5220\\u9664\\u8282\\u70B9\\u7684focus/blur\\u72B6\\u6001\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"getSnapshotBeforeUpdate\"), \"\\u3002\\uFF08commit\\u9636\\u6BB5\\u662F\\u540C\\u6B65\\u7684\\u6240\\u4EE5\\u8BE5\\u65B9\\u6CD5\\u4E0D\\u4F1A\\u591A\\u6B21\\u8C03\\u7528\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"UNSAFE_componentWillReceiveProps\"), \"\\u5728render\\u9636\\u6BB5\\u88AB\\u8C03\\u7528\\u6240\\u4EE5\\u4E0D\\u5B89\\u5168\\uFF09\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5F02\\u6B65\\u8C03\\u5EA6\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"useEffect\"), \"\\u56DE\\u8C03\\u51FD\\u6570\\u3002\"))), mdx(\"p\", null, \"\\u5B83\\u4E3B\\u8981\\u901A\\u8FC7\\u904D\\u5386effectList\\u94FE\\u8868\\uFF0C\\u6765\\u5BF9\\u6709effect\\u7684\\u8282\\u70B9\\u8FDB\\u884C\\u8FD9\\u4E9B\\u5904\\u7406\\u3002\"), mdx(\"h4\", null, \"mutation\\u9636\\u6BB5\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"mutation\"), \"\\u662F\\u5B9E\\u5B9E\\u5728\\u5728\\u7684\\u6267\\u884CDOM\\u64CD\\u4F5C\\u7684\\u9636\\u6BB5\\u3002\"), mdx(\"p\", null, \"\\u5B83\\u4E5F\\u662F\\u904D\\u5386effectList\\u94FE\\u8868\\uFF0C\\u7136\\u540E\\u5BF9\\u4E0D\\u540C\\u7684effect\\u8FDB\\u884C\\u5904\\u7406\\uFF0C\\u4E3B\\u8981\\u5305\\u542B3\\u79CDeffect\\uFF1A\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Placement\")), mdx(\"p\", null, \"\\u4EE3\\u8868\\u8BE5fiber\\u6240\\u590D\\u7528\\u7684DOM\\u8282\\u70B9\\u9700\\u8981\\u66F4\\u6362\\u4F4D\\u7F6E\\u3002\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5982\\u679C\\u6709\\u4E0B\\u4E00\\u4E2A\\u7A33\\u5B9A\\u7684\\u5144\\u5F1FDOM\\uFF0C\\u5219\\u63D2\\u5165\\u5230\\u5144\\u5F1FDOM\\u4E4B\\u524D\\u3002\\u8FD9\\u91CC\\u6709\\u4E09\\u4E2A\\u7406\\u89E3\\u96BE\\u70B9\\uFF1A\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4E00\\u662F\\u4E3A\\u4EC0\\u4E48\\u8981\\u63D2\\u5165\\u5230\\u4E0B\\u4E00\\u4E2A\\u5144\\u5F1FDOM\\u4E4B\\u524D\\uFF1F\\u56E0\\u4E3A\\u5728\\u4E4B\\u524D\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u7684diff\\u7B97\\u6CD5\\u539F\\u7406\\u662F\\u904D\\u5386newChildren\\u65F6\\uFF0C\\u603B\\u662F\\u6807\\u8BB0\\u9700\\u8981\\u53F3\\u79FB\\u7684fiber\\u3002\\u8FD9\\u4E2Afiber\\u7684\\u4E0B\\u4E00\\u4E2A\\u5144\\u5F1F\\u4E00\\u5B9A\\u5728\\u5B83\\u53F3\\u8FB9\\uFF0C\\u6240\\u4EE5fiber\\u5BF9\\u5E94\\u7684dom\\u4E00\\u5B9A\\u5728\\u4E0B\\u4E00\\u4E2A\\u5144\\u5F1Fdom\\u7684\\u5DE6\\u8FB9\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4E8C\\u662F\\u67E5\\u627E\\u5144\\u5F1FDOM\\u9700\\u8981\\u8DE8\\u5C42\\u7EA7\\u641C\\u7D22\\uFF0C\\u56E0\\u4E3A\\u5144\\u5F1Ffiber\\u4E0D\\u4E00\\u5B9A\\u6709\\u5144\\u5F1FDOM\\u3002\\u5144\\u5F1Fdom\\u53EF\\u80FD\\u5C31\\u662F\\u5B83\\u7684sibling\\uFF0C\\u4F46\\u4E5F\\u6709\\u53EF\\u80FD\\u5728\\u5B83\\u7684\\u7236fiber\\u7684sibling\\u6811\\u4E0B\\uFF0C\\u4E5F\\u6709\\u53EF\\u80FD\\u5728\\u5B83\\u7684sibling\\u6811\\u4E0B\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4E09\\u662F\\u4E3A\\u4EC0\\u4E48\\u8981\\u627E\\u7A33\\u5B9A\\u7684\\u5144\\u5F1F\\uFF1F\\u7A33\\u5B9A\\u662F\\u6307\\u6CA1\\u6709\\u88ABPlacement\\u6807\\u8BB0\\u7684\\u3002\\u56E0\\u4E3A\\u5982\\u679C\\u5144\\u5F1F\\u88ABPlacement\\u6807\\u8BB0\\u4E86\\uFF0C\\u90A3\\u5B83\\u5BF9\\u5E94\\u7684dom\\u4E00\\u5B9A\\u4E5F\\u4F1A\\u88AB\\u79FB\\u52A8\\uFF0C\\u6240\\u4EE5\\u4E0D\\u80FD\\u76F4\\u63A5\\u63D2\\u5165\\u5B83\\u524D\\u9762\\u3002\"))), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\uFF08\\u8FD9\\u91CC\\u7684\\u903B\\u8F91\\u6BD4\\u8F83\\u590D\\u6742\\uFF0C\\u540E\\u7EED\\u4F1A\\u8865\\u5145\\u4E00\\u7BC7\\u6587\\u7AE0\\uFF0C\\u4E13\\u95E8\\u8BB2\\u89E3\\u4E00\\u4E0B\\u6574\\u4E2ADiff\\u7B97\\u6CD5\\u548Cmutation\\u903B\\u8F91\\uFF09\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5982\\u679C\\u6CA1\\u6709\\u7A33\\u5B9A\\u7684\\u5144\\u5F1FDOM\\uFF0C\\u5219\\u63D2\\u5165\\u5230\\u961F\\u5C3E\\u3002\\u8FD9\\u4E2A\\u597D\\u7406\\u89E3\\u3002\"))), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Update\")), mdx(\"p\", null, \"\\u4EE3\\u8868\\u8BE5fiber\\u9700\\u8981\\u66F4\\u65B0\\u3002\\u5BF9\\u4E8E\\u4E0D\\u540C\\u7684fiber\\uFF0C\\u9700\\u8981\\u4E0D\\u540C\\u7684\\u5904\\u7406\\u3002\"), mdx(\"p\", null, \"\\u5BF9\\u4E8E\\u51FD\\u6570\\u7EC4\\u4EF6\\uFF0C\\u6267\\u884C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"useLayoutEffect\"), \"\\u7684\\u9500\\u6BC1\\u51FD\\u6570\\u3002\"), mdx(\"p\", null, \"\\u5BF9\\u4E8EHost\\u7EC4\\u4EF6\\uFF0C\\u4F1A\\u5C06\\u4E4B\\u524D\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"-\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"completeWork\"), \"\\u4E2D\\u8D4B\\u503C\\u7684\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"updateQueue\"), \"\\u66F4\\u65B0\\u5230dom\\u4E0A\\uFF0C\\u5176\\u5B9E\\u5C31\\u662F\\u66F4\\u65B0dom\\u5C5E\\u6027\\u3002\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Deletion\")), mdx(\"p\", null, \"\\u4EE3\\u8868\\u8BE5fiber\\u5BF9\\u5E94\\u7684dom\\u9700\\u8981\\u88AB\\u79FB\\u9664\\u3002\\u5F53\\u7136\\u5305\\u62EC\\u5B83\\u7684\\u5B50\\u5B59fiber\\u8282\\u70B9\\u3002\"), mdx(\"p\", null, \"\\u8BE5\\u65B9\\u6CD5\\u4E3B\\u8981\\u5904\\u7406\\u51E0\\u4E2A\\u64CD\\u4F5C\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u9012\\u5F52\\u5904\\u7406fiber\\u548C\\u5B83\\u7684\\u5B50\\u5B59fiber\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u79FB\\u9664\\u5BF9\\u5E94\\u7684DOM\\u8282\\u70B9\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u89E3\\u7ED1ref\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5982\\u679C\\u662F\\u7C7B\\u7EC4\\u4EF6\\uFF0C\\u8C03\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"componentWillUnmount\"), \"\\u751F\\u547D\\u5468\\u671F\\u3002\"))), mdx(\"h4\", null, \"layout\\u9636\\u6BB5\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"layout\"), \"\\u9636\\u6BB5\\uFF0C\\u662F\\u6240\\u6709DOM\\u4FEE\\u6539\\u5B8C\\u6210\\u540E\\u624D\\u6267\\u884C\\u7684\\uFF0C\\u8FD9\\u65F6\\u5019js\\u4EE3\\u7801\\u6216\\u8005\\u5728\\u8FD9\\u4E2A\\u9636\\u6BB5\\u89E6\\u53D1\\u7684\\u751F\\u547D\\u5468\\u671F\\uFF0C\\u90FD\\u5DF2\\u7ECF\\u53EF\\u4EE5\\u8BBF\\u95EE\\u5230\\u4FEE\\u6539\\u540E\\u7684DOM\\u4E86\\u3002\"), mdx(\"p\", null, \"\\u5728\\u8FD9\\u4E2A\\u9636\\u6BB5\\uFF0C\\u4E5F\\u662F\\u904D\\u5386effectList\\u5217\\u8868\\u3002\\u4E3B\\u8981\\u505A\\u4E86\\u4E09\\u4EF6\\u4E8B\\uFF1A\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5BF9\\u4E8E\\u6709\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Update\"), \"\\u7684fiber\\uFF0C\\u5982\\u679C\\u662F\\u7C7B\\u7EC4\\u4EF6\\uFF0C\\u5219\\u89E6\\u53D1\\u751F\\u547D\\u5468\\u671FcomponentDidMount\\u6216componentDidUpdate\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5BF9\\u4E8E\\u6709\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Update\"), \"\\u7684fiber\\uFF0C\\u5982\\u679C\\u662F\\u51FD\\u6570\\u7EC4\\u4EF6\\uFF0C\\u5219\\u540C\\u6B65\\u6267\\u884CuseLayoutEffect\\u7684\\u56DE\\u8C03\\u51FD\\u6570\\u3001\\u5F02\\u6B65\\u8C03\\u5EA6useEffect\\u7684\\u9500\\u6BC1\\u51FD\\u6570\\u4E0E\\u56DE\\u8C03\\u51FD\\u6570\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u7ED1\\u5B9Aref\\u3002\"))), mdx(\"p\", null, \"\\u81F3\\u6B64\\uFF0Clayout\\u9636\\u6BB5\\u4E5F\\u5B8C\\u6210\\u4E86\\u3002\\u66FF\\u6362\\u4E00\\u4E0BworkInProgress\\u6811\\uFF0C\\u90A3\\u4E48\\u6574\\u4E2A\\u6E32\\u67D3\\u66F4\\u65B0\\u6D41\\u7A0B\\u5C31\\u7ED3\\u675F\\u5566\\uFF01\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"current \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" finishedWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))), mdx(\"h3\", null, \"Scheduler\\u8C03\\u5EA6\\u5668\"), mdx(\"p\", null, \"\\u63A5\\u7740\\u8BB2\\u4E00\\u4E0B\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\uFF0C\\u5B83\\u5728React\\u4E2D\\u662F\\u4E00\\u4E2A\\u72EC\\u7ACB\\u7684\\u5305\\u3002\\u5B83\\u7684\\u529F\\u80FD\\u662F\\u4F5C\\u4E3A\\u4EFB\\u52A1\\u8C03\\u5EA6\\u5668\\uFF0C\\u7528\\u4E8E\\u6839\\u636E\\u4F18\\u5148\\u7EA7\\u548C\\u65F6\\u95F4\\u5207\\u7247\\u6765\\u63A7\\u5236\\u4EFB\\u52A1\\u6267\\u884C\\u65F6\\u673A\\u3002\\u5B83\\u4E3B\\u8981\\u5305\\u542B\\u4E24\\u90E8\\u5206\\u529F\\u80FD\\uFF1A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u65F6\\u95F4\\u5207\\u7247\"), \"\\u548C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4F18\\u5148\\u7EA7\\u8C03\\u5EA6\"), \"\\u3002\"), mdx(\"h4\", null, \"\\u65F6\\u95F4\\u5207\\u7247\"), mdx(\"p\", null, \"\\u65F6\\u95F4\\u5207\\u7247\\uFF0C\\u5373\\u5728\\u6D4F\\u89C8\\u5668\\u6BCF\\u4E00\\u5E27\\u4E2D\\u7ED9\\u4E88\\u4E00\\u5B9A\\u7684\\u65F6\\u95F4\\u53BB\\u6267\\u884C\\u4EFB\\u52A1\\uFF0C\\u5982\\u679C\\u65F6\\u95F4\\u8D85\\u51FA\\u4E86\\uFF0C\\u5219\\u4E2D\\u65AD\\u4EFB\\u52A1\\u6267\\u884C\\uFF0C\\u63A7\\u5236\\u6743\\u4EA4\\u8FD8\\u7ED9\\u6D4F\\u89C8\\u5668\\uFF0C\\u7B49\\u5230\\u4E0B\\u4E00\\u5E27\\u518D\\u7EE7\\u7EED\\u6267\\u884C\\u3002\\u4ECE\\u800C\\u4FDD\\u8BC1\\u5373\\u4F7F\\u6267\\u884C\\u957F\\u4EFB\\u52A1\\uFF0C\\u4E5F\\u4E0D\\u4F1A\\u957F\\u65F6\\u95F4\\u5360\\u7528\\u4E3B\\u7EBF\\u7A0B\\uFF0C\\u4ECD\\u7136\\u80FD\\u7ED9\\u4E88\\u6D4F\\u89C8\\u5668\\u8DB3\\u591F\\u65F6\\u95F4\\uFF0C\\u4ECE\\u800C\\u4FDD\\u8BC1\\u6574\\u4E2A\\u754C\\u9762\\u548C\\u4EA4\\u4E92\\u7684\\u6D41\\u7545\\u3002\"), mdx(\"p\", null, \"\\u5B83\\u7684\\u529F\\u80FD\\u5F88\\u50CF\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"requestIdleCallback\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requestAnimationFrame\"), \"\\u3002\\u90A3\\u4E3A\\u4EC0\\u4E48\\u4E0D\\u76F4\\u63A5\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requestIdleCallback\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requestAnimationFrame\"), \"\\u5462\\uFF1F\"), mdx(\"p\", null, \"\\u4E00\\u662F\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requestIdleCallback\"), \"\\u8C03\\u7528\\u65F6\\u673A\\u4E0D\\u786E\\u5B9A\\uFF1B\"), mdx(\"p\", null, \"\\u4E8C\\u662F\\u5404\\u4E2A\\u6D4F\\u89C8\\u5668\\u5BF9\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requestIdleCallback\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"requestAnimationFrame\"), \"\\u7684\\u5B9E\\u73B0\\u4E0D\\u4E00\\u6837\\uFF0C\\u6709\\u517C\\u5BB9\\u6027\\u95EE\\u9898\\uFF1B\"), mdx(\"p\", null, \"\\u4E09\\u662FReact\\u5E0C\\u671B\\u80FD\\u5B9E\\u73B0\\u66F4\\u7CBE\\u7EC6\\u7684\\u4F18\\u5148\\u7EA7\\u548C\\u6267\\u884C\\u65F6\\u95F4\\u63A7\\u5236\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"React\\u7684Scheduler\\u57FA\\u4E8E\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/scheduler/src/forks/SchedulerHostConfig.default.js#L228-L234\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"MessageChannel\"), \"\\uFF0C\\u5982\\u679C\\u6D4F\\u89C8\\u5668\\u4E0D\\u652F\\u6301\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"MessageChannel\"), \"\\uFF0C\\u5219fallback\\u4E3A\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/scheduler/src/forks/SchedulerHostConfig.default.js#L47-L55\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"setTimeout\"), \"\\u3002\\u90FD\\u662F\\u4F5C\\u4E3A\\u5B8F\\u4EFB\\u52A1\\u5B9E\\u73B0\\u7684\\uFF0C\\u5728\\u6D4F\\u89C8\\u5668\\u5904\\u7406\\u5B8C\\u4E00\\u5E27\\u540E\\u5F00\\u59CB\\u5904\\u7406\\u5B8F\\u4EFB\\u52A1\\uFF0C\\u4ECE\\u800C\\u8FD0\\u884C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u7684\\u4EE3\\u7801\\uFF0C\\u6B64\\u65F6\\u63A7\\u5236\\u6743\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u624B\\u4E0A\\u4E86\\uFF0C\\u5B83\\u53C8\\u53EF\\u4EE5\\u7EE7\\u7EED\\u8C03\\u5EA6\\u4EFB\\u52A1\\u4E86\\u3002\")), mdx(\"p\", null, \"\\u8054\\u60F3\\u5230\\u4E4B\\u524Drender\\u9636\\u6BB5\\uFF0C\\u5728\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u4E2D\\uFF0C\\u6709\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"shouldYield()\"), \"\\u65B9\\u6CD5\\u3002\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u5C31\\u662FScheduler\\u63D0\\u4F9B\\u7684\\uFF0C\\u7528\\u4E8E\\u5224\\u65AD\\u4E0B\\u4E00\\u4E2A\\u5DE5\\u4F5C\\u5355\\u5143\\u662F\\u5426\\u9700\\u8981\\u4E2D\\u65AD\\u6267\\u884C\\u3002\"), mdx(\"p\", null, \"\\u5B83\\u7684\\u539F\\u7406\\u6982\\u62EC\\u8D77\\u6765\\u5C31\\u662F\\uFF1A\\u5728Scheduler\\u4E2D\\uFF0C\\u4F1A\\u4E3A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u88AB\\u8C03\\u5EA6\\u7684\\u4EFB\\u52A1\\u6267\\u884C\"), \"\\u5206\\u914D\\u4E00\\u4E2A\\u53EF\\u6267\\u884C\\u65F6\\u95F4\\u3002\\u5F00\\u59CB\\u6267\\u884C\\u65F6\\u8BB0\\u5F55\\u5F53\\u524D\\u65F6\\u95F4\\u3002\\u5982\\u679C\\u6267\\u884C\\u4EFB\\u52A1\\u7684\\u8017\\u65F6\\u8D85\\u8FC7\\u4E86\\u5206\\u914D\\u7684\\u65F6\\u95F4\\uFF0C\\u5219\\u6267\\u884C\\u4EFB\\u52A1\\u4E2D\\u6B62\\uFF0C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"shouldYield()\"), \"\\u4E5F\\u4F1A\\u8FD4\\u56DEtrue\\u3002\\u7B49\\u5F85\\u5230\\u4E0B\\u4E00\\u4E2A\\u65F6\\u95F4\\u5207\\u7247\\uFF08\\u5373\\u6D4F\\u89C8\\u5668\\u5904\\u7406\\u5B8C\\u540E\\u4EA4\\u8FD8\\u7ED9\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\uFF09\\u5230\\u6765\\uFF0C\\u91CD\\u65B0\\u8BB0\\u5F55\\u6267\\u884C\\u65F6\\u95F4\\u3002\\u8FD9\\u90E8\\u5206\\u4EE3\\u7801\\u7B80\\u5316\\u5982\\u4E0B\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ****** SchedulerHostConfig.default.js ******\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" yieldInterval \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"5\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u65F6\\u95F4\\u5207\\u7247\\u957F\\u5EA65ms\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" deadline \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"0\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6267\\u884C\\u622A\\u6B62\\u65F6\\u95F4\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" scheduledHostCallback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6267\\u884C\\u4EFB\\u52A1\\u7684\\u56DE\\u8C03\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" isMessageLoopRunning \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u662F\\u5426\\u6B63\\u5728\\u6267\\u884C\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5224\\u65AD\\u662F\\u5426\\u5E94\\u8BE5\\u8BA9\\u51FA\\u4E3B\\u7EBF\\u7A0B\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYieldToHost\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"getCurrentTime\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \">=\"), \" deadline\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6267\\u884C\\u4EFB\\u52A1\\uFF08\\u6D4F\\u89C8\\u5668\\u4EA4\\u8FD8\\u63A7\\u5236\\u6743\\u7684\\u5165\\u53E3\\u51FD\\u6570\\uFF09\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performWorkUntilDeadline\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"scheduledHostCallback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" currentTime \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"getCurrentTime\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8BA1\\u7B97\\u51FA\\u622A\\u6B62\\u65F6\\u95F4\"), \"\\n    deadline \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" currentTime \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"+\"), \" yieldInterval\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6267\\u884C\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" hasMoreWork \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"scheduledHostCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"currentTime\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!\"), \"hasMoreWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6267\\u884C\\u7ED3\\u675F\"), \"\\n      isMessageLoopRunning \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      scheduledHostCallback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u672A\\u7ED3\\u675F\\uFF0C\\u91CD\\u65B0\\u53D1\\u6D88\\u606F\\uFF0C\\u7B49\\u4E0B\\u4E00\\u4E2A\\u65F6\\u95F4\\u5207\\u7247\"), \"\\n      port\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"postMessage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    isMessageLoopRunning \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u901A\\u8FC7MessageChannel\\u5B9E\\u73B0\\u65F6\\u95F4\\u5207\\u7247\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" channel \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"new\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token class-name\"\n  }, \"MessageChannel\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" port \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" channel\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"port2\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\nchannel\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"port1\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"onmessage \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" performWorkUntilDeadline\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8FD9\\u4E2A\\u56DE\\u8C03\\u4F1A\\u5728\\u5165\\u53E3\\u51FD\\u6570\\u8C03\\u7528\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"requestHostCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"callback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  scheduledHostCallback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" callback\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!\"), \"isMessageLoopRunning\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    isMessageLoopRunning \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u53D1\\u6D88\\u606F\\uFF0C\\u7B49\\u4E0B\\u4E00\\u4E2A\\u65F6\\u95F4\\u5207\\u7247\"), \"\\n    port\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"postMessage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"h4\", null, \"\\u4F18\\u5148\\u7EA7\\u8C03\\u5EA6\"), mdx(\"p\", null, \"Scheduler\\u63D0\\u4F9B\\u4E86\\u4E00\\u4E2A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"scheduleCallback\"), \"\\u65B9\\u6CD5\\uFF0C\\u5F53\\u9700\\u8981\\u4F18\\u5148\\u7EA7\\u5F02\\u6B65\\u8C03\\u5EA6\\u67D0\\u4E2A\\u56DE\\u8C03\\u51FD\\u6570\\u65F6\\uFF0C\\u5C31\\u8C03\\u7528\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u3002\\u5728\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"commit\\u9636\\u6BB5\"), \"\\uFF0C\\u5F88\\u591A\\u5730\\u65B9\\u4F7F\\u7528\\u4E86\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u6765\\u8C03\\u5EA6\\uFF0C\\u6BD4\\u5982\\u6E32\\u67D3\\u5165\\u53E3\\u51FD\\u6570\\u7684\\u5F02\\u6B65\\u8C03\\u5EA6\\u3001useEffect\\u56DE\\u8C03\\u7684\\u5F02\\u6B65\\u8C03\\u5EA6\\u7B49\\u3002\"), mdx(\"p\", null, \"Scheduler\\u8BBE\\u7F6E\\u4E865\\u79CD\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4F18\\u5148\\u7EA7\"), \"\\uFF0C\\u6765\\u63A7\\u5236\\u4EFB\\u52A1\\u7684\\u6267\\u884C\\u65F6\\u673A\\u3002\\u4E0D\\u540C\\u7684\\u4F18\\u5148\\u7EA7\\u6709\\u4E0D\\u540C\\u7684timeout\\uFF08\\u8D85\\u65F6\\u65F6\\u95F4\\uFF09\\uFF0C\\u6BCF\\u4E2A\\u6DFB\\u52A0\\u5230Scheduler\\u7684\\u4EFB\\u52A1\\u6839\\u636EcurrentTime\\uFF08\\u5F53\\u524D\\u65F6\\u95F4\\uFF09\\u8BA1\\u7B97\\u51FA\\u8FC7\\u671F\\u65F6\\u95F4\\uFF08expirationTime\\uFF09\\u3002\\u6309\\u4F18\\u5148\\u7EA7\\u6267\\u884C\\u4EFB\\u52A1\\u7684\\u539F\\u7406\\u5C31\\u662F\\uFF0CScheduler\\u4F1A\\u5C06\\u4EFB\\u52A1\\u653E\\u5728\\u4F18\\u5148\\u7EA7\\u961F\\u5217\\u4E2D\\uFF0C\\u961F\\u5217\\u4E2D\\u662F\\u6309\\u7167\\u8FC7\\u671F\\u65F6\\u95F4\\u6392\\u5E8F\\u7684\\uFF0C\\u6700\\u8FD1\\u8FC7\\u671F\\u7684\\u5728\\u961F\\u5217\\u6700\\u524D\\u9762\\u3002\\u6BCF\\u6765\\u4E00\\u4E2A\\u65B0\\u4EFB\\u52A1\\uFF0C\\u5C31\\u8BA1\\u7B97\\u5B83\\u7684\\u8FC7\\u671F\\u65F6\\u95F4\\uFF0C\\u7136\\u540E\\u653E\\u5165\\u961F\\u5217\\u4E2D\\u91CD\\u65B0\\u6392\\u5E8F\\u3002\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Scheduler\\u7684\\u4F18\\u5148\\u7EA7\\u961F\\u5217\\u5B9E\\u73B0\\uFF0C\\u4F7F\\u7528\\u7684\\u662F\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.cnblogs.com/lanhaicode/p/10546257.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"\\u5C0F\\u9876\\u5806\"), \"\\u3002\")), mdx(\"p\", null, \"Scheduler\\u5728\\u6536\\u5230\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"scheduleCallback\"), \"\\u6CE8\\u518C\\u7684\\u56DE\\u8C03\\u540E\\uFF0C\\u5BF9\\u5176\\u8FDB\\u884C\\u8C03\\u5EA6\\u3002\\u7B49\\u5230\\u65F6\\u95F4\\u5207\\u7247\\u5F00\\u59CB\\u6267\\u884C\\u65F6\\uFF0C\\u5728workLoop\\uFF08\\u6CE8\\u610F\\uFF0C\\u4E0D\\u8981\\u548CReact\\u6E32\\u67D3\\u6D41\\u7A0B\\u7684\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u5F04\\u6DF7\\u4E86\\uFF09\\u65B9\\u6CD5\\u4E2D\\u901A\\u8FC7while\\u5FAA\\u73AF\\u4ECE\\u4EFB\\u52A1\\u961F\\u5217\\u4E2D\\u4E0D\\u65AD\\u53D6\\u51FA\\u4EFB\\u52A1\\u5E76\\u6267\\u884C\\u3002while\\u5FAA\\u73AF\\u65F6\\u5224\\u65AD\\u5F53\\u524D\\u5DF2\\u5230\\u8FBE\\u622A\\u6B62\\u65F6\\u95F4\\uFF0C\\u5219\\u9000\\u51FA\\u5FAA\\u73AF\\u3002\\u7B80\\u5316\\u7684\\u4EE3\\u7801\\u5982\\u4E0B\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ***** Scheduler.js *****\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" taskQueue \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u4F18\\u5148\\u7EA7\\u4EFB\\u52A1\\u961F\\u5217\\uFF08React\\u7528\\u5C0F\\u9876\\u5806\\uFF0C\\u6211\\u4EEC\\u4E3A\\u4E86\\u6A21\\u62DF\\u7528\\u6570\\u7EC4\\uFF09\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" currentTask \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5F53\\u524D\\u6267\\u884C\\u7684\\u4EFB\\u52A1\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"let\"), \" isHostCallbackScheduled \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u662F\\u5426\\u5DF2\\u7ECF\\u53D1\\u9001\\u5230host\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6309\\u4F18\\u5148\\u7EA7\\u6CE8\\u518C\\u4EFB\\u52A1\\u7684\\u8C03\\u5EA6\\u5668\\u5165\\u53E3\\uFF08\\u7ED9React\\u7528\\u7684\\uFF09\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"scheduleCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token parameter\"\n  }, \"priorityLevel\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" callback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u521B\\u5EFA\\u65B0\\u4EFB\\u52A1\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" currentTime \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"getCurrentTime\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u4F18\\u5148\\u7EA7\\u8D8A\\u9AD8\\uFF0Ctimeout\\u8D8A\\u5C0F\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" timeout \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"timeoutForPriorityLevel\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"priorityLevel\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" expirationTime \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" currentTime \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"+\"), \" timeout\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" newTask \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    callback\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n    priorityLevel\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token literal-property property\"\n  }, \"startTime\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" currentTime\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n    expirationTime\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u52A0\\u5165\\u4EFB\\u52A1\\u961F\\u5217\\uFF08\\u5E76\\u6309\\u7167\\u5230\\u671F\\u65F6\\u95F4\\u6392\\u5E8F\\uFF09\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"push\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"taskQueue\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" newTask\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!\"), \"isHostCallbackScheduled\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6CA1\\u6709\\u6CE8\\u518C\\u56DE\\u8C03\\uFF0C\\u6CE8\\u518C\\u56DE\\u8C03\"), \"\\n    isHostCallbackScheduled \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"requestHostCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"flushWork\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" newTask\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6700\\u7EC8\\u6BCF\\u4E2A\\u5207\\u7247\\u4F1A\\u4ECE\\u8FD9\\u91CC\\u5F00\\u59CB\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"flushWork\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  console\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"log\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"\\u5207\\u7247\\u5185\\uFF0C\\u5F00\\u59CB\\u6267\\u884C\\u4EFB\\u52A1\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  isHostCallbackScheduled \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoop\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5FAA\\u73AF\\u53D6\\u4EFB\\u52A1\\u6267\\u884C\\uFF0C\\u76F4\\u5230\\u65F6\\u95F4\\u5207\\u7247\\u5230\\u8FBE\\u622A\\u6B62\\u65F6\\u95F4\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoop\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  currentTask \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"peek\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"taskQueue\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"while\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"currentTask \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"shouldYieldToHost\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"break\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" callback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" currentTask\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"callback\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"callback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      currentTask\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"callback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" continuationCallback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"callback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"typeof\"), \" continuationCallback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"===\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"function\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        currentTask\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"callback \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" continuationCallback\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"pop\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"taskQueue\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"pop\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"taskQueue\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n    currentTask \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"peek\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"taskQueue\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"currentTask \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"!==\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"true\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"else\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token boolean\"\n  }, \"false\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"h4\", null, \"React\\u4E2D\\u4F7F\\u7528Scheduler\"), mdx(\"p\", null, \"\\u65F6\\u95F4\\u5207\\u7247\\u548C\\u4F18\\u5148\\u7EA7\\u8C03\\u5EA6\\u90FD\\u5DF2\\u7ECF\\u4E32\\u8D77\\u6765\\u4E86\\uFF0C\\u73B0\\u5728\\u4EE5React\\u4E2D\\u7684\\u4F7F\\u7528\\uFF0C\\u4E3E\\u4F8B\\u8BF4\\u6E05\\u695A\\uFF1AReact\\u5C06\\u67D0\\u4E2A\\u66F4\\u65B0\\u89E6\\u53D1\\u7684\\u6E32\\u67D3\\u3001\\u548C\\u4E00\\u7EC4useEffect\\u56DE\\u8C03\\u90FD\\u4F5C\\u4E3A\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4EFB\\u52A1\"), \"\\u4E22\\u7ED9\\u4E86\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u6765\\u5F02\\u6B65\\u8C03\\u5EA6\\uFF0C\\u5B83\\u4EEC\\u90FD\\u5E26\\u7740\\u4F18\\u5148\\u7EA7\\u8FC7\\u53BB\\u3002Scheduler\\u4ECE\\u4EFB\\u52A1\\u961F\\u5217\\u4E2D\\u53D6\\u4EFB\\u52A1\\u6267\\u884C\\u3002\\u5176\\u4E2DReact\\u7684\\u66F4\\u65B0\\u6E32\\u67D3\\u6267\\u884C\\u65F6\\u4E5F\\u662F\\u53EF\\u4EE5\\u4E2D\\u65AD\\u7684\\uFF0C\\u524D\\u9762\\u6211\\u4EEC\\u5DF2\\u7ECF\\u8BB2\\u8FC7\\uFF0C\\u662FworkLoop\\u6267\\u884C\\u65F6\\u901A\\u8FC7\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"shouldYield()\"), \"\\u65B9\\u6CD5\\u5224\\u65AD\\u7684\\u3002\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"useEffect\"), \"\\u7684\\u4EFB\\u52A1\\u6267\\u884C\\u65F6\\u662F\\u6CA1\\u6CD5\\u4E2D\\u65AD\\u7684\\uFF0C\\u6240\\u4EE5useEffect\\u4E2D\\u4ECD\\u7136\\u4E0D\\u80FD\\u5904\\u7406\\u8017\\u65F6\\u64CD\\u4F5C\\u3002\"), mdx(\"p\", null, \"\\u601D\\u8003\\u4E00\\u4E0B\\uFF0CReact\\u7684\\u6E32\\u67D3\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u7531\\u4E8E\\u65F6\\u95F4\\u5207\\u7247\\u673A\\u5236\\u53EF\\u80FD\\u4F1A\\u4E2D\\u65AD\\uFF0C\\u90A3\\u5B83\\u662F\\u5982\\u4F55\\u91CD\\u542F\\u7684\\u5462\\uFF1F\"), mdx(\"p\", null, \"\\u7B54\\u6848\\u5C31\\u5728\\u4E0A\\u9762\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u7684\\u5B9E\\u73B0\\u4E2D\\uFF1A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u7684workLoop\\u65B9\\u6CD5\\u4E2D\\uFF0C\\u53D6\\u51FA\\u4EFB\\u52A1\\u6267\\u884C\\u5176\\u56DE\\u8C03\\u540E\\uFF0C\\u5982\\u679C\\u56DE\\u8C03\\u6709\\u8FD4\\u56DE\\u503C\\u4E14\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"function\"), \"\\uFF0C\\u5219\\u8BA4\\u4E3A\\u662F\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"continuation\"), \"\\u51FD\\u6570\\uFF0C\\u8BF4\\u660E\\u8FD9\\u4E2A\\u4EFB\\u52A1\\u8FD8\\u9700\\u8981\\u7EE7\\u7EED\\u6267\\u884C\\u3002\\u8FD9\\u4E2Atask\\u4E0D\\u4F1A\\u4E22\\u5F03\\uFF0C\\u53EA\\u9700\\u8981\\u66F4\\u65B0\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"callback=continuation\"), \"\\u5373\\u53EF\\uFF0C\\u4E0B\\u6B21\\u8FD8\\u53EF\\u4EE5\\u53D6\\u51FA\\u6765\\u6267\\u884C\\u3002\\u6CA1\\u6709\\u8FD4\\u56DE\\u503C\\u7684task\\uFF0C\\u6267\\u884C\\u5B8C\\u5C31\\u4E22\\u5F03\\u4E86\\u3002\"), mdx(\"p\", null, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u63D0\\u4F9B\\u4E86\\u8FD9\\u4E2A\\u7279\\u6027\\u3002React\\u5C31\\u9700\\u8981\\u4F7F\\u7528\\u5B83\\u3002\\u770BReact\\u7684workLoop\\u5904\\u7684\\u6E90\\u7801\\u53EF\\u4EE5\\u770B\\u5230\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"ensureRootIsScheduled\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8C03\\u5EA6\\u4E00\\u6B21\\u6E32\\u67D3\"), \"\\n  newCallbackNode \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"scheduleCallback\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"schedulerPriorityLevel\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performConcurrentWorkOnRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"bind\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u5F00\\u59CB\\u6267\\u884C\\u6E32\\u67D3\\u3002\\u8FD9\\u4E2A\\u65B9\\u6CD5\\u5185\\u90E8\\u8FDB\\u5165workLoopConcurrent\\uFF0C\\u6709\\u53EF\\u80FD\\u4E2D\\u65AD\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performConcurrentWorkOnRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"workLoopConcurrent\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// callbackNode\\u6CA1\\u53D8\\uFF0C\\u4EFB\\u52A1\\u672A\\u6267\\u884C\\u5B8C\\uFF0C\\u4EE3\\u8868\\u88AB\\u4E2D\\u65AD\\u4E86\\u3002\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), \"root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"callbackNode \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"===\"), \" originalCallbackNode\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"performConcurrentWorkOnRoot\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"bind\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \" root\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u8FD4\\u56DE\\u4E00\\u4E2Acontinuation\\u51FD\\u6570\\u4E3A\\u51FD\\u6570\\u81EA\\u8EAB\\u3002\\u4E0B\\u4E00\\u5207\\u7247Scheduler\\u8FD8\\u4F1A\\u8C03\\u7528\\u3002\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"null\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// \\u6267\\u884C\\u5B8C\\u4E86\\uFF0C\\u5C31\\u4E0D\\u9700\\u8981\\u8FD4\\u56DEcontinuation\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\")))), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"\\u672CScheduler\\u7AE0\\u8282\\u6D4B\\u8BD5\\u7684\\u6E90\\u4EE3\\u7801\\u5728\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://codesandbox.io/p/devbox/h9h7ln\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }, \"codeSandbox\\u4E0A\"), \"\\u3002\")), mdx(\"h3\", null, \"Lane\\u6A21\\u578B\"), mdx(\"p\", null, \"\\u524D\\u9762\\u8BE6\\u7EC6\\u8BB2\\u4E86\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u7684\\u77E5\\u8BC6\\u3002\\u5B83\\u5728\\u5185\\u90E8\\u4F7F\\u7528\\u4E865\\u79CD\\u4F18\\u5148\\u7EA7\\u3002\\u90A3Lane\\u6A21\\u578B\\u53C8\\u662F\\u4EC0\\u4E48\\u5462\\uFF1F\"), mdx(\"p\", null, \"Lane\\u6A21\\u578B\\u662FReact\\u5185\\u90E8\\u5BF9\\u66F4\\u65B0\\u5212\\u5206\\u4F18\\u5148\\u7EA7\\uFF0C\\u5E76\\u8FDB\\u884C\\u534F\\u8C03\\u3001\\u5408\\u5E76\\u548C\\u6267\\u884C\\u7684\\u4E00\\u5957\\u89C4\\u5219\\u3002\\u5B83\\u4E0E\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Scheduler\"), \"\\u662F\\u4E24\\u5957\\u4E1C\\u897F\\u3002Lane\\u4F7F\\u752831\\u4F4D\\u7684\\u4E8C\\u8FDB\\u5236\\u6765\\u8868\\u793A\\u3002\\u5C31\\u50CF\\u662F\\u4E00\\u6761\\u4E00\\u6761\\u7684\\u8D5B\\u8F66\\u9053\\uFF0C\\u8D8A\\u9760\\u5185\\u7684\\u8D5B\\u9053\\u957F\\u5EA6\\u8D8A\\u77ED\\uFF0CLane\\u4F4D\\u6570\\u8D8A\\u5C0F\\u7684\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u4F18\\u5148\\u7EA7\"), \"\\u8D8A\\u9AD8\\u3002\\u7C7B\\u4F3C\\u4E8E\\uFF1A\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"javascript\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"export\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"const\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token literal-property property\"\n  }, \"SyncLane\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \":\"), \" Lane \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"/*                        */\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"0b0000000000000000000000000000001\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token comment\"\n  }, \"// ...\")))), mdx(\"p\", null, \"React\\u5C06\\u66F4\\u65B0\\u6839\\u636E\\u4F18\\u5148\\u7EA7\\u5206\\u914D\\u5176\\u5230\\u76F8\\u5E94\\u7684Lane\\u4E2D\\u3002\\u6BD4\\u5982\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4E3A\\u7528\\u6237\\u4EA4\\u4E92\\u4E8B\\u4EF6\\u89E6\\u53D1\\u7684\\u66F4\\u65B0\\uFF0C\\u4F7F\\u7528\\u9AD8\\u4F18\\u5148\\u7EA7\\uFF0C\\u786E\\u4FDD\\u8BE5\\u66F4\\u65B0\\u80FD\\u66F4\\u5FEB\\u6E32\\u67D3\\u5230\\u754C\\u9762\\u4E0A\\u3002\\uFF08\\u539F\\u7406React\\u5C01\\u88C5\\u4E86\\u4E8B\\u4EF6\\u5904\\u7406\\u5668\\uFF0C\\u5728\\u8C03\\u7528\\u6211\\u4EEC\\u7684\\u56DE\\u8C03\\u4E4B\\u524D\\uFF0C\\u5148\\u8BBE\\u7F6E\\u597D\\u4E86\\u4F18\\u5148\\u7EA7\\uFF0C\\u5F53\\u6267\\u884C\\u5230setState\\u7B49\\u65B9\\u6CD5\\u65F6\\uFF0C\\u80FD\\u83B7\\u53D6\\u5230\\u5DF2\\u8BBE\\u7F6E\\u7684\\u4F18\\u5148\\u7EA7\\uFF09\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4F7F\\u7528\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Transition\"), \"\\u6216\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Suspense\"), \"\\u65F6\\u89E6\\u53D1\\u7684\\u66F4\\u65B0\\uFF0C\\u5C06\\u4F1A\\u4F7F\\u7528\\u4F4E\\u4F18\\u5148\\u7EA7\\u3002\\u4ECE\\u800C\\u4E0D\\u5F71\\u54CD\\u91CD\\u8981\\u7684\\u66F4\\u65B0\\u3002\"))), mdx(\"p\", null, \"Lane\\u6A21\\u578B\\u4E5F\\u6BD4\\u8F83\\u590D\\u6742\\uFF0C\\u540E\\u7EED\\u53EF\\u80FD\\u4F1A\\u5355\\u72EC\\u51FA\\u4E00\\u7BC7\\u6587\\u7AE0\\u8BB2\\u89E3\\u6E05\\u695A\\u3002\\u8FD9\\u6B21\\u7B80\\u5355\\u4EE5\\u95EE\\u7B54\\u5F62\\u5F0F\\u5199\\u4E00\\u4E0B\\u3002\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Lane\\u4E3A\\u4EC0\\u4E48\\u4F7F\\u7528\\u4E8C\\u8FDB\\u5236\\u6765\\u8868\\u793A\\uFF1F\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u56E0\\u4E3A\\u4F4D\\u8FD0\\u7B97\\u6BD4\\u8F83\\u65B9\\u4FBF\\u3002\\u5E76\\u4E14\\u80FD\\u7528\\u591A\\u4E2A\\u4F4D\\u8868\\u793A\\u540C\\u4E00\\u4F18\\u5148\\u7EA7\\u7684\\u8BB8\\u591A\\u4E2A\\u66F4\\u65B0\\uFF0C\\u79F0\\u4E3A\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"\\u6279\"), \"\\u3002\\u6BD4\\u5982\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"const TransitionLanes = 0b0000000001111111110000000000000;\"), \"\\uFF0CTransition\\u5360\\u4E869\\u4E2A\\u4F4D\\uFF0C\\u67092^9\\u4E2A\\u53D6\\u503C\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Lane\\u4EC0\\u4E48\\u65F6\\u5019\\u88AB\\u751F\\u4EA7\\uFF1F\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u89E6\\u53D1\\u66F4\\u65B0\\u7684\\u65F6\\u5019\\uFF0CReact\\u5C31\\u4F1A\\u6839\\u636E\\u5F53\\u524D\\u73AF\\u5883\\u4E3A\\u8FD9\\u4E2A\\u66F4\\u65B0\\u751F\\u4EA7\\u4E00\\u4E2Alane\\u3002\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Lane\\u4EC0\\u4E48\\u65F6\\u5019\\u88AB\\u4F7F\\u7528\\uFF1F\"), mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u66F4\\u65B0\\u8C03\\u5EA6\\u524D\\uFF0C\\u6839\\u636Elane\\u5224\\u65AD\\u662F\\u5426\\u8C03\\u5EA6\\u66F4\\u65B0\\u3001\\u662F\\u5426\\u53D6\\u6D88\\u524D\\u4E00\\u6B21\\u66F4\\u65B0\\u3001\\u6309\\u7167\\u4EC0\\u4E48\\u4F18\\u5148\\u7EA7\\u8C03\\u5EA6\\u66F4\\u65B0\\u7B49\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"render\\u9636\\u6BB5\"), \"\\u6839\\u636E\\u5F53\\u524Dlane\\u548C\", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Update\"), \"\\u7684lane\\u6765\\u5904\\u7406state\\u3002lane\\u4F18\\u5148\\u7EA7\\u4E0D\\u591F\\u7684\\uFF0C\\u7559\\u5230\\u540E\\u9762\\u5904\\u7406\\u3002\")))), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Lane\\u548CScheduler\\u7684\\u5173\\u7CFB\\u662F\\uFF1F\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Lane\\u662FReact\\u5185\\u90E8\\u7528\\u7684\\u4F18\\u5148\\u7EA7\\u6A21\\u578B\\uFF0C\\u4E3B\\u8981\\u662F\\u7528\\u6765\\u6807\\u8BB0\\u66F4\\u65B0\\u7684\\u4F18\\u5148\\u7EA7\\u3002\\u800CScheduler\\u662F\\u72EC\\u7ACB\\u7684\\u4F18\\u5148\\u7EA7\\u8C03\\u5EA6\\u5668\\u3002\\u4E0D\\u8FC7lane\\u53EF\\u4EE5\\u4E0EScheduler\\u76845\\u79CD\\u4F18\\u5148\\u7EA7\\uFF0C\\u5E76\\u53D1\\u9001\\u7ED9Scheduler\\u3002\"))), mdx(\"h3\", null, \"\\u5176\\u4ED6\"), mdx(\"p\", null, \"\\u672C\\u6587\\u4E3B\\u8981\\u4ECE\\u603B\\u4F53\\u7684\\u89D2\\u5EA6\\u8BB2\\u4E86\\u4E00\\u4E0BFiber\\u67B6\\u6784\\u4E0B\\u7684\\u6E32\\u67D3\\u5DE5\\u4F5C\\u6D41\\u7A0B\\u662F\\u4EC0\\u4E48\\u6837\\u7684\\u3002\\u5B9E\\u9645\\u4E0A\\uFF0CReact\\u7684\\u6E90\\u7801\\u975E\\u5E38\\u5E9E\\u5927\\uFF0C\\u5305\\u542B\\u7684\\u6A21\\u5757\\u975E\\u5E38\\u591A\\u3002\\u672C\\u6587\\u5F88\\u591A\\u90FD\\u6CA1\\u6709\\u6D89\\u53CA\\u5230\\u3002\\u540E\\u7EED\\u5982\\u679C\\u6709\\u65F6\\u95F4\\u7684\\u8BDD\\uFF0C\\u4F1A\\u5355\\u72EC\\u51FA\\u6587\\u7AE0\\u3002\\u6328\\u4E2A\\u7684\\u8BB2\\u6E05\\u695A\\u3002\"), mdx(\"p\", null, \"\\u8BA1\\u5212\\u8981\\u8BE6\\u7EC6\\u8BB2\\u89E3\\u7684\\u77E5\\u8BC6\\u70B9\\u6709\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5DE5\\u4F5C\\u5FAA\\u73AF\\u7684\\u8BBE\\u8BA1\\u601D\\u8DEF\\u548C\\u4E2D\\u65AD\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Fiber\\u534F\\u8C03\\u65F6\\u7684Diff\\u7B97\\u6CD5\\u548Cmutation\\u9636\\u6BB5\\u66F4\\u65B0dom\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Hooks\\u5B9E\\u73B0\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Scheduler\\u624B\\u628A\\u624B\\u5B9E\\u73B0\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Lane\\u6A21\\u578B\\u5177\\u4F53\\u5B9E\\u73B0\"))));\n}\n;\nMDXContent.isMDXComponent = true;","timeToRead":2,"excerpt":"众所周知，React团队耗时2年多在React16发布了全新重构版本的Fiber架构，替代了原来的 Stack Recociler + Renderer…","frontmatter":{"title":"React Fiber架构总览","description":"介绍React16带来的全新fiber架构，它的设计总览","cover":{"publicURL":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/react-fiber.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABxpq1QP/EABYQAAMAAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQIc/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAABEQAhIEGR/9oACAEBAAE/IQndxNAdx//aAAwDAQACAAMAAAAQS+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhEDFBYYH/2gAIAQEAAT8QYKKXkWrmPC7EzycaO8//2Q=="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/29db4/react-fiber.jpg","srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/ed76a/react-fiber.jpg 275w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/a7f65/react-fiber.jpg 549w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/29db4/react-fiber.jpg 1098w","sizes":"(min-width: 1098px) 1098px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/77d15/react-fiber.avif 275w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/7d872/react-fiber.avif 549w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/50cc1/react-fiber.avif 1098w","type":"image/avif","sizes":"(min-width: 1098px) 1098px, 100vw"},{"srcSet":"/leon-blog/static/da24c565e170845a9f10394ef98ce91a/1f877/react-fiber.webp 275w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/12e3f/react-fiber.webp 549w,\n/leon-blog/static/da24c565e170845a9f10394ef98ce91a/c81ec/react-fiber.webp 1098w","type":"image/webp","sizes":"(min-width: 1098px) 1098px, 100vw"}]},"width":1098,"height":544}}},"coverAlt":"封面","datePublished":"2023-02-09 11:20:41","dateModified":"2023-02-09 11:20:41","category":"经验总结","tags":["前端","React","架构","造轮子"]},"fields":{"slug":"/react-fiber-struct","route":"/react-fiber-struct","pathName":"/leon-blog/react-fiber-struct","url":"https://missmess.github.io/leon-blog/react-fiber-struct"},"internal":{"content":"---\ntitle: \"React Fiber架构总览\"\ncover: ../static/assets/react-fiber.jpg\ncoverAlt: \"封面\"\ndescription: \"介绍React16带来的全新fiber架构，它的设计总览\"\ndatePublished: \"2023-02-09 11:20:41\"\ndateModified: \"2023-02-09 11:20:41\"\nslug: \"react-fiber-struct\"\ncategory: \"经验总结\"\ntags:\n  - 前端\n  - React\n  - 架构\n  - 造轮子\n---\n\n众所周知，React团队耗时2年多在React16发布了全新重构版本的Fiber架构，替代了原来的`Stack Recociler + Renderer`的架构组合。重构的主要升级目标就是，将老架构的**同步更新**，替换为**异步可中断的更新**模式，并由此带来了一系列新特性。本文会从总体的角度讲一下整个Fiber架构的工作流程。\n\n### 导航\n\n- [老架构](#老架构)\n- [新架构](#新架构)\n- [触发更新](#触发更新)\n- [render阶段](#render阶段)\n- [commit阶段](#commit阶段)\n- [Scheduler调度器](#scheduler调度器)\n- [Lane模型](#lane模型)\n- [其他](#其他)\n\n### 老架构\n\n在了解新架构之前，先来看看在此之前的老架构是什么样的，存在什么问题。React15的架构可以分为：\n\n- Reconciler（协调器）：负责对虚拟DOM使用Diff算法找出发生变化的组件\n- Renderer（渲染器）：负责根据组件的变化更新渲染到页面上\n\n> 老React的具体渲染流程可以看[我之前的文章](/vue-react-render)\n\n简单来说，**Reconciler**会在每次渲染流程中：\n\n1. 生成内部组件实例。函数组件或类组件调用render方法，将JSX转化为虚拟DOM。\n2. 新生成的虚拟DOM与上次的的进行对比。\n3. 找到可以复用的不用重新创建DOM，将变化通过**Renderer**渲染到页面上。\n4. 找不到可复用的，通过**Renderer**操作页面DOM。\n5. 对children递归处理，重复以上步骤。\n\n而**Renderer**则会去操作DOM节点的移动、更新、删除，这个过程是同步的。即**Reconciler**与**Renderer**是交替工作的，**Reconciler**发现变化就通知**Renderer**立即去渲染。直到整个渲染流程结束。\n\n> *React支持跨平台，主要体现在可以针对不同的平台有不同的Renderer*。我们最熟悉的是Renderer是[ReactDOM](https://www.npmjs.com/package/react-dom)，除此之外，还有大名鼎鼎的[React Native](https://www.npmjs.com/package/react-native)。\n\n**老架构的缺点**\n\n递归协调工作一旦开始，就无法结束，必须等待协调过程结束。如果节点太多，处理耗时太长（超过了16ms），则可能会导致页面出现掉帧、卡顿。\n\n### 新架构\n\n新架构不再使用内部组件来处理虚拟DOM的diff，而改为使用Fiber节点。每个Fiber节点既是一个独立工作单元，也是一个树节点，与其他Fiber节点共同组成Fiber树，同时也记录着动态的数据和状态。Fiber节点可以认为和每一个JSX节点一一对应。新架构下，不再是同步的实时更新，而是异步的可中断更新。\n\n新Fiber架构的设计分为：\n\n- Reconciler（协调器）：负责对Fiber节点进行对比，找出其中的变化。（可中断发生在这里）\n- Renderer（渲染器）：负责根据组件的变化更新渲染到页面上\n- Scheduler（调度器）：根据优先级，在时间切片上调度任务\n\n其中Fiber树还用到了“双缓存”的技术。\n\n**双缓存Fiber树**就是React中存在两棵Fiber树，一棵是当前渲染在屏幕上的，叫**current**，另一棵是在内存中正在构建操作的，叫**workInProgess**。一旦构建完成，原来的current丢弃，current指向workInProgress，即完成了Fiber树的替换。\n\n在这样的架构模式下，工作模式变成了：\n\n1. Scheduler接收到更新，判断优先级，通知Reconciler开始工作。\n\n2. Reconciler进入render阶段。开始在内存中构建workInProgress树。进入workLoop（工作循环）。\n\n3. 对每一个工作单元（Fiber）进行beginWork（创建Fiber，diff和标记变化）。beginWork结束后，执行completeWork（创建DOM，children Append等）。\n\n4. 每完成一个工作单元，通过Scheduler判断是否要中断render阶段。\n\n5. render阶段结束后，进入commit阶段。Reconciler通知Renderer开始对发生变化的节点操作DOM。这个过程是同步的。\n\n6. 完成后，将current树指向workInProgress树。\n\n接下来就具体讲一下每个工作步骤。\n\n### 触发更新\n\n这些方法会触发一次渲染更新流程：\n\n- `ReactDOM.render`\n- `this.setState`\n- `this.forceUpdate`\n- `useState`的`dispatch`函数\n- `useReducer`的`dispatch`函数\n\n调用上述方法会生成一个`Update`对象。`Update`对象中存储了优先级（lane值）。一组`Update`对象会以环状链表的数据结构存储在Fiber上。*（至于为什么是一组？因为很有可能你会在一次事件处理里，调用多次`setState`）。*\n\n> **类组件**的`Update`（[代码位置](https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactUpdateQueue.old.js#L110)）存储方式与**函数组件**的`Update`（[代码位置](https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberHooks.old.js#L100)）相差甚远。但是这不影响我们理解触发更新的流程。简单说下：<br />\n**类组件**下使用`UpdateQueue`存储`baseState`（组件当前状态）和`Update`环状链表，字段为`Fiber.updateQueue`。到了`render阶段`的`beginWork`阶段，在调用`render()`方法前。会根据`lane`优先级来计算优先级足够的`Update`并更新state（[代码位置](https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L856)）。<br />\n**函数组件**就比较复杂了，它跟`Hooks`机制息息相关。`Fiber.updateQueue`上存储的是Effect（来源自`useEffect`、`useLayoutEffect`）的环状链表。它会在`render阶段`（useLayoutEffect）或`commit阶段`（useEffect）被遍历和调用。而我们所说的`Update`是以环状链表形式存储在`Hook.queue`里，每个`Hook`对象又以单向链表的形式存储在`Fiber.memoizedState`字段里（[代码位置](https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/react-reconciler/src/ReactFiberHooks.old.js#L566)）。state是在调用`useState`方法时根据优先级和`Update`链表计算出来的。<br />\n顺便提一句，`HostRoot`存储`Update`（由`ReactDOM.render`触发）的方式与类组件相同。<br />\n再提一句，`HostComponent`即原生组件上，`Fiber.updateQueue`存储的是属性更新的字段和值，以数组形式交替存储键和值：[key1, prop1, key2, prop2, ...]。\n\n生成`Update`后，根据优先级的不同处理，会触发一次同步更新或异步调度的更新（也可能批处理return掉，不发起新更新）：\n\n```javascript\n// 每一个Update，最终都会走到这里\nfunction ensureRootIsScheduled() {\n  // 1. 获取lane\n  // 2. 判断lane，看是否需要取消调度的任务\n  // 3. 判断lane，看是否需要发起新的调度\n  // ...\n  if (newCallbackPriority === SyncLanePriority) {\n    // 同步优先级，执行同步更新\n    newCallbackNode = scheduleSyncCallback(\n      performSyncWorkOnRoot.bind(null, root)\n    );\n  } else {\n    var schedulerPriorityLevel = lanePriorityToSchedulerPriority(newCallbackPriority);\n    // 异步调度一次更新（可中断）\n    newCallbackNode = scheduleCallback(\n      schedulerPriorityLevel,\n      performConcurrentWorkOnRoot.bind(null, root)\n    );\n  }\n  // ...\n}\n```\n\n同步更新执行后或者异步更新被调度执行后，会进入render阶段。代码类似于：\n\n```javascript\nfunction performConcurrentWorkOnRoot(root) {\n  // render阶段\n  renderRootConcurrent(root);\n  // commit阶段\n  commitRoot(root);\n}\n```\n\n### render阶段\n\nrender阶段从`FiberRoot`开始，创建第一个`workInProgress`。然后进入workLoop（工作循环）。针对每一个workInProgress工作单元，都对其执行`beginWork`和`completeWork`。类似于下面这段代码：\n\n```javascript\nfunction workLoopConcurrent(root) {\n  let workInProgress = createWorkInProgress(root);\n  // 循环工作循环\n  while (workInProgress != null) {\n    let unitOfWork = workInProgress;\n\n    beginWork(unitOfWork);\n\n    if (unitOfWork.child !== null && !shouldYield()) {\n      workInProgress = unitOfWork.child;\n      continue;\n    }\n\n    let completedWork = unitOfWork;\n\n    do {\n      completeWork(completedWork)\n\n      const returnFiber = completedWork.return;\n      const siblingFiber = completedWork.sibling;\n      if (siblingFiber != null) {\n        workInProgress = siblingFiber;\n        break;\n      }\n\n      completedWork = returnFiber;\n      workInProgress = completedWork;\n    } while (completedWork != null);\n  }\n}\n```\n\n在工作循环中，会挨个处理每一个fiber节点，对每个fiber节点都会执行一次`beginWork`和`completeWork`，但是它们的执行时机不同。`beginWork`会以深度优先的方式，往子孙树从上往下执行。而`completeWork`是在每一个节点及其子孙都执行完`beginWork`后，往祖先树从下往上执行。\n\n*另外，工作循环是可中断和恢复的，即如果上面的`shouldYield()`返回true，那么`render阶段`就退出了。等待下次重新启动渲染流程，由于记录了workInProgress，所以可以恢复。React中的异步可中断更新就是中断的render阶段。*\n\n> 工作循环的具体设计思路，后续会补充一篇文章单独讲解。\n\n#### beginWork\n\n`beginWork`是协调器里最重要的一个方法。它是从上往下执行的，我们从`FiberRoot`开始只有一个新fiber节点，即第一个workInProgress，执行`beginWork`的目的是为了构建完整的workInProgress树。可以猜到`beginWork`的主要功能就是对比新旧fiber，协调出新的children fiber并链接到workInProgress上。具体步骤为：\n\n1. 判断workInProgress是否可以复用旧的fiber，可以复用（props和context都未变化），则克隆children fiber并挂到workInProgress树。跳过2、3步。\n\n2. 如果不可复用，则重新执行渲染函数（类组件或函数组件）获取newChildren或从props.children获取（Host组件）。\n\n3. 获取到newChildren后，和旧的fiber链表进行协调。协调过程就是diff，并标记变化（effectTag，后续根据这个判断如何变更DOM）到新fiber上。\n\n4. beginWork完成，返回child作为下一个工作单元。如果没有child，则进入`completeWork`。\n\n#### completeWork\n\n`completeWork`是在当前workInProgress fiber的子孙全部协调结束后执行的。它可以执行一些收尾工作。例如对于`HostComponent`，它执行了：\n\n1. 如果是update时（即存在旧fiber-current），处理变化的props，存储到`workInProgress.updateQueue`（会在commit阶段渲染到页面上）。\n\n2. 如果是mount时，为当前fiber创建对应的DOM节点。并将children的DOM节点插入进来。\n\n其他类型的组件处理的工作并不相同。到这里`completeWork`工作就结束了。\n\n#### effectList串联\n\n之前我们提到`beginWork`里会在fiber上标记变化，即effectTag。后续`commit`阶段需要用于变更DOM。为了方便后续该操作，React在`completeWork`完成后，额外执行了一个串联effectList的工作。\n\neffectList挂载在fiber上，其实就是一个单向链表，以`fiber.firstEffect`为第一个，`fiber.lastEffect`为最后一个，前一个的`nextEffect`指向后一个。\n\n1. 每个fiber判断自己是否有effectTag，如果有，把自己串到父fiber的effectList最后。\n\n2. 和`completeWork`一样，往祖先级从下往上执行，所以最终`rootFiber`上的effectList就是整棵树全部的effect了。\n\n### commit阶段\n\n`render阶段`结束后，直接进入`commit阶段`。顾名思义，就是将`render阶段`发生的effect，在该阶段提交到页面上。注意，不同于`render阶段`可以中断。`commit阶段`是同步执行的，不可中断。\n\nReact将`commit阶段`又分为三个小阶段。\n\n#### before mutation阶段\n\n`before mutation`是在执行具体的DOM操作之前。在这个阶段可以做一些准备工作。包括：\n\n1. 处理渲染/删除节点的focus/blur状态。\n\n2. 调用`getSnapshotBeforeUpdate`。（commit阶段是同步的所以该方法不会多次调用，`UNSAFE_componentWillReceiveProps`在render阶段被调用所以不安全）。\n\n3. 异步调度`useEffect`回调函数。\n\n它主要通过遍历effectList链表，来对有effect的节点进行这些处理。\n\n#### mutation阶段\n\n`mutation`是实实在在的执行DOM操作的阶段。\n\n它也是遍历effectList链表，然后对不同的effect进行处理，主要包含3种effect：\n\n**Placement**\n\n代表该fiber所复用的DOM节点需要更换位置。\n\n1. 如果有下一个稳定的兄弟DOM，则插入到兄弟DOM之前。这里有三个理解难点：\n\n    - 一是为什么要插入到下一个兄弟DOM之前？因为在之前`render阶段`的diff算法原理是遍历newChildren时，总是标记需要右移的fiber。这个fiber的下一个兄弟一定在它右边，所以fiber对应的dom一定在下一个兄弟dom的左边。\n    \n    - 二是查找兄弟DOM需要跨层级搜索，因为兄弟fiber不一定有兄弟DOM。兄弟dom可能就是它的sibling，但也有可能在它的父fiber的sibling树下，也有可能在它的sibling树下。\n\n    - 三是为什么要找稳定的兄弟？稳定是指没有被Placement标记的。因为如果兄弟被Placement标记了，那它对应的dom一定也会被移动，所以不能直接插入它前面。\n\n    （这里的逻辑比较复杂，后续会补充一篇文章，专门讲解一下整个Diff算法和mutation逻辑）\n\n2. 如果没有稳定的兄弟DOM，则插入到队尾。这个好理解。\n\n**Update**\n\n代表该fiber需要更新。对于不同的fiber，需要不同的处理。\n\n对于函数组件，执行`useLayoutEffect`的销毁函数。\n\n对于Host组件，会将之前`render阶段`-`completeWork`中赋值的`updateQueue`更新到dom上，其实就是更新dom属性。\n\n**Deletion**\n\n代表该fiber对应的dom需要被移除。当然包括它的子孙fiber节点。\n\n该方法主要处理几个操作：\n\n1. 递归处理fiber和它的子孙fiber。\n\n2. 移除对应的DOM节点。\n\n3. 解绑ref。\n\n4. 如果是类组件，调用`componentWillUnmount`生命周期。\n\n#### layout阶段\n\n`layout`阶段，是所有DOM修改完成后才执行的，这时候js代码或者在这个阶段触发的生命周期，都已经可以访问到修改后的DOM了。\n\n在这个阶段，也是遍历effectList列表。主要做了三件事：\n\n1. 对于有**Update**的fiber，如果是类组件，则触发生命周期componentDidMount或componentDidUpdate。\n\n2. 对于有**Update**的fiber，如果是函数组件，则同步执行useLayoutEffect的回调函数、异步调度useEffect的销毁函数与回调函数。\n\n3. 绑定ref。\n\n至此，layout阶段也完成了。替换一下workInProgress树，那么整个渲染更新流程就结束啦！\n\n```javascript\nroot.current = finishedWork;\n```\n\n### Scheduler调度器\n\n接着讲一下`Scheduler`，它在React中是一个独立的包。它的功能是作为任务调度器，用于根据优先级和时间切片来控制任务执行时机。它主要包含两部分功能：**时间切片**和**优先级调度**。\n\n#### 时间切片\n\n时间切片，即在浏览器每一帧中给予一定的时间去执行任务，如果时间超出了，则中断任务执行，控制权交还给浏览器，等到下一帧再继续执行。从而保证即使执行长任务，也不会长时间占用主线程，仍然能给予浏览器足够时间，从而保证整个界面和交互的流畅。\n\n它的功能很像[requestIdleCallback](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback)和`requestAnimationFrame`。那为什么不直接用`requestIdleCallback`和`requestAnimationFrame`呢？\n\n一是`requestIdleCallback`调用时机不确定；\n\n二是各个浏览器对`requestIdleCallback`和`requestAnimationFrame`的实现不一样，有兼容性问题；\n\n三是React希望能实现更精细的优先级和执行时间控制。\n\n> React的Scheduler基于[MessageChannel](https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/scheduler/src/forks/SchedulerHostConfig.default.js#L228-L234)，如果浏览器不支持`MessageChannel`，则fallback为[setTimeout](https://github.com/facebook/react/blob/1fb18e22ae66fdb1dc127347e169e73948778e5a/packages/scheduler/src/forks/SchedulerHostConfig.default.js#L47-L55)。都是作为宏任务实现的，在浏览器处理完一帧后开始处理宏任务，从而运行`Scheduler`的代码，此时控制权在`Scheduler`手上了，它又可以继续调度任务了。\n\n联想到之前render阶段，在工作循环中，有一个`shouldYield()`方法。这个方法就是Scheduler提供的，用于判断下一个工作单元是否需要中断执行。\n\n它的原理概括起来就是：在Scheduler中，会为**被调度的任务执行**分配一个可执行时间。开始执行时记录当前时间。如果执行任务的耗时超过了分配的时间，则执行任务中止，`shouldYield()`也会返回true。等待到下一个时间切片（即浏览器处理完后交还给`Scheduler`）到来，重新记录执行时间。这部分代码简化如下：\n\n```javascript\n// ****** SchedulerHostConfig.default.js ******\nlet yieldInterval = 5; // 时间切片长度5ms\nlet deadline = 0; // 执行截止时间\nlet scheduledHostCallback = null; // 执行任务的回调\nlet isMessageLoopRunning = false; // 是否正在执行\n\n// 判断是否应该让出主线程\nfunction shouldYieldToHost() {\n  return getCurrentTime() >= deadline;\n}\n\n// 执行任务（浏览器交还控制权的入口函数）\nfunction performWorkUntilDeadline() {\n  if (scheduledHostCallback !== null) {\n    const currentTime = getCurrentTime();\n    // 计算出截止时间\n    deadline = currentTime + yieldInterval;\n    // 执行\n    const hasMoreWork = scheduledHostCallback(currentTime);\n    if (!hasMoreWork) {\n      // 执行结束\n      isMessageLoopRunning = false;\n      scheduledHostCallback = null;\n    } else {\n      // 未结束，重新发消息，等下一个时间切片\n      port.postMessage(null);\n    }\n  } else {\n    isMessageLoopRunning = false;\n  }\n}\n\n// 通过MessageChannel实现时间切片\nconst channel = new MessageChannel();\nconst port = channel.port2;\nchannel.port1.onmessage = performWorkUntilDeadline;\n\n// 这个回调会在入口函数调用\nfunction requestHostCallback(callback) {\n  scheduledHostCallback = callback;\n  if (!isMessageLoopRunning) {\n    isMessageLoopRunning = true;\n    // 发消息，等下一个时间切片\n    port.postMessage(null);\n  }\n}\n```\n\n#### 优先级调度\n\nScheduler提供了一个`scheduleCallback`方法，当需要优先级异步调度某个回调函数时，就调用这个方法。在`render阶段`和`commit阶段`，很多地方使用了这个方法来调度，比如渲染入口函数的异步调度、useEffect回调的异步调度等。\n\nScheduler设置了5种**优先级**，来控制任务的执行时机。不同的优先级有不同的timeout（超时时间），每个添加到Scheduler的任务根据currentTime（当前时间）计算出过期时间（expirationTime）。按优先级执行任务的原理就是，Scheduler会将任务放在优先级队列中，队列中是按照过期时间排序的，最近过期的在队列最前面。每来一个新任务，就计算它的过期时间，然后放入队列中重新排序。\n\n> Scheduler的优先级队列实现，使用的是[小顶堆](https://www.cnblogs.com/lanhaicode/p/10546257.html)。\n\nScheduler在收到`scheduleCallback`注册的回调后，对其进行调度。等到时间切片开始执行时，在workLoop（注意，不要和React渲染流程的工作循环弄混了）方法中通过while循环从任务队列中不断取出任务并执行。while循环时判断当前已到达截止时间，则退出循环。简化的代码如下：\n\n```javascript\n// ***** Scheduler.js *****\nlet taskQueue = []; // 优先级任务队列（React用小顶堆，我们为了模拟用数组）\nlet currentTask = null; // 当前执行的任务\nlet isHostCallbackScheduled = false; // 是否已经发送到host\n\n// 按优先级注册任务的调度器入口（给React用的）\nfunction scheduleCallback(priorityLevel, callback) {\n  // 创建新任务\n  const currentTime = getCurrentTime();\n  // 优先级越高，timeout越小\n  const timeout = timeoutForPriorityLevel(priorityLevel);\n  const expirationTime = currentTime + timeout;\n  const newTask = {\n    callback,\n    priorityLevel,\n    startTime: currentTime,\n    expirationTime,\n  };\n  // 加入任务队列（并按照到期时间排序）\n  push(taskQueue, newTask);\n\n  if (!isHostCallbackScheduled) {\n    // 没有注册回调，注册回调\n    isHostCallbackScheduled = true;\n    requestHostCallback(flushWork);\n  }\n  return newTask;\n}\n\n// 最终每个切片会从这里开始\nfunction flushWork() {\n  console.log(\"切片内，开始执行任务\");\n  isHostCallbackScheduled = false;\n\n  return workLoop();\n}\n\n// 循环取任务执行，直到时间切片到达截止时间\nfunction workLoop() {\n  currentTask = peek(taskQueue);\n\n  while (currentTask !== null) {\n    if (shouldYieldToHost()) {\n      break;\n    }\n\n    const callback = currentTask.callback;\n\n    if (callback !== null) {\n      currentTask.callback = null;\n      const continuationCallback = callback();\n      if (typeof continuationCallback === \"function\") {\n        currentTask.callback = continuationCallback;\n      } else {\n        pop(taskQueue);\n      }\n    } else {\n      pop(taskQueue);\n    }\n    currentTask = peek(taskQueue);\n  }\n\n  if (currentTask !== null) {\n    return true;\n  } else {\n    return false;\n  }\n}\n```\n\n#### React中使用Scheduler\n\n时间切片和优先级调度都已经串起来了，现在以React中的使用，举例说清楚：React将某个更新触发的渲染、和一组useEffect回调都作为**任务**丢给了`Scheduler`来异步调度，它们都带着优先级过去。Scheduler从任务队列中取任务执行。其中React的更新渲染执行时也是可以中断的，前面我们已经讲过，是workLoop执行时通过`shouldYield()`方法判断的。`useEffect`的任务执行时是没法中断的，所以useEffect中仍然不能处理耗时操作。\n\n思考一下，React的渲染工作循环由于时间切片机制可能会中断，那它是如何重启的呢？\n\n答案就在上面`Scheduler`的实现中：`Scheduler`的workLoop方法中，取出任务执行其回调后，如果回调有返回值且为`function`，则认为是`continuation`函数，说明这个任务还需要继续执行。这个task不会丢弃，只需要更新`callback=continuation`即可，下次还可以取出来执行。没有返回值的task，执行完就丢弃了。\n\n`Scheduler`提供了这个特性。React就需要使用它。看React的workLoop处的源码可以看到：\n\n```javascript\nfunction ensureRootIsScheduled() {\n  // ...\n  // 调度一次渲染\n  newCallbackNode = scheduleCallback(schedulerPriorityLevel, performConcurrentWorkOnRoot.bind(null, root));\n  // ...\n}\n// 开始执行渲染。这个方法内部进入workLoopConcurrent，有可能中断\nfunction performConcurrentWorkOnRoot() {\n  // ...\n  workLoopConcurrent();\n  // ...\n\n  // callbackNode没变，任务未执行完，代表被中断了。\n  if (root.callbackNode === originalCallbackNode) {\n    return performConcurrentWorkOnRoot.bind(null, root); // 返回一个continuation函数为函数自身。下一切片Scheduler还会调用。\n  }\n  return null; // 执行完了，就不需要返回continuation\n}\n```\n\n> 本Scheduler章节测试的源代码在[codeSandbox上](https://codesandbox.io/p/devbox/h9h7ln)。\n\n### Lane模型\n\n前面详细讲了`Scheduler`的知识。它在内部使用了5种优先级。那Lane模型又是什么呢？\n\nLane模型是React内部对更新划分优先级，并进行协调、合并和执行的一套规则。它与`Scheduler`是两套东西。Lane使用31位的二进制来表示。就像是一条一条的赛车道，越靠内的赛道长度越短，Lane位数越小的**优先级**越高。类似于：\n\n```javascript\nexport const SyncLane: Lane = /*                        */ 0b0000000000000000000000000000001;\n// ...\n```\n\nReact将更新根据优先级分配其到相应的Lane中。比如：\n\n- 为用户交互事件触发的更新，使用高优先级，确保该更新能更快渲染到界面上。（原理React封装了事件处理器，在调用我们的回调之前，先设置好了优先级，当执行到setState等方法时，能获取到已设置的优先级）\n\n- 使用`Transition`或`Suspense`时触发的更新，将会使用低优先级。从而不影响重要的更新。\n\nLane模型也比较复杂，后续可能会单独出一篇文章讲解清楚。这次简单以问答形式写一下。\n\n1. Lane为什么使用二进制来表示？\n\n    因为位运算比较方便。并且能用多个位表示同一优先级的许多个更新，称为`批`。比如`const TransitionLanes = 0b0000000001111111110000000000000;`，Transition占了9个位，有2^9个取值。\n\n2. Lane什么时候被生产？\n\n    触发更新的时候，React就会根据当前环境为这个更新生产一个lane。\n\n3. Lane什么时候被使用？\n\n    - 更新调度前，根据lane判断是否调度更新、是否取消前一次更新、按照什么优先级调度更新等。\n\n    - `render阶段`根据当前lane和`Update`的lane来处理state。lane优先级不够的，留到后面处理。\n\n4. Lane和Scheduler的关系是？\n\n    Lane是React内部用的优先级模型，主要是用来标记更新的优先级。而Scheduler是独立的优先级调度器。不过lane可以与Scheduler的5种优先级，并发送给Scheduler。\n\n### 其他\n\n本文主要从总体的角度讲了一下Fiber架构下的渲染工作流程是什么样的。实际上，React的源码非常庞大，包含的模块非常多。本文很多都没有涉及到。后续如果有时间的话，会单独出文章。挨个的讲清楚。\n\n计划要详细讲解的知识点有：\n\n- 工作循环的设计思路和中断\n\n- Fiber协调时的Diff算法和mutation阶段更新dom\n\n- Hooks实现\n\n- Scheduler手把手实现\n\n- Lane模型具体实现"}}},"pageContext":{"slug":"/react-fiber-struct","nexttitle":"Webpack是如何处理ESM的","nextslug":"/webpack是如何处理-esm的","prevtitle":"云流","prevslug":"/云流","relatedPosts":[{"title":"谈一谈React18的RSC","description":"介绍React18的RSC相关知识，参考：https://article.juejin.cn/post/7220061751399170103#heading-13和https://dev.to/jankoritak/server-components-vs-ssr-1g8c","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAABAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB59M1QD//xAAYEAADAQEAAAAAAAAAAAAAAAABAgMQEf/aAAgBAQABBQJZlohd6c//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAADAAMAAAAAAAAAAAAAAAACEBEAITH/2gAIAQEABj8CI9Qcr6v/xAAcEAACAgIDAAAAAAAAAAAAAAABEQAxECFBYZH/2gAIAQEAAT8hGHcRbc1cg1RhuMqzOx7j/9oADAMBAAIAAwAAABDTD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQACAwADAAAAAAAAAAAAAAERIQAxQRBRcf/aAAgBAQABPxABABrExqK7gpaQYrcWa+ZsgC9GAIAPQ5o4slvH/9k="},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/6890535e3478882b78f0403eb486168d/4710f/react-rsc-cover.jpg","srcSet":"/leon-blog/static/6890535e3478882b78f0403eb486168d/002be/react-rsc-cover.jpg 165w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/b4f54/react-rsc-cover.jpg 330w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/4710f/react-rsc-cover.jpg 659w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/eeb57/react-rsc-cover.jpg 1318w","sizes":"(min-width: 659px) 659px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/6890535e3478882b78f0403eb486168d/79731/react-rsc-cover.avif 165w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/6ae0f/react-rsc-cover.avif 330w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/b9b98/react-rsc-cover.avif 659w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/4ddb9/react-rsc-cover.avif 1318w","type":"image/avif","sizes":"(min-width: 659px) 659px, 100vw"},{"srcSet":"/leon-blog/static/6890535e3478882b78f0403eb486168d/55a9a/react-rsc-cover.webp 165w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/39687/react-rsc-cover.webp 330w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/62d22/react-rsc-cover.webp 659w,\n/leon-blog/static/6890535e3478882b78f0403eb486168d/6c1b1/react-rsc-cover.webp 1318w","type":"image/webp","sizes":"(min-width: 659px) 659px, 100vw"}]},"width":659,"height":368},"coverImageAlt":"封面","datePublished":"2024-10-15T19:32:24.000Z","dateModified":"2024-10-15T19:32:24.000Z","category":"经验总结","tags":["前端","React","架构","造轮子","Next"],"excerpt":"最近笔者腾出了大把的时间，学习了一下React18。 导航 什么是RSC 客户端组件的缺点 服务器组件如何解决问题 使用RSC RSC的缺点 总结一：RSC和RCC RSC对比SSR Next.js下RSC的工作流程 总结二：RSC和SSR 其它 什么是RSC React1…","timeToRead":2,"slug":"/react-rsc","route":"/react-rsc","pathName":"/leon-blog/react-rsc","url":"https://missmess.github.io/leon-blog/react-rsc"},{"title":"谈一谈React18的SSR","description":"介绍React18的SSR相关知识","coverImg":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAADBP/aAAwDAQACEAMQAAABboazHjQIBr//xAAbEAACAQUAAAAAAAAAAAAAAAAAAQIDBBAjMf/aAAgBAQABBQJsrS14u+n/xAAXEQADAQAAAAAAAAAAAAAAAAABAhAh/9oACAEDAQE/AU0z/8QAFhEAAwAAAAAAAAAAAAAAAAAAAhAx/9oACAECAQE/ASi//8QAGhAAAQUBAAAAAAAAAAAAAAAAEAABAhEhUf/aAAgBAQAGPwJV3DFh/8QAGhABAAIDAQAAAAAAAAAAAAAAAQARECFRkf/aAAgBAQABPyFB0nkouaXDpcN5KXH/2gAMAwEAAgADAAAAELQP/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/EDiT/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/ECif/8QAHhABAQABAwUAAAAAAAAAAAAAAREhABAxQWFxgcH/2gAIAQEAAT8QlQHdP3VmI6Dpy48GiCGgwdsrYexZt//Z"},"backgroundColor":"transparent","images":{"fallback":{"src":"/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/70a21/react-ssr-cover.jpg","srcSet":"/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/2a6d8/react-ssr-cover.jpg 147w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/f5d63/react-ssr-cover.jpg 295w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/70a21/react-ssr-cover.jpg 589w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/a19e9/react-ssr-cover.jpg 1178w","sizes":"(min-width: 589px) 589px, 100vw"},"sources":[{"srcSet":"/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/34bea/react-ssr-cover.avif 147w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/24e48/react-ssr-cover.avif 295w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/b6890/react-ssr-cover.avif 589w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/319a1/react-ssr-cover.avif 1178w","type":"image/avif","sizes":"(min-width: 589px) 589px, 100vw"},{"srcSet":"/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/9862c/react-ssr-cover.webp 147w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/6e9d7/react-ssr-cover.webp 295w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/4b50c/react-ssr-cover.webp 589w,\n/leon-blog/static/4e049eb08e0645207ac2ff6babe990e0/bcd24/react-ssr-cover.webp 1178w","type":"image/webp","sizes":"(min-width: 589px) 589px, 100vw"}]},"width":589,"height":368},"coverImageAlt":"封面","datePublished":"2024-07-20T12:04:20.000Z","dateModified":"2024-07-20T12:04:20.000Z","category":"经验总结","tags":["前端","React","架构","造轮子","Next"],"excerpt":"最近笔者腾出了大把的时间，学习了一下React18。 导航 什么是SSR React18之前的旧SSR 手动实现旧SSR 为什么用Next.js React18的新SSR Suspense组件 流式传输Html 流式HTML + Suspense 选择性水合 + Suspense…","timeToRead":3,"slug":"/react-ssr","route":"/react-ssr","pathName":"/leon-blog/react-ssr","url":"https://missmess.github.io/leon-blog/react-ssr"}]}},"staticQueryHashes":["2792541146","2845918323"]}